import{j as e}from"./chunk-DXw4Pgvm.js";import{f as t,g as r,j as s,r as a}from"./chunk-DZuWtVpy.js";import{S as n}from"./chunk-e2suWao5.js";import{r as i,a as l,b as o,c,u as d,s as u,g as p,D as m,G as h,o as f}from"../index-yX3ttfFw.js";import{D as y}from"./chunk-BCwlQNV5.js";import{C as x}from"./chunk-tthewbz1.js";import{R as g}from"./chunk-C1NFjQ3o.js";import{u as j}from"./chunk-CM3g5OHp.js";import{o as v,q as k,s as b,a as w,T as _,g as C,B as T,W as M,I as S,m as z,p as P,E,Q as R}from"./chunk-CSjZqX98.js";import{l as L,K as B,T as O,s as A}from"./chunk-TZcEmCSf.js";import"./chunk-BNqsZZGB.js";import"./chunk-C0XEpv6B.js";import"./chunk-DCAm5-CN.js";import"./chunk-BSOr0LTQ.js";import"./chunk-0VeV4Lca.js";var D,U,H,I={exports:{}},$={},q={};function N(){if(D)return q;D=1,Object.defineProperty(q,"__esModule",{value:!0});return q.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"eye",theme:"outlined"},q}function G(){if(U)return $;U=1;var e=i().default,r=l().default;Object.defineProperty($,"__esModule",{value:!0}),$.default=void 0;var s=r(o()),a=e(t()),n=r(N()),d=r(c()),u=function(e,t){return a.createElement(d.default,(0,s.default)({},e,{ref:t,icon:n.default}))},p=a.forwardRef(u);return $.default=p,$}function W(){return H||(H=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=G())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(I,I.exports)),I.exports}const F=r(W());var Q,V,Z,J={exports:{}},K={},X={};function Y(){if(Q)return X;Q=1,Object.defineProperty(X,"__esModule",{value:!0});return X.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 693.2c-42.5-24.6-94.3-18-129.2 12.8l-53-30.7V523.6c0-15.7-8.4-30.3-22-38.1l-136-78.3v-67.1c44.2-15 76-56.8 76-106.1 0-61.9-50.1-112-112-112s-112 50.1-112 112c0 49.3 31.8 91.1 76 106.1v67.1l-136 78.3c-13.6 7.8-22 22.4-22 38.1v151.6l-53 30.7c-34.9-30.8-86.8-37.4-129.2-12.8-53.5 31-71.7 99.4-41 152.9 30.8 53.5 98.9 71.9 152.2 41 42.5-24.6 62.7-73 53.6-118.8l48.7-28.3 140.6 81c6.8 3.9 14.4 5.9 22 5.9s15.2-2 22-5.9L674.5 740l48.7 28.3c-9.1 45.7 11.2 94.2 53.6 118.8 53.3 30.9 121.5 12.6 152.2-41 30.8-53.6 12.6-122-40.7-152.9zm-673 138.4a47.6 47.6 0 01-65.2-17.6c-13.2-22.9-5.4-52.3 17.5-65.5a47.6 47.6 0 0165.2 17.6c13.2 22.9 5.4 52.3-17.5 65.5zM522 463.8zM464 234a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm170 446.2l-122 70.3-122-70.3V539.8l122-70.3 122 70.3v140.4zm239.9 133.9c-13.2 22.9-42.4 30.8-65.2 17.6-22.8-13.2-30.7-42.6-17.5-65.5s42.4-30.8 65.2-17.6c22.9 13.2 30.7 42.5 17.5 65.5z"}}]},name:"deployment-unit",theme:"outlined"},X}function ee(){if(V)return K;V=1;var e=i().default,r=l().default;Object.defineProperty(K,"__esModule",{value:!0}),K.default=void 0;var s=r(o()),a=e(t()),n=r(Y()),d=r(c()),u=function(e,t){return a.createElement(d.default,(0,s.default)({},e,{ref:t,icon:n.default}))},p=a.forwardRef(u);return K.default=p,K}function te(){return Z||(Z=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=ee())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(J,J.exports)),J.exports}const re=r(te());var se,ae,ne,ie={exports:{}},le={},oe={};function ce(){if(se)return oe;se=1,Object.defineProperty(oe,"__esModule",{value:!0});return oe.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"unordered-list",theme:"outlined"},oe}function de(){if(ae)return le;ae=1;var e=i().default,r=l().default;Object.defineProperty(le,"__esModule",{value:!0}),le.default=void 0;var s=r(o()),a=e(t()),n=r(ce()),d=r(c()),u=function(e,t){return a.createElement(d.default,(0,s.default)({},e,{ref:t,icon:n.default}))},p=a.forwardRef(u);return le.default=p,le}function ue(){return ne||(ne=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=de())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(ie,ie.exports)),ie.exports}const pe=r(ue()),{Text:me,Paragraph:he}=_,fe=({template:t,viewMode:r,onDeploy:s,onPreview:a,"data-testid":n})=>{const{t:i}=j(["marketplace","resources"]),l=d(),o=t=>{const s=t.toLowerCase();return s.includes("db_")||s.includes("database")||s.includes("sql")?e.jsx(y,{style:{fontSize:"list"===r?20:32}}):s.includes("nginx")||s.includes("wordpress")||s.includes("web")?e.jsx(h,{style:{fontSize:"list"===r?20:32}}):s.includes("cloud")||s.includes("route")?e.jsx(x,{style:{fontSize:"list"===r?20:32}}):s.includes("monitor")||s.includes("prometheus")?e.jsx(re,{style:{fontSize:"list"===r?20:32}}):e.jsx(f,{style:{fontSize:"list"===r?20:32}})},c=e=>e.replace(/^(db_|kick_|route_|monitor_|cache_|queue_|auth_|search_|dev_|manage_|api_)/,"").split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),_=e=>e.split("\n").filter(e=>e.trim()&&!e.startsWith("#"))[0]||"Template for quick deployment",M=e=>{switch(e){case"beginner":return"success";case"intermediate":return"warning";case"advanced":return"error";default:return"default"}},S=e=>{switch(e){case"beginner":return i("marketplace:difficultyBeginner");case"intermediate":return i("marketplace:difficultyIntermediate");case"advanced":return i("marketplace:difficultyAdvanced");default:return""}};return"list"===r?e.jsx(v,{hoverable:!0,"data-testid":n,children:e.jsxs(k,{gutter:16,align:"middle",children:[e.jsx(b,{flex:"auto",children:e.jsxs(w,{direction:"vertical",size:0,style:{width:"100%"},children:[e.jsxs(w,{children:[e.jsx(me,{strong:!0,style:{fontSize:16},children:c(t.name)}),e.jsx(C,{color:M(t.difficulty),children:S(t.difficulty)})]}),e.jsxs("div",{style:{...l.flexCenter,justifyContent:"flex-start",marginTop:u("XS")},children:[e.jsx(he,{ellipsis:{rows:1},style:{marginBottom:0,flex:1,marginRight:8},children:_(t.readme)}),e.jsx("div",{style:{...l.touchTarget,background:"var(--color-fill-tertiary)",borderRadius:p("MD"),overflow:"hidden",flexShrink:0},children:t.iconUrl?e.jsx("img",{src:t.iconUrl,alt:t.name,style:{width:m.TOUCH_TARGET.MIN_SIZE,height:m.TOUCH_TARGET.MIN_SIZE,objectFit:"contain"},onError:e=>{e.currentTarget.style.display="none";const r=document.createElement("div");r.innerHTML=o(t.name),e.currentTarget.parentElement?.appendChild(r)}}):o(t.name)})]}),e.jsxs(w,{wrap:!0,style:{marginTop:u("SM")},children:[t.tags?.slice(0,3).map(t=>e.jsx(C,{children:t},t)),t.tags&&t.tags.length>3&&e.jsxs(C,{children:["+",t.tags.length-3]})]})]})}),e.jsx(b,{flex:"none",children:e.jsxs(w,{children:[e.jsx(T,{icon:e.jsx(F,{}),onClick:a,"data-testid":`${n}-preview-button`,children:i("marketplace:preview")}),e.jsx(T,{type:"primary",icon:e.jsx(g,{}),onClick:s,"data-testid":`${n}-deploy-button`,children:i("marketplace:deploy")})]})})]})}):e.jsx(v,{hoverable:!0,"data-testid":n,cover:e.jsx("div",{style:{height:120,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--color-fill-secondary)",position:"relative",overflow:"hidden"},children:t.iconUrl?e.jsx("img",{src:t.iconUrl,alt:t.name,style:{width:80,height:80,objectFit:"contain",filter:"drop-shadow(0px 2px 4px rgba(0,0,0,0.1))"},onError:e=>{e.currentTarget.style.display="none";const r=document.createElement("div");r.innerHTML=o(t.name),e.currentTarget.parentElement?.appendChild(r)}}):o(t.name)}),actions:[e.jsx(T,{type:"text",icon:e.jsx(F,{}),onClick:a,"data-testid":`${n}-preview-button`,children:i("marketplace:preview")},"preview"),e.jsx(T,{type:"text",icon:e.jsx(g,{}),onClick:s,style:{color:"var(--color-primary)"},"data-testid":`${n}-deploy-button`,children:i("marketplace:deploy")},"deploy")],children:e.jsxs(w,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx("div",{children:e.jsx(me,{strong:!0,style:{fontSize:16},children:c(t.name)})}),e.jsx(he,{ellipsis:{rows:2},type:"secondary",style:{marginBottom:12,minHeight:44},children:_(t.readme)}),e.jsxs(w,{wrap:!0,size:4,children:[e.jsx(C,{color:M(t.difficulty),children:S(t.difficulty)}),t.tags?.slice(0,2).map(t=>e.jsx(C,{children:t},t))]})]})})},{Title:ye,Text:xe}=_,{Search:ge}=S,je=()=>{const{t:t}=j(["marketplace","resources","common"]),r=s(),i=d(),l=L(),[o,c]=a.useState(!0),[u,p]=a.useState([]),[m,h]=a.useState(""),[y,x]=a.useState("grid"),[g,_]=a.useState(null),[C,T]=a.useState(!1),[S,D]=a.useState(!1),[U,H]=a.useState(null);a.useEffect(()=>{I()},[]);const I=async()=>{try{c(!0);const e=(await B.fetchTemplates()).map(e=>({...e,category:e.category||$(e.id),tags:q(e.id,e.readme),difficulty:N(e.id)}));p(e)}catch(e){M.error("Unable to load templates. Please check your connection.")}finally{c(!1)}},$=e=>{const t=e.split("_");return t.length>=2?t[0]:"other"},q=(e,t)=>{const r=[],s=e.toLowerCase(),a=t.toLowerCase();return s.includes("mysql")&&r.push("MySQL"),s.includes("postgres")&&r.push("PostgreSQL"),s.includes("mongo")&&r.push("MongoDB"),s.includes("redis")&&r.push("Redis"),s.includes("nginx")&&r.push("Nginx"),s.includes("wordpress")&&r.push("WordPress"),s.includes("docker")&&r.push("Docker"),a.includes("production")&&r.push("Production Ready"),a.includes("development")&&r.push("Development"),a.includes("high availability")&&r.push("HA"),a.includes("cluster")&&r.push("Clustered"),r},N=e=>["networking_nginx","databases_mysql","caching_redis"].includes(e)?"beginner":["monitoring_prometheus-grafana","messaging_kafka","security_keycloak"].includes(e)?"advanced":"intermediate",G=a.useMemo(()=>{const e=u.filter(e=>{if(m){const t=m.toLowerCase();return e.name.toLowerCase().includes(t)||e.readme.toLowerCase().includes(t)||(e.tags||[]).some(e=>e.toLowerCase().includes(t))}return!0}),t={};return e.forEach(e=>{const r=e.category||"other";if(!t[r]){const e=(e=>{const t=e.split(/[-_]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return{label:t,description:`${t} templates and solutions`}})(r);t[r]={key:r,title:e.label,description:e.description,templates:[]}}t[r].templates.push(e)}),Object.values(t).sort((e,t)=>e.key.localeCompare(t.key))},[u,m,t]),W=e=>{H(e),D(!0)};return e.jsxs("div",{children:[e.jsx(k,{gutter:[24,16],style:{marginBottom:24},children:e.jsx(b,{xs:24,children:e.jsxs(w,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ye,{level:2,style:{...i.heading2,margin:0},children:t("marketplace:title")}),e.jsx(xe,{type:"secondary",children:t("marketplace:subtitle")})]})})}),e.jsxs(k,{gutter:[16,16],style:{marginBottom:32},children:[e.jsx(b,{xs:24,sm:12,md:8,children:e.jsx(ge,{placeholder:t("marketplace:searchPlaceholder"),allowClear:!0,size:"large",style:i.inputLarge,prefix:e.jsx(n,{}),value:m,onChange:e=>h(e.target.value),autoComplete:"off","data-testid":"marketplace-search-input"})}),e.jsx(b,{xs:24,sm:12,md:16,children:e.jsx(w,{style:{width:"100%",justifyContent:"flex-end"},wrap:!0,children:e.jsx(z,{value:y,onChange:x,options:[{value:"grid",icon:e.jsx(f,{})},{value:"list",icon:e.jsx(pe,{})}],"data-testid":"marketplace-view-mode-toggle"})})})]}),o?e.jsxs("div",{style:{textAlign:"center",padding:"60px 0"},"data-testid":"marketplace-loading",children:[e.jsx(P,{size:"large"}),e.jsx("div",{style:{marginTop:16,color:"var(--ant-color-text-secondary)"},children:t("marketplace:loading")})]}):0===G.length?e.jsx(v,{style:i.card,"data-testid":"marketplace-empty-state",children:e.jsx(E,{description:m?e.jsxs(w,{direction:"vertical",align:"center",size:"middle",style:{textAlign:"center"},children:[e.jsx(xe,{children:t("marketplace:noTemplatesFound")}),e.jsx(xe,{type:"secondary",style:{fontSize:14},children:"Try adjusting your search terms or browse all available templates"}),e.jsxs(w,{children:[e.jsx("button",{type:"button",onClick:()=>h(""),style:{...i.buttonPrimary,...i.touchTarget,background:"var(--color-primary)",color:"white",border:"none"},"data-testid":"marketplace-clear-search",children:"Clear Search"}),e.jsx("button",{type:"button",onClick:()=>r("/resources"),style:{...i.buttonSecondary,...i.touchTarget,background:"transparent",color:"var(--color-primary)",border:"1px solid var(--color-primary)"},"data-testid":"marketplace-view-resources",children:"View My Resources"})]})]}):e.jsxs(w,{direction:"vertical",align:"center",size:"middle",style:{textAlign:"center"},children:[e.jsx(xe,{children:"No templates available at this time"}),e.jsx(xe,{type:"secondary",style:{fontSize:14},children:"Marketplace templates are currently being loaded or configured"}),e.jsxs(w,{children:[e.jsx("button",{type:"button",onClick:()=>I(),style:{...i.buttonPrimary,...i.touchTarget,background:"var(--color-primary)",color:"white",border:"none"},"data-testid":"marketplace-refresh",children:"Refresh Templates"}),e.jsx("button",{type:"button",onClick:()=>r("/resources"),style:{...i.buttonSecondary,...i.touchTarget,background:"transparent",color:"var(--color-primary)",border:"1px solid var(--color-primary)"},"data-testid":"marketplace-create-resource",children:"Create Custom Resource"})]})]}),image:E.PRESENTED_IMAGE_SIMPLE})}):e.jsx("div",{children:G.map((t,r)=>e.jsxs("div",{style:{marginBottom:48},"data-testid":`marketplace-category-${t.key}`,children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs("div",{children:[e.jsx(ye,{level:4,style:{margin:0},children:t.title}),e.jsx(xe,{type:"secondary",children:t.description})]})}),e.jsx(k,{gutter:[16,16],children:t.templates.map(t=>e.jsx(b,{xs:24,sm:"list"===y?24:12,lg:"list"===y?24:8,xl:"list"===y?24:6,children:e.jsx(fe,{template:t,viewMode:y,onDeploy:()=>W(t),onPreview:()=>{_(t),T(!0)},"data-testid":`marketplace-card-${t.name}`})},t.name))}),r<G.length-1&&e.jsx(R,{style:{marginTop:32}})]},t.key))}),g&&e.jsx(O,{template:g,visible:C,onClose:()=>{T(!1),_(null)},onUseTemplate:e=>{W(e),T(!1)},context:"marketplace"}),S&&U&&e.jsx(A,{open:S,onCancel:()=>{D(!1),H(null)},resourceType:"repository",mode:"create",existingData:{preselectedTemplate:U.id||U.name},onSubmit:async e=>{try{await l.mutateAsync(e),M.success(t("resources:repository.created")),D(!1),H(null),setTimeout(()=>{r("/resources")},1e3)}catch(s){M.error(t("resources:repository.createError"))}},isSubmitting:l.isPending})]})};export{je as default};
