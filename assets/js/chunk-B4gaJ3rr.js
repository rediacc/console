const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/forkTokenService.ts-BgcpHq4E.js","assets/js/chunk-B3rfJhtT.js","assets/js/chunk-DZuWtVpy.js","assets/index-DRw3QGwP.js","assets/js/chunk-DXw4Pgvm.js","assets/js/chunk-DhsIgqDf.js","assets/js/chunk-CM3g5OHp.js","assets/js/chunk-CSjZqX98.js","assets/index-BH1DZEKv.css"])))=>i.map(i=>d[i]);
import{f as e,g as t,h as r,j as s,u as a}from"./chunk-DXw4Pgvm.js";import{f as n,g as o,r as i,R as c}from"./chunk-DZuWtVpy.js";import{l,j as d,u,r as m,a as p,b as h,c as y,m as g,D as f,s as x,y as v,n as j,A as b,p as w,q as C,t as S,K as N,g as k,f as I,W as _,M as T,I as P,h as R}from"../index-DRw3QGwP.js";import{S as E}from"./chunk-B5K5IXco.js";import{E as G}from"./chunk-B_NpgxeU.js";import{D as M}from"./chunk-DTDP1Cya.js";import{C as A,D as F}from"./chunk-BBZh1mru.js";import{C as D}from"./chunk-DQeovWLL.js";import{R as O}from"./chunk-wgyboZoI.js";import{q as L,R as $,P as z}from"./chunk-Cg2209yc.js";import{u as U,a as q,e as V,d as B,c as Q,l as K,n as H,t as W,m as X,F as Y}from"./chunk-BtQb2Rqq.js";import{m as J,R as Z,C as ee,Q as te}from"./chunk-BE-GJhp2.js";import{_ as re}from"./chunk-B3rfJhtT.js";import{C as se}from"./chunk-DdwiD4Er.js";import{u as ae}from"./chunk-CM3g5OHp.js";import{g as ne,k as oe,h as ie,X as ce,a9 as le,$ as de,ab as ue,p as me,M as pe,V as he,a as ye,B as ge,i as fe,T as xe,x as ve,ad as je,W as be,t as we,F as Ce,ae as Se,I as Ne,D as ke,w as Ie,S as _e}from"./chunk-CSjZqX98.js";import{createFreshForkToken as Te}from"./forkTokenService.ts-BgcpHq4E.js";import{T as Pe}from"./chunk-Cc81kOho.js";import{S as Re}from"./chunk-Bi9uqbqU.js";const Ee=e=>["distributed-storage-clusters",e],Ge=e=>["distributed-storage-pools",e],Me=(e,t)=>["distributed-storage-images",e,t],Ae=(e,t,r)=>["distributed-storage-snapshots",e,t,r],Fe=(e,t,r,s)=>["distributed-storage-clones",e,t,r,s],De=e=>["distributed-storage-cluster-machines",e],Oe=(e,t)=>["machine-assignment-status",e,t],Le=e=>["available-machines-for-clone",e],$e=(e,t,r,s,a)=>["clone-machines",e,t,r,s,a],ze=(t,r=!0)=>e({queryKey:Ee(t),queryFn:async()=>{const e=await d.post("/GetDistributedStorageClusters",{});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch clusters");return e.resultSets?.[1]?.data||[]},enabled:r}),Ue=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/CreateDistributedStorageCluster",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to create cluster");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ee()}),l("success",s("clusters.createSuccess"))},onError:e=>{l("error",e.message)}})},qe=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateDistributedStorageClusterVault",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to update cluster vault");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ee()}),l("success",s("clusters.updateSuccess"))},onError:e=>{l("error",e.message)}})},Ve=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/DeleteDistributedStorageCluster",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to delete cluster");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ee()}),l("success",s("clusters.deleteSuccess"))},onError:e=>{l("error",e.message)}})},Be=(t,r=!0)=>e({queryKey:Ge(t),queryFn:async()=>{const e=await d.post("/GetDistributedStoragePools",{teamName:Array.isArray(t)?t[0]:t});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch pools");return e.resultSets?.[1]?.data||[]},enabled:r&&!!t}),Qe=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/CreateDistributedStoragePool",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to create pool");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ge()}),l("success",s("pools.createSuccess"))},onError:e=>{l("error",e.message)}})},Ke=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateDistributedStoragePoolVault",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to update pool vault");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ge()}),l("success",s("pools.updateSuccess"))},onError:e=>{l("error",e.message)}})},He=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/DeleteDistributedStoragePool",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to delete pool");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ge()}),l("success",s("pools.deleteSuccess"))},onError:e=>{l("error",e.message)}})},We=(t,r,s=!0)=>e({queryKey:Me(t,r),queryFn:async()=>{if(!t)return[];const e=await d.post("/GetDistributedStorageRbdImages",{poolName:t,teamName:r});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch RBD images");return e.resultSets?.[1]?.data||[]},enabled:s&&!!t}),Xe=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/CreateDistributedStorageRbdImage",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to create RBD image");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Me()}),e.invalidateQueries({queryKey:["distributed-storage-cluster-machines"]}),l("success",s("images.createSuccess"))},onError:e=>{l("error",e.message)}})},Ye=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/DeleteDistributedStorageRbdImage",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to delete RBD image");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Me()}),l("success",s("images.deleteSuccess"))},onError:e=>{l("error",e.message)}})},Je=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateImageMachineAssignment",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to update image machine assignment");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Me()}),l("success",s("images.reassignmentSuccess"))},onError:e=>{l("error",e.message)}})},Ze=(t,r,s,a=!0)=>e({queryKey:Ae(t,r,s),queryFn:async()=>{if(!t)return[];const e=await d.post("/GetDistributedStorageRbdSnapshots",{imageName:t,poolName:r,teamName:s});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch RBD snapshots");return e.resultSets?.[1]?.data||[]},enabled:a&&!!t}),et=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/CreateDistributedStorageRbdSnapshot",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to create RBD snapshot");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ae()}),l("success",s("snapshots.createSuccess"))},onError:e=>{l("error",e.message)}})},tt=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/DeleteDistributedStorageRbdSnapshot",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to delete RBD snapshot");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Ae()}),l("success",s("snapshots.deleteSuccess"))},onError:e=>{l("error",e.message)}})},rt=(t,r,s,a,n=!0)=>e({queryKey:Fe(t,r,s,a),queryFn:async()=>{if(!t)return[];const e=await d.post("/GetDistributedStorageRbdClones",{snapshotName:t,imageName:r,poolName:s,teamName:a});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch RBD clones");return e.resultSets?.[1]?.data||[]},enabled:n&&!!t}),st=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/CreateDistributedStorageRbdClone",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to create RBD clone");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Fe()}),l("success",s("clones.createSuccess"))},onError:e=>{l("error",e.message)}})},at=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/DeleteDistributedStorageRbdClone",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to delete RBD clone");return t},onSuccess:()=>{e.invalidateQueries({queryKey:Fe()}),l("success",s("clones.deleteSuccess"))},onError:e=>{l("error",e.message)}})},nt=(t,r=!0)=>e({queryKey:De(t),queryFn:async()=>{const e=await d.post("/GetDistributedStorageClusterMachines",{clusterName:t});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch cluster machines");return e.resultSets?.[1]?.data||[]},enabled:r&&!!t}),ot=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateCloneMachineAssignments",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to assign machines to clone");return t},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:$e(r.cloneName,r.snapshotName,r.imageName,r.poolName,r.teamName)}),e.invalidateQueries({queryKey:Le(r.teamName)}),l("success",s("clones.machinesAssignedSuccess"))},onError:e=>{l("error",e.message)}})},it=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateCloneMachineRemovals",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to remove machines from clone");return t},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:$e(r.cloneName,r.snapshotName,r.imageName,r.poolName,r.teamName)}),e.invalidateQueries({queryKey:Le(r.teamName)}),l("success",s("clones.machinesRemovedSuccess"))},onError:e=>{l("error",e.message)}})},ct=(t,r,s=!0)=>e({queryKey:Oe(t,r),queryFn:async()=>{const e=await d.post("/GetMachineAssignmentStatus",{machineName:t,teamName:r});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch machine assignment status");return e.resultSets?.[0]?.data?.[0]||null},enabled:s&&!!t&&!!r}),lt=(t,r=!0)=>e({queryKey:Le(t),queryFn:async()=>{const e=await d.post("/GetAvailableMachinesForClone",{teamName:t});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch available machines");return e.resultSets?.[0]?.data||[]},enabled:r&&!!t}),dt=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateMachineClusterAssignment",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to assign machine to cluster");return t},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:De(r.clusterName)}),e.invalidateQueries({queryKey:Oe(r.machineName,r.teamName)}),l("success",s("machines.clusterAssignedSuccess"))},onError:e=>{l("error",e.message)}})},ut=()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateMachineClusterRemoval",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to remove machine from cluster");return t},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["distributed-storage-cluster-machines"]}),e.invalidateQueries({queryKey:Oe(r.machineName,r.teamName)}),l("success",s("machines.clusterRemovedSuccess"))},onError:e=>{l("error",e.message)}})},mt=(t,r,s,a,n,o=!0)=>e({queryKey:$e(t,r,s,a,n),queryFn:async()=>{const e=await d.post("/GetCloneMachines",{cloneName:t,snapshotName:r,imageName:s,poolName:a,teamName:n});if(0!==e.failure)throw new Error(e.errors?.join(", ")||"Failed to fetch clone machines");return e.resultSets?.[0]?.data||[]},enabled:o&&!!t&&!!r&&!!s&&!!a&&!!n}),pt=({assignmentType:e,assignmentDetails:t,showIcon:r=!0,size:a="default"})=>{const{t:n}=ae("machines"),o=u(),i=(()=>{switch(e){case"AVAILABLE":return{color:"green",icon:s.jsx(ue,{style:o.icon.small}),text:n("assignmentStatus.available"),badgeStatus:"success"};case"CLUSTER":return{color:"blue",icon:s.jsx(de,{style:o.icon.small}),text:n("assignmentStatus.cluster"),badgeStatus:"processing"};case"IMAGE":return{color:"purple",icon:s.jsx(le,{style:o.icon.small}),text:n("assignmentStatus.image"),badgeStatus:"processing"};case"CLONE":return{color:"orange",icon:s.jsx(ce,{style:o.icon.small}),text:n("assignmentStatus.clone"),badgeStatus:"processing"};default:return{color:"default",icon:null,text:"Unknown",badgeStatus:"default"}}})();if("small"===a){const a=s.jsx(ne,{color:i.color,icon:r?i.icon:void 0,style:{margin:0,borderRadius:"var(--border-radius-sm)",...o.caption,display:"flex",alignItems:"center",gap:"4px"},"data-testid":`machine-status-badge-tag-${e.toLowerCase()}`,children:s.jsx("span",{style:o.caption,children:i.text})});return t?s.jsx(oe,{title:t,children:s.jsx("span",{"data-testid":"machine-status-badge-tooltip-wrapper",children:a})}):a}return s.jsx(oe,{title:t?s.jsx("span",{style:o.caption,children:t}):void 0,children:s.jsx("span",{"data-testid":"machine-status-badge-tooltip-wrapper",children:s.jsx(ie,{status:i.badgeStatus,text:s.jsxs("span",{style:{...o.flexStart,gap:"4px"},"data-testid":`machine-status-badge-${e.toLowerCase()}`,children:[r&&i.icon,s.jsx("span",{style:o.caption,children:i.text})]})})})})},ht=({machine:e})=>{const t=u(),{data:r,isLoading:a}=ct(e.machineName,e.teamName,!e.distributedStorageClusterName);return e.distributedStorageClusterName?s.jsx("div",{"data-testid":"machine-status-cell-cluster",style:{...t.flexStart,minHeight:"24px"},children:s.jsx(pt,{assignmentType:"CLUSTER",assignmentDetails:`Assigned to cluster: ${e.distributedStorageClusterName}`,size:"small"})}):a?s.jsx("div",{style:{...t.flexCenter,minHeight:"24px"},children:s.jsx(me,{size:"small","data-testid":"machine-status-cell-loading"})}):r?s.jsx("div",{"data-testid":`machine-status-cell-${r.assignmentType.toLowerCase()}`,style:{...t.flexStart,minHeight:"24px"},children:s.jsx(pt,{assignmentType:r.assignmentType,assignmentDetails:r.assignmentDetails,size:"small"})}):s.jsx("div",{"data-testid":"machine-status-cell-available",style:{...t.flexStart,minHeight:"24px"},children:s.jsx(pt,{assignmentType:"AVAILABLE",size:"small"})})};var yt,gt,ft,xt={exports:{}},vt={},jt={};function bt(){if(yt)return jt;yt=1,Object.defineProperty(jt,"__esModule",{value:!0});return jt.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M342 88H120c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V168h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm578 576h-48c-8.8 0-16 7.2-16 16v176H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V680c0-8.8-7.2-16-16-16zM342 856H168V680c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM904 88H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V120c0-17.7-14.3-32-32-32z"}}]},name:"expand",theme:"outlined"},jt}function wt(){if(gt)return vt;gt=1;var e=m().default,t=p().default;Object.defineProperty(vt,"__esModule",{value:!0}),vt.default=void 0;var r=t(h()),s=e(n()),a=t(bt()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return vt.default=c,vt}function Ct(){return ft||(ft=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=wt())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(xt,xt.exports)),xt.exports}const St=o(Ct());var Nt,kt,It,_t={exports:{}},Tt={},Pt={};function Rt(){if(Nt)return Pt;Nt=1,Object.defineProperty(Pt,"__esModule",{value:!0});return Pt.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M881.7 187.4l-45.1-45.1a8.03 8.03 0 00-11.3 0L667.8 299.9l-54.7-54.7a7.94 7.94 0 00-13.5 4.7L576.1 439c-.6 5.2 3.7 9.5 8.9 8.9l189.2-23.5c6.6-.8 9.3-8.8 4.7-13.5l-54.7-54.7 157.6-157.6c3-3 3-8.1-.1-11.2zM439 576.1l-189.2 23.5c-6.6.8-9.3 8.9-4.7 13.5l54.7 54.7-157.5 157.5a8.03 8.03 0 000 11.3l45.1 45.1c3.1 3.1 8.2 3.1 11.3 0l157.6-157.6 54.7 54.7a7.94 7.94 0 0013.5-4.7L447.9 585a7.9 7.9 0 00-8.9-8.9z"}}]},name:"shrink",theme:"outlined"},Pt}function Et(){if(kt)return Tt;kt=1;var e=m().default,t=p().default;Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.default=void 0;var r=t(h()),s=e(n()),a=t(Rt()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return Tt.default=c,Tt}function Gt(){return It||(It=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=Et())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(_t,_t.exports)),_t.exports}const Mt=o(Gt());var At,Ft,Dt,Ot={exports:{}},Lt={},$t={};function zt(){if(At)return $t;At=1,Object.defineProperty($t,"__esModule",{value:!0});return $t.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917 211.1l-199.2 24c-6.6.8-9.4 8.9-4.7 13.6l59.3 59.3-226 226-101.8-101.7c-6.3-6.3-16.4-6.2-22.6 0L100.3 754.1a8.03 8.03 0 000 11.3l45 45.2c3.1 3.1 8.2 3.1 11.3 0L433.3 534 535 635.7c6.3 6.2 16.4 6.2 22.6 0L829 364.5l59.3 59.3a8.01 8.01 0 0013.6-4.7l24-199.2c.7-5.1-3.7-9.5-8.9-8.8z"}}]},name:"rise",theme:"outlined"},$t}function Ut(){if(Ft)return Lt;Ft=1;var e=m().default,t=p().default;Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.default=void 0;var r=t(h()),s=e(n()),a=t(zt()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return Lt.default=c,Lt}function qt(){return Dt||(Dt=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=Ut())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(Ot,Ot.exports)),Ot.exports}const Vt=o(qt());var Bt,Qt,Kt,Ht={exports:{}},Wt={},Xt={};function Yt(){if(Bt)return Xt;Bt=1,Object.defineProperty(Xt,"__esModule",{value:!0});return Xt.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},Xt}function Jt(){if(Qt)return Wt;Qt=1;var e=m().default,t=p().default;Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.default=void 0;var r=t(h()),s=e(n()),a=t(Yt()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return Wt.default=c,Wt}function Zt(){return Kt||(Kt=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=Jt())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(Ht,Ht.exports)),Ht.exports}const er=o(Zt());var tr,rr,sr,ar={exports:{}},nr={},or={};function ir(){if(tr)return or;tr=1,Object.defineProperty(or,"__esModule",{value:!0});return or.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"},or}function cr(){if(rr)return nr;rr=1;var e=m().default,t=p().default;Object.defineProperty(nr,"__esModule",{value:!0}),nr.default=void 0;var r=t(h()),s=e(n()),a=t(ir()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return nr.default=c,nr}function lr(){return sr||(sr=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=cr())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(ar,ar.exports)),ar.exports}const dr=o(lr());var ur,mr,pr,hr={exports:{}},yr={},gr={};function fr(){if(ur)return gr;ur=1,Object.defineProperty(gr,"__esModule",{value:!0});return gr.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M916 210H376c-17.7 0-32 14.3-32 32v236H108c-17.7 0-32 14.3-32 32v272c0 17.7 14.3 32 32 32h540c17.7 0 32-14.3 32-32V546h236c17.7 0 32-14.3 32-32V242c0-17.7-14.3-32-32-32zm-504 68h200v200H412V278zm-68 468H144V546h200v200zm268 0H412V546h200v200zm268-268H680V278h200v200z"}}]},name:"build",theme:"outlined"},gr}function xr(){if(mr)return yr;mr=1;var e=m().default,t=p().default;Object.defineProperty(yr,"__esModule",{value:!0}),yr.default=void 0;var r=t(h()),s=e(n()),a=t(fr()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return yr.default=c,yr}function vr(){return pr||(pr=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=xr())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(hr,hr.exports)),hr.exports}const jr=o(vr());var br,wr,Cr,Sr={exports:{}},Nr={},kr={};function Ir(){if(br)return kr;br=1,Object.defineProperty(kr,"__esModule",{value:!0});return kr.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M747.4 535.7c-.4-68.2 30.5-119.6 92.9-157.5-34.9-50-87.7-77.5-157.3-82.8-65.9-5.2-138 38.4-164.4 38.4-27.9 0-91.7-36.6-141.9-36.6C273.1 298.8 163 379.8 163 544.6c0 48.7 8.9 99 26.7 150.8 23.8 68.2 109.6 235.3 199.1 232.6 46.8-1.1 79.9-33.2 140.8-33.2 59.1 0 89.7 33.2 141.9 33.2 90.3-1.3 167.9-153.2 190.5-221.6-121.1-57.1-114.6-167.2-114.6-170.7zm-10.6 267c-14.3 19.9-28.7 35.6-41.9 45.7-10.5 8-18.6 11.4-24 11.6-9-.1-17.7-2.3-34.7-8.8-1.2-.5-2.5-1-4.2-1.6l-4.4-1.7c-17.4-6.7-27.8-10.3-41.1-13.8-18.6-4.8-37.1-7.4-56.9-7.4-20.2 0-39.2 2.5-58.1 7.2-13.9 3.5-25.6 7.4-42.7 13.8-.7.3-8.1 3.1-10.2 3.9-3.5 1.3-6.2 2.3-8.7 3.2-10.4 3.6-17 5.1-22.9 5.2-.7 0-1.3-.1-1.8-.2-1.1-.2-2.5-.6-4.1-1.3-4.5-1.8-9.9-5.1-16-9.8-14-10.9-29.4-28-45.1-49.9-27.5-38.6-53.5-89.8-66-125.7-15.4-44.8-23-87.7-23-128.6 0-60.2 17.8-106 48.4-137.1 26.3-26.6 61.7-41.5 97.8-42.3 5.9.1 14.5 1.5 25.4 4.5 8.6 2.3 18 5.4 30.7 9.9 3.8 1.4 16.9 6.1 18.5 6.7 7.7 2.8 13.5 4.8 19.2 6.6 18.2 5.8 32.3 9 47.6 9 15.5 0 28.8-3.3 47.7-9.8 7.1-2.4 32.9-12 37.5-13.6 25.6-9.1 44.5-14 60.8-15.2 4.8-.4 9.1-.4 13.2-.1 22.7 1.8 42.1 6.3 58.6 13.8-37.6 43.4-57 96.5-56.9 158.4-.3 14.7.9 31.7 5.1 51.8 6.4 30.5 18.6 60.7 37.9 89 14.7 21.5 32.9 40.9 54.7 57.8-11.5 23.7-25.6 48.2-40.4 68.8zm-94.5-572c50.7-60.2 46.1-115 44.6-134.7-44.8 2.6-96.6 30.5-126.1 64.8-32.5 36.8-51.6 82.3-47.5 133.6 48.4 3.7 92.6-21.2 129-63.7z"}}]},name:"apple",theme:"outlined"},kr}function _r(){if(wr)return Nr;wr=1;var e=m().default,t=p().default;Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.default=void 0;var r=t(h()),s=e(n()),a=t(Ir()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return Nr.default=c,Nr}function Tr(){return Cr||(Cr=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=_r())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(Sr,Sr.exports)),Sr.exports}const Pr=o(Tr());var Rr,Er,Gr,Mr={exports:{}},Ar={},Fr={};function Dr(){if(Rr)return Fr;Rr=1,Object.defineProperty(Fr,"__esModule",{value:!0});return Fr.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},Fr}function Or(){if(Er)return Ar;Er=1;var e=m().default,t=p().default;Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.default=void 0;var r=t(h()),s=e(n()),a=t(Dr()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return Ar.default=c,Ar}function Lr(){return Gr||(Gr=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=Or())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(Mr,Mr.exports)),Mr.exports}const $r=o(Lr());var zr,Ur,qr,Vr={exports:{}},Br={},Qr={};function Kr(){if(zr)return Qr;zr=1,Object.defineProperty(Qr,"__esModule",{value:!0});return Qr.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832.6 191.4c-84.6-84.6-221.5-84.6-306 0l-96.9 96.9 51 51 96.9-96.9c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204l-96.9 96.9 51.1 51.1 96.9-96.9c84.4-84.6 84.4-221.5-.1-306.1zM446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l96.9-96.9-51.1-51.1-96.9 96.9c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l96.9-96.9-51-51-96.8 97zM260.3 209.4a8.03 8.03 0 00-11.3 0L209.4 249a8.03 8.03 0 000 11.3l554.4 554.4c3.1 3.1 8.2 3.1 11.3 0l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3L260.3 209.4z"}}]},name:"disconnect",theme:"outlined"},Qr}function Hr(){if(Ur)return Br;Ur=1;var e=m().default,t=p().default;Object.defineProperty(Br,"__esModule",{value:!0}),Br.default=void 0;var r=t(h()),s=e(n()),a=t(Kr()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return Br.default=c,Br}function Wr(){return qr||(qr=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=Hr())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(Vr,Vr.exports)),Vr.exports}const Xr=o(Wr());var Yr,Jr,Zr,es={exports:{}},ts={},rs={};function ss(){if(Yr)return rs;Yr=1,Object.defineProperty(rs,"__esModule",{value:!0});return rs.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M841 370c3-3.3 2.7-8.3-.6-11.3a8.24 8.24 0 00-5.3-2.1h-72.6c-2.4 0-4.6 1-6.1 2.8L633.5 504.6a7.96 7.96 0 01-13.4-1.9l-63.5-141.3a7.9 7.9 0 00-7.3-4.7H380.7l.9-4.7 8-42.3c10.5-55.4 38-81.4 85.8-81.4 18.6 0 35.5 1.7 48.8 4.7l14.1-66.8c-22.6-4.7-35.2-6.1-54.9-6.1-103.3 0-156.4 44.3-175.9 147.3l-9.4 49.4h-97.6c-3.8 0-7.1 2.7-7.8 6.4L181.9 415a8.07 8.07 0 007.8 9.7H284l-89 429.9a8.07 8.07 0 007.8 9.7H269c3.8 0 7.1-2.7 7.8-6.4l89.7-433.1h135.8l68.2 139.1c1.4 2.9 1 6.4-1.2 8.8l-180.6 203c-2.9 3.3-2.6 8.4.7 11.3 1.5 1.3 3.4 2 5.3 2h72.7c2.4 0 4.6-1 6.1-2.8l123.7-146.7c2.8-3.4 7.9-3.8 11.3-1 .9.8 1.6 1.7 2.1 2.8L676.4 784c1.3 2.8 4.1 4.7 7.3 4.7h64.6a8.02 8.02 0 007.2-11.5l-95.2-198.9c-1.4-2.9-.9-6.4 1.3-8.8L841 370z"}}]},name:"function",theme:"outlined"},rs}function as(){if(Jr)return ts;Jr=1;var e=m().default,t=p().default;Object.defineProperty(ts,"__esModule",{value:!0}),ts.default=void 0;var r=t(h()),s=e(n()),a=t(ss()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return ts.default=c,ts}function ns(){return Zr||(Zr=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=as())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(es,es.exports)),es.exports}const os=o(ns());var is,cs,ls,ds={exports:{}},us={},ms={};function ps(){if(is)return ms;is=1,Object.defineProperty(ms,"__esModule",{value:!0});return ms.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M120.1 770.6L443 823.2V543.8H120.1v226.8zm63.4-163.5h196.2v141.6l-196.2-31.9V607.1zm340.3 226.5l382 62.2v-352h-382v289.8zm63.4-226.5h255.3v214.4l-255.3-41.6V607.1zm-63.4-415.7v288.8h382V128.1l-382 63.3zm318.7 225.5H587.3V245l255.3-42.3v214.2zm-722.4 63.3H443V201.9l-322.9 53.5v224.8zM183.5 309l196.2-32.5v140.4H183.5V309z"}}]},name:"windows",theme:"outlined"},ms}function hs(){if(cs)return us;cs=1;var e=m().default,t=p().default;Object.defineProperty(us,"__esModule",{value:!0}),us.default=void 0;var r=t(h()),s=e(n()),a=t(ps()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return us.default=c,us}function ys(){return ls||(ls=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=hs())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(ds,ds.exports)),ds.exports}const gs=o(ys());var fs,xs,vs,js={exports:{}},bs={},ws={};function Cs(){if(fs)return ws;fs=1,Object.defineProperty(ws,"__esModule",{value:!0});return ws.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656zM340 683v77c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-77c-10.1 3.3-20.8 5-32 5s-21.9-1.8-32-5zm64-198V264c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v221c10.1-3.3 20.8-5 32-5s21.9 1.8 32 5zm-64 198c10.1 3.3 20.8 5 32 5s21.9-1.8 32-5c41.8-13.5 72-52.7 72-99s-30.2-85.5-72-99c-10.1-3.3-20.8-5-32-5s-21.9 1.8-32 5c-41.8 13.5-72 52.7-72 99s30.2 85.5 72 99zm.1-115.7c.3-.6.7-1.2 1-1.8v-.1l1.2-1.8c.1-.2.2-.3.3-.5.3-.5.7-.9 1-1.4.1-.1.2-.3.3-.4.5-.6.9-1.1 1.4-1.6l.3-.3 1.2-1.2.4-.4c.5-.5 1-.9 1.6-1.4.6-.5 1.1-.9 1.7-1.3.2-.1.3-.2.5-.3.5-.3.9-.7 1.4-1 .1-.1.3-.2.4-.3.6-.4 1.2-.7 1.9-1.1.1-.1.3-.1.4-.2.5-.3 1-.5 1.6-.8l.6-.3c.7-.3 1.3-.6 2-.8.7-.3 1.4-.5 2.1-.7.2-.1.4-.1.6-.2.6-.2 1.1-.3 1.7-.4.2 0 .3-.1.5-.1.7-.2 1.5-.3 2.2-.4.2 0 .3 0 .5-.1.6-.1 1.2-.1 1.8-.2h.6c.8 0 1.5-.1 2.3-.1s1.5 0 2.3.1h.6c.6 0 1.2.1 1.8.2.2 0 .3 0 .5.1.7.1 1.5.2 2.2.4.2 0 .3.1.5.1.6.1 1.2.3 1.7.4.2.1.4.1.6.2.7.2 1.4.4 2.1.7.7.2 1.3.5 2 .8l.6.3c.5.2 1.1.5 1.6.8.1.1.3.1.4.2.6.3 1.3.7 1.9 1.1.1.1.3.2.4.3.5.3 1 .6 1.4 1 .2.1.3.2.5.3.6.4 1.2.9 1.7 1.3s1.1.9 1.6 1.4l.4.4 1.2 1.2.3.3c.5.5 1 1.1 1.4 1.6.1.1.2.3.3.4.4.4.7.9 1 1.4.1.2.2.3.3.5l1.2 1.8s0 .1.1.1a36.18 36.18 0 015.1 18.5c0 6-1.5 11.7-4.1 16.7-.3.6-.7 1.2-1 1.8 0 0 0 .1-.1.1l-1.2 1.8c-.1.2-.2.3-.3.5-.3.5-.7.9-1 1.4-.1.1-.2.3-.3.4-.5.6-.9 1.1-1.4 1.6l-.3.3-1.2 1.2-.4.4c-.5.5-1 .9-1.6 1.4-.6.5-1.1.9-1.7 1.3-.2.1-.3.2-.5.3-.5.3-.9.7-1.4 1-.1.1-.3.2-.4.3-.6.4-1.2.7-1.9 1.1-.1.1-.3.1-.4.2-.5.3-1 .5-1.6.8l-.6.3c-.7.3-1.3.6-2 .8-.7.3-1.4.5-2.1.7-.2.1-.4.1-.6.2-.6.2-1.1.3-1.7.4-.2 0-.3.1-.5.1-.7.2-1.5.3-2.2.4-.2 0-.3 0-.5.1-.6.1-1.2.1-1.8.2h-.6c-.8 0-1.5.1-2.3.1s-1.5 0-2.3-.1h-.6c-.6 0-1.2-.1-1.8-.2-.2 0-.3 0-.5-.1-.7-.1-1.5-.2-2.2-.4-.2 0-.3-.1-.5-.1-.6-.1-1.2-.3-1.7-.4-.2-.1-.4-.1-.6-.2-.7-.2-1.4-.4-2.1-.7-.7-.2-1.3-.5-2-.8l-.6-.3c-.5-.2-1.1-.5-1.6-.8-.1-.1-.3-.1-.4-.2-.6-.3-1.3-.7-1.9-1.1-.1-.1-.3-.2-.4-.3-.5-.3-1-.6-1.4-1-.2-.1-.3-.2-.5-.3-.6-.4-1.2-.9-1.7-1.3s-1.1-.9-1.6-1.4l-.4-.4-1.2-1.2-.3-.3c-.5-.5-1-1.1-1.4-1.6-.1-.1-.2-.3-.3-.4-.4-.4-.7-.9-1-1.4-.1-.2-.2-.3-.3-.5l-1.2-1.8v-.1c-.4-.6-.7-1.2-1-1.8-2.6-5-4.1-10.7-4.1-16.7s1.5-11.7 4.1-16.7zM620 539v221c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V539c-10.1 3.3-20.8 5-32 5s-21.9-1.8-32-5zm64-198v-77c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v77c10.1-3.3 20.8-5 32-5s21.9 1.8 32 5zm-64 198c10.1 3.3 20.8 5 32 5s21.9-1.8 32-5c41.8-13.5 72-52.7 72-99s-30.2-85.5-72-99c-10.1-3.3-20.8-5-32-5s-21.9 1.8-32 5c-41.8 13.5-72 52.7-72 99s30.2 85.5 72 99zm.1-115.7c.3-.6.7-1.2 1-1.8v-.1l1.2-1.8c.1-.2.2-.3.3-.5.3-.5.7-.9 1-1.4.1-.1.2-.3.3-.4.5-.6.9-1.1 1.4-1.6l.3-.3 1.2-1.2.4-.4c.5-.5 1-.9 1.6-1.4.6-.5 1.1-.9 1.7-1.3.2-.1.3-.2.5-.3.5-.3.9-.7 1.4-1 .1-.1.3-.2.4-.3.6-.4 1.2-.7 1.9-1.1.1-.1.3-.1.4-.2.5-.3 1-.5 1.6-.8l.6-.3c.7-.3 1.3-.6 2-.8.7-.3 1.4-.5 2.1-.7.2-.1.4-.1.6-.2.6-.2 1.1-.3 1.7-.4.2 0 .3-.1.5-.1.7-.2 1.5-.3 2.2-.4.2 0 .3 0 .5-.1.6-.1 1.2-.1 1.8-.2h.6c.8 0 1.5-.1 2.3-.1s1.5 0 2.3.1h.6c.6 0 1.2.1 1.8.2.2 0 .3 0 .5.1.7.1 1.5.2 2.2.4.2 0 .3.1.5.1.6.1 1.2.3 1.7.4.2.1.4.1.6.2.7.2 1.4.4 2.1.7.7.2 1.3.5 2 .8l.6.3c.5.2 1.1.5 1.6.8.1.1.3.1.4.2.6.3 1.3.7 1.9 1.1.1.1.3.2.4.3.5.3 1 .6 1.4 1 .2.1.3.2.5.3.6.4 1.2.9 1.7 1.3s1.1.9 1.6 1.4l.4.4 1.2 1.2.3.3c.5.5 1 1.1 1.4 1.6.1.1.2.3.3.4.4.4.7.9 1 1.4.1.2.2.3.3.5l1.2 1.8v.1a36.18 36.18 0 015.1 18.5c0 6-1.5 11.7-4.1 16.7-.3.6-.7 1.2-1 1.8v.1l-1.2 1.8c-.1.2-.2.3-.3.5-.3.5-.7.9-1 1.4-.1.1-.2.3-.3.4-.5.6-.9 1.1-1.4 1.6l-.3.3-1.2 1.2-.4.4c-.5.5-1 .9-1.6 1.4-.6.5-1.1.9-1.7 1.3-.2.1-.3.2-.5.3-.5.3-.9.7-1.4 1-.1.1-.3.2-.4.3-.6.4-1.2.7-1.9 1.1-.1.1-.3.1-.4.2-.5.3-1 .5-1.6.8l-.6.3c-.7.3-1.3.6-2 .8-.7.3-1.4.5-2.1.7-.2.1-.4.1-.6.2-.6.2-1.1.3-1.7.4-.2 0-.3.1-.5.1-.7.2-1.5.3-2.2.4-.2 0-.3 0-.5.1-.6.1-1.2.1-1.8.2h-.6c-.8 0-1.5.1-2.3.1s-1.5 0-2.3-.1h-.6c-.6 0-1.2-.1-1.8-.2-.2 0-.3 0-.5-.1-.7-.1-1.5-.2-2.2-.4-.2 0-.3-.1-.5-.1-.6-.1-1.2-.3-1.7-.4-.2-.1-.4-.1-.6-.2-.7-.2-1.4-.4-2.1-.7-.7-.2-1.3-.5-2-.8l-.6-.3c-.5-.2-1.1-.5-1.6-.8-.1-.1-.3-.1-.4-.2-.6-.3-1.3-.7-1.9-1.1-.1-.1-.3-.2-.4-.3-.5-.3-1-.6-1.4-1-.2-.1-.3-.2-.5-.3-.6-.4-1.2-.9-1.7-1.3s-1.1-.9-1.6-1.4l-.4-.4-1.2-1.2-.3-.3c-.5-.5-1-1.1-1.4-1.6-.1-.1-.2-.3-.3-.4-.4-.4-.7-.9-1-1.4-.1-.2-.2-.3-.3-.5l-1.2-1.8v-.1c-.4-.6-.7-1.2-1-1.8-2.6-5-4.1-10.7-4.1-16.7s1.5-11.7 4.1-16.7z"}}]},name:"control",theme:"outlined"},ws}function Ss(){if(xs)return bs;xs=1;var e=m().default,t=p().default;Object.defineProperty(bs,"__esModule",{value:!0}),bs.default=void 0;var r=t(h()),s=e(n()),a=t(Cs()),o=t(y()),i=function(e,t){return s.createElement(o.default,(0,r.default)({},e,{ref:t,icon:a.default}))},c=s.forwardRef(i);return bs.default=c,bs}function Ns(){return vs||(vs=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r;const s=(r=Ss())&&r.__esModule?r:{default:r};t.default=s,e.exports=s}(js,js.exports)),js.exports}const ks=o(Ns()),Is=()=>{const e=t(),[s,a]=i.useState([]);i.useEffect(()=>{const e=L.subscribe(e=>{a(e)});return()=>{e()}},[]);const n=async e=>{const t=e.priority&&e.priority>=1&&e.priority<=5?e.priority:3,r={...e,queueVault:J(e.queueVault),priority:t},s=await d.post("/CreateQueueItem",r),a=s.resultSets[1]?.data[0]?.taskId||s.resultSets[1]?.data[0]?.TaskId;return{...s,taskId:a}};return{...r({mutationFn:async e=>{const t=await L.addToQueue(e,n);return 1===e.priority?{queueId:t,isQueued:!0}:{taskId:t,isQueued:!1}},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["queue-items"]}),e.invalidateQueries({queryKey:["queue-items-bridge",r.bridgeName]}),t.isQueued||t.taskId},onError:e=>{l("error",e.message||"Failed to create queue item")}}),localQueue:s,queueStats:L.getQueueStats(),retryQueueItem:e=>L.retryItem(e),removeFromQueue:e=>L.removeFromQueue(e),clearCompleted:()=>L.clearCompleted(),getQueuePosition:e=>L.getQueuePosition(e),getQueueItem:e=>L.getQueueItem(e),subscribeToQueueItem:(e,t)=>L.subscribeToQueueItem(e,t)}};const _s=new class{PROTOCOL_SCHEME="rediacc";async generateUrl(e){const{team:t,machine:r,repository:s,action:a,queryParams:n}=e,{createFreshForkToken:o}=await re(async()=>{const{createFreshForkToken:e}=await import("./forkTokenService.ts-BgcpHq4E.js");return{createFreshForkToken:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8])),{apiConnectionService:i}=await re(async()=>{const{apiConnectionService:e}=await import("../index-DRw3QGwP.js").then(e=>e.a5);return{apiConnectionService:e}},__vite__mapDeps([3,4,2,5,1,6,7,8]));let c=await i.getApiUrl();if(c.startsWith("/")){c=`${window.location.protocol}//${window.location.host}${c}`}const l=a||"default",d=await o(l),u=[encodeURIComponent(d),encodeURIComponent(t),encodeURIComponent(r)];s&&""!==s.trim()&&u.push(encodeURIComponent(s)),a&&u.push(a);let m=`${this.PROTOCOL_SCHEME}://${u.join("/")}`;const p=new URLSearchParams;p.append("apiUrl",c),n&&Object.keys(n).length>0&&Object.entries(n).forEach(([e,t])=>{null!=t&&("boolean"==typeof t?p.append(e,t?"yes":"no"):p.append(e,String(t)))});const h=p.toString();return h&&(m+=`?${h}`),m}async generateTerminalUrl(e,t,r){return await this.generateUrl({...e,action:"terminal",queryParams:{...t,...r}})}async generateDesktopUrl(e,t,r){return await this.generateUrl({...e,action:"desktop",queryParams:{...t,...r}})}async generateContainerTerminalUrl(e,t,r){return await this.generateUrl({...e,action:"terminal",queryParams:{terminalType:"container",...t,...r}})}async generateContainerLogsUrl(e,t,r){return await this.generateUrl({...e,action:"terminal",queryParams:{terminalType:"container",action:"logs",lines:t.lines||100,follow:!0,...t,...r}})}async generateContainerStatsUrl(e,t,r){return await this.generateUrl({...e,action:"terminal",queryParams:{terminalType:"container",action:"stats",...t,...r}})}async openUrl(e){return new Promise(t=>{let r=!1;const s=setTimeout(()=>{r||(r=!0,t({success:!1,error:{type:"timeout",message:"Protocol handler did not respond"}}))},3e3),a=()=>{r||(r=!0,clearTimeout(s),window.removeEventListener("blur",a),t({success:!0}))};window.addEventListener("blur",a);try{"function"==typeof window.signalProtocolLaunch&&window.signalProtocolLaunch(),window.open(e,"_self")}catch(n){r=!0,clearTimeout(s),window.removeEventListener("blur",a),t({success:!1,error:{type:"exception",message:n instanceof Error?n.message:"Unknown error"}})}})}async checkProtocolAvailable(){try{const e=`${this.PROTOCOL_SCHEME}://test`,t=document.createElement("iframe");return t.style.display="none",new Promise(r=>{setTimeout(()=>{document.body.removeChild(t),r(!1)},2e3),document.body.appendChild(t),t.src=e})}catch{return!1}}async checkProtocolStatus(){try{if(await this.checkProtocolAvailable())return{available:!0,method:"iframe",confidence:"medium"}}catch(e){}try{const t=`${this.PROTOCOL_SCHEME}://status-check/test/test/test`;return new Promise(r=>{let s=!1;const a=window.open("","_blank","width=1,height=1,left=-1000,top=-1000");if(!a)return void r({available:!1,method:"unknown",confidence:"low",errorReason:"Popup blocked"});const n=setTimeout(()=>{if(!s){s=!0;try{a.close()}catch(e){}r({available:!1,method:"navigation",confidence:"medium",errorReason:"Timeout - protocol handler may not be registered"})}},3e3);try{a.location.href=t,setTimeout(()=>{if(!s)try{const e=a.location.href;s=!0,clearTimeout(n),a.close(),r(e===t||"about:blank"===e?{available:!1,method:"navigation",confidence:"high",errorReason:"Protocol handler not registered"}:{available:!0,method:"navigation",confidence:"high"})}catch(e){s=!0,clearTimeout(n);try{a.close()}catch(o){}r({available:!0,method:"navigation",confidence:"medium"})}},1e3)}catch(e){s=!0,clearTimeout(n);try{a.close()}catch(o){}r({available:!1,method:"navigation",confidence:"low",errorReason:`Navigation error: ${e}`})}})}catch(e){return{available:!1,method:"unknown",confidence:"low",errorReason:`Detection failed: ${e}`}}}getInstallInstructions(){return[{platform:"Windows",instructions:["Download and install Rediacc CLI","Open PowerShell as Administrator","Navigate to the Rediacc CLI directory","Run: rediacc.bat -RegisterProtocol","Restart your browser"]},{platform:"macOS",instructions:["Download and install Rediacc CLI","Open Terminal","Navigate to the Rediacc CLI directory","Run: ./rediacc --register-protocol","You may need to grant permission when prompted"]},{platform:"Linux",instructions:["Download and install Rediacc CLI","Open Terminal","Navigate to the Rediacc CLI directory","Run: ./rediacc --register-protocol","Log out and log back in for changes to take effect"]}]}async generateSyncUrl(e,t,r){return await this.generateUrl({...e,action:"desktop",queryParams:{action:"sync",...t,...r}})}async generatePluginUrl(e,t,r){return await this.generateUrl({...e,action:"desktop",queryParams:{action:"plugin",...t,...r}})}async generateBrowserUrl(e,t,r){return await this.generateUrl({...e,action:"desktop",queryParams:{action:"browser",...t,...r}})}async generateAllActionUrls(e){return{navigate:await this.generateUrl(e),terminal:await this.generateTerminalUrl(e),desktop:await this.generateDesktopUrl(e)}}};const Ts=new class{generateInstallCommand(e={}){const t=["pip install"];e.useUser&&t.push("--user"),e.upgrade&&t.push("--upgrade");let r="rediacc";return e.includeGui&&(r+="[gui]"),e.version&&(r+=`==${e.version}`),t.push(r),t.join(" ")}generateProtocolCommand(){return"rediacc --register-protocol"}getPlatformInstructions(){switch(this.detectPlatform()){case"windows":return{platform:"windows",pipInstallCommand:"python -m pip install --upgrade pip",pythonCheckCommand:"python --version",notes:["Run PowerShell as Administrator for system-wide installation",'Use "py -m pip" if "pip" command is not found',"Restart your browser after protocol registration"]};case"macos":return{platform:"macos",pipInstallCommand:"python3 -m pip install --upgrade pip",pythonCheckCommand:"python3 --version",notes:['Use "python3" instead of "python" on macOS',"You may need to install pip with: python3 -m ensurepip","Grant permission when prompted for protocol handler"]};case"linux":return{platform:"linux",pipInstallCommand:"python3 -m pip install --upgrade pip",pythonCheckCommand:"python3 --version",notes:["You may need to install pip: sudo apt install python3-pip","Use --user flag to avoid permission issues","Log out and back in after protocol registration"]}}}getInstallationCommands(e={}){const t=this.detectPlatform();return{install:this.generateInstallCommand(e),postInstall:[this.generateProtocolCommand(),"windows"===t?"Restart your browser":"Restart your browser or log out/in"],verify:["rediacc --version","rediacc --check-protocol"]}}getTroubleshootingCommands(e){switch(e){case"pip-not-found":return"windows"===this.detectPlatform()?{description:"Pip is not installed. Install it with:",commands:["python -m ensurepip --upgrade","# Or download get-pip.py from https://pip.pypa.io/en/stable/installation/"]}:{description:"Pip is not installed. Install it with:",commands:["python3 -m ensurepip --upgrade","# Or on Ubuntu/Debian: sudo apt install python3-pip","# Or on macOS with Homebrew: brew install python3"]};case"permission-denied":return{description:"Permission denied. Try one of these approaches:",commands:["# Option 1: Install for current user only",this.generateInstallCommand({useUser:!0}),"","# Option 2: Use virtual environment","python3 -m venv rediacc-env","source rediacc-env/bin/activate  # On Windows: rediacc-env\\Scripts\\activate",this.generateInstallCommand()]};case"python-version":return{description:"Python version is too old. Rediacc requires Python 3.7+",commands:["# Check your Python version","python --version","python3 --version","","# Update Python from https://www.python.org/downloads/"]};default:return{description:"Installation failed. Try these steps:",commands:["# 1. Update pip","python -m pip install --upgrade pip","","# 2. Install with verbose output","pip install -v rediacc","","# 3. Check for errors in the output above"]}}}getVirtualEnvInstructions(){const e=this.detectPlatform();return{description:"Using a virtual environment (recommended for development):",commands:["# Create virtual environment",`${"windows"===e?"python":"python3"} -m venv rediacc-env`,"","# Activate virtual environment","windows"===e?"rediacc-env\\Scripts\\activate":"source rediacc-env/bin/activate","","# Install Rediacc CLI",this.generateInstallCommand({includeGui:!0}),"","# Register protocol (still needed)",this.generateProtocolCommand()]}}getUninstallInstructions(){return{description:"To uninstall Rediacc CLI:",commands:["# Unregister protocol handler first","rediacc --unregister-protocol","","# Uninstall package","pip uninstall rediacc","","# Remove configuration (optional)","# Linux/macOS: rm -rf ~/.rediacc","# Windows: rmdir /s %USERPROFILE%\\.rediacc"]}}detectPlatform(){const e=navigator.userAgent.toLowerCase();return e.includes("win")?"windows":e.includes("mac")?"macos":"linux"}formatCommandsForDisplay(e){return e.map(e=>{const t=e.trim(),r=t.startsWith("#");return{text:e,isCommand:t.length>0&&!r,isComment:r}})}},{Text:Ps,Title:Rs}=xe,{Panel:Es}=je,Gs=({command:e,description:t,showCopy:r=!0})=>{const[a,n]=i.useState(!1),o=i.useCallback(async()=>{try{await navigator.clipboard.writeText(e),n(!0),be.success("Command copied to clipboard!"),n(!1)}catch(t){be.error("Failed to copy command")}},[e]),c=Ts.formatCommandsForDisplay([e]),{isCommand:l,isComment:d}=c[0];return s.jsxs("div",{style:{marginBottom:x("XS")},"data-testid":"pip-install-command-display",children:[t&&s.jsx(Ps,{type:"secondary",style:{display:"block",marginBottom:x("MICRO")},children:t}),s.jsxs("div",{style:{background:"#f5f5f5",border:"1px solid #d9d9d9",borderRadius:f.BORDER_RADIUS.SM,padding:`${x("XS")}px ${x("SM")}px`,fontFamily:"monospace",fontSize:f.FONT_SIZE.SM,display:"flex",alignItems:"center",justifyContent:"space-between"},"data-testid":"pip-install-command-text",children:[s.jsx(Ps,{code:!0,style:{background:"transparent",border:"none",color:d?"#8c8c8c":l?"#1890ff":"inherit"},children:e}),r&&l&&s.jsx(ge,{size:"small",icon:a?s.jsx(se,{}):s.jsx(A,{}),style:{marginLeft:x("XS")},onClick:o,"data-testid":"pip-install-command-copy"})]})]})},Ms=({visible:e,onClose:t,errorType:r="not-installed"})=>{const{t:a}=ae(),n=u(),[o,c]=i.useState(!0),[l,d]=i.useState(!1),[m,p]=i.useState("quick"),h=i.useMemo(()=>Ts.getPlatformInstructions(),[]),y={includeGui:o,useUser:l},v=Ts.getInstallationCommands(y),j=Ts.getVirtualEnvInstructions(),b=Ts.getUninstallInstructions(),w=()=>{const e=[v.install,...v.postInstall.filter(e=>!e.includes("Restart")),...v.verify].join("\n");navigator.clipboard.writeText(e),be.success("All commands copied to clipboard!")},C=()=>{switch(h.platform){case"windows":return s.jsx(gs,{});case"macos":return s.jsx(Pr,{});default:return s.jsx(M,{})}};return s.jsx(pe,{title:s.jsxs(ye,{children:[s.jsx(Z,{}),(()=>{switch(r){case"protocol-not-registered":return a("resources:pipInstall.protocolNotRegisteredTitle");case"permission-denied":return a("resources:pipInstall.permissionDeniedTitle");default:return a("resources:pipInstall.installRediaccCli")}})()]}),open:e,onCancel:t,footer:[s.jsx(ge,{onClick:t,"data-testid":"pip-install-close-button",style:n.buttonSecondary,children:a("common:close")},"close")],style:g(f.DIMENSIONS.MODAL_WIDTH_LG),"data-testid":"pip-install-modal",children:s.jsx(he,{activeKey:m,onChange:p,"data-testid":"pip-install-tabs",items:[{key:"quick",label:s.jsxs(ye,{children:[s.jsx(Z,{}),a("resources:pipInstall.quickInstall")]}),children:s.jsxs(ye,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsx(fe,{message:a("resources:pipInstall.quickInstallTitle"),description:a("resources:pipInstall.quickInstallDesc"),type:"info",showIcon:!0,icon:s.jsx(Z,{}),"data-testid":"pip-install-quick-alert"}),s.jsxs("div",{children:[s.jsx(Rs,{level:5,children:a("resources:pipInstall.step1Install")}),s.jsx(Gs,{command:Ts.generateInstallCommand(y),description:a("resources:pipInstall.installCommandDesc")}),s.jsxs(ye,{style:{marginTop:x("XS")},children:[s.jsx(ve,{checked:o,onChange:e=>c(e.target.checked),"data-testid":"pip-install-gui-checkbox",children:a("resources:pipInstall.includeGuiSupport")}),s.jsx(ve,{checked:l,onChange:e=>d(e.target.checked),"data-testid":"pip-install-user-checkbox",children:a("resources:pipInstall.userInstallOnly")})]})]}),s.jsxs("div",{children:[s.jsx(Rs,{level:5,children:a("resources:pipInstall.step2Register")}),s.jsx(Gs,{command:Ts.generateProtocolCommand(),description:a("resources:pipInstall.registerCommandDesc")})]}),s.jsxs("div",{children:[s.jsx(Rs,{level:5,children:a("resources:pipInstall.step3Verify")}),v.verify.map((e,t)=>s.jsx(Gs,{command:e},t))]}),s.jsx(fe,{message:s.jsxs(ye,{children:[C(),a("resources:pipInstall.platformSpecific",{platform:h.platform})]}),description:s.jsx("ul",{style:{marginBottom:0,paddingLeft:20},children:h.notes.map((e,t)=>s.jsx("li",{children:e},t))}),type:"warning","data-testid":"pip-install-platform-alert"}),s.jsx(ge,{type:"primary",icon:s.jsx(A,{}),onClick:w,block:!0,"data-testid":"pip-install-copy-all-button",style:n.buttonPrimary,children:a("resources:pipInstall.copyAllCommands")})]})},{key:"advanced",label:s.jsxs(ye,{children:[s.jsx(ee,{}),a("resources:pipInstall.advancedOptions")]}),children:s.jsxs(je,{defaultActiveKey:[],"data-testid":"pip-install-advanced-collapse",children:[s.jsx(Es,{header:a("resources:pipInstall.virtualEnvironment"),extra:s.jsx(ne,{color:"green",children:a("resources:pipInstall.recommended")}),children:s.jsxs(ye,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Ps,{children:j.description}),j.commands.map((e,t)=>s.jsx(Gs,{command:e,showCopy:!e.startsWith("#")},t))]})},"venv"),s.jsx(Es,{header:a("resources:pipInstall.specificVersion"),children:s.jsxs(ye,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Ps,{children:a("resources:pipInstall.versionDesc")}),s.jsx(Gs,{command:"pip install rediacc==1.0.0"}),s.jsx(Gs,{command:"pip install rediacc>=1.0.0,<2.0.0"}),s.jsx(Gs,{command:"pip install --upgrade rediacc",description:a("resources:pipInstall.upgradeDesc")})]})},"version"),s.jsx(Es,{header:a("resources:pipInstall.uninstall"),children:s.jsxs(ye,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Ps,{children:b.description}),b.commands.map((e,t)=>s.jsx(Gs,{command:e,showCopy:!e.startsWith("#")},t))]})},"uninstall")]})},{key:"troubleshooting",label:s.jsxs(ye,{children:[s.jsx(te,{}),a("resources:pipInstall.troubleshooting")]}),children:s.jsxs(ye,{direction:"vertical",size:"large",style:{width:"100%"},children:[s.jsx(fe,{message:a("resources:pipInstall.commonIssues"),type:"info",showIcon:!0,"data-testid":"pip-install-issues-alert"}),s.jsxs(je,{defaultActiveKey:["pip-not-found"],"data-testid":"pip-install-troubleshooting-collapse",children:[s.jsx(Es,{header:a("resources:pipInstall.pipNotFound"),extra:s.jsx(ne,{color:"red",children:a("resources:pipInstall.error")}),children:(()=>{const e=Ts.getTroubleshootingCommands("pip-not-found");return s.jsxs(ye,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Ps,{children:e.description}),e.commands.map((e,t)=>s.jsx(Gs,{command:e,showCopy:!e.startsWith("#")},t))]})})()},"pip-not-found"),s.jsx(Es,{header:a("resources:pipInstall.permissionDenied"),extra:s.jsx(ne,{color:"orange",children:a("resources:pipInstall.warning")}),children:(()=>{const e=Ts.getTroubleshootingCommands("permission-denied");return s.jsxs(ye,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Ps,{children:e.description}),e.commands.map((e,t)=>s.jsx(Gs,{command:e,showCopy:!e.startsWith("#")},t))]})})()},"permission"),s.jsx(Es,{header:a("resources:pipInstall.pythonVersion"),children:(()=>{const e=Ts.getTroubleshootingCommands("python-version");return s.jsxs(ye,{direction:"vertical",style:{width:"100%"},children:[s.jsx(Ps,{children:e.description}),e.commands.map((e,t)=>s.jsx(Gs,{command:e,showCopy:!e.startsWith("#")},t))]})})()},"python-version")]}),s.jsx(fe,{message:a("resources:pipInstall.stillNeedHelp"),description:s.jsxs(ye,{direction:"vertical",children:[s.jsxs(Ps,{children:[a("resources:pipInstall.checkDocs"),": "," ",s.jsx("a",{href:"https://www.rediacc.com/docs/cli/installation",target:"_blank",rel:"noopener noreferrer","data-testid":"pip-install-docs-link",children:a("resources:pipInstall.installationGuide")})]}),s.jsxs(Ps,{children:[a("resources:pipInstall.reportIssue"),": "," ",s.jsx("a",{href:"https://github.com/rediacc/cli/issues",target:"_blank",rel:"noopener noreferrer","data-testid":"pip-install-github-link",children:"GitHub Issues"})]})]}),type:"info","data-testid":"pip-install-help-alert"})]})}]})})},{Text:As,Paragraph:Fs}=xe,{TabPane:Ds}=he,Os=({visible:e,onClose:t,machine:r,repository:a,pluginContainers:n=[]})=>{const{t:o}=ae(),{token:c}=we.useToken(),[l,d]=i.useState("terminal"),[u,m]=i.useState("unix"),[p,h]=i.useState(!1),[y,g]=i.useState(!0),[f,x]=i.useState(""),[v,j]=i.useState(""),[b,w]=i.useState(!1),[C,S]=i.useState("");i.useEffect(()=>{if(e){const e=window.location.protocol,t=window.location.host;x(`${e}//${t}/api`)}},[e]);i.useEffect(()=>{e||S("")},[e]);const N=(e="<SECURE_TOKEN>")=>{const t=`${p?`docker run -it --rm${p&&y?" --network=host":""} -e SYSTEM_API_URL="${f}" rediacc/cli term`:"windows"===u?"rediacc.bat term":"rediacc term"}${` --token "${e}"`} --team Default${` --machine ${r}`}${a?` --repo ${a}`:""}${v?` --command "${v}"`:""}`;return p?t:`${"windows"===u?`set REDIACC_API_URL=${f}`:`export REDIACC_API_URL="${f}"`} && ${t}`},k=(e="<SECURE_TOKEN>")=>{const t=`${p?`docker run -it --rm${p&&y?" --network=host":""} -e SYSTEM_API_URL="${f}" rediacc/cli desktop`:"windows"===u?"rediacc.bat desktop":"rediacc desktop"}${` --token "${e}"`} --team Default${` --machine ${r}`}${a?` --repo ${a}`:""}`;return p?t:`${"windows"===u?`set REDIACC_API_URL=${f}`:`export REDIACC_API_URL="${f}"`} && ${t}`},I=async()=>{try{w(!0);const e=await(async e=>{w(!0),S("");try{return await Te(e)}catch(t){const e=t instanceof Error?t.message:"Failed to generate token";throw S(e),be.error(`Token generation failed: ${e}`),t}finally{w(!1)}})(l),r="desktop"===l?k(e):N(e);await navigator.clipboard.writeText(r),be.success(o("common:copiedToClipboard")),t()}catch(e){try{const e="desktop"===l?(()=>{const e=`${p?`docker run -it --rm${p&&y?" --network=host":""} -e SYSTEM_API_URL="${f}" rediacc/cli desktop`:"windows"===u?"rediacc.bat desktop":"rediacc desktop"} --team Default --machine ${r}${a?` --repo ${a}`:""}`;return p?e:`${"windows"===u?`set REDIACC_API_URL=${f}`:`export REDIACC_API_URL="${f}"`} && ${e}`})():(()=>{const e=`${p?`docker run -it --rm${p&&y?" --network=host":""} -e SYSTEM_API_URL="${f}" rediacc/cli term`:"windows"===u?"rediacc.bat term":"rediacc term"} --team Default --machine ${r}${a?` --repo ${a}`:""}${v?` --command "${v}"`:""}`;return p?e:`${"windows"===u?`set REDIACC_API_URL=${f}`:`export REDIACC_API_URL="${f}"`} && ${e}`})();await navigator.clipboard.writeText(e),be.warning("Copied without secure token - please login manually"),t()}catch(s){be.error(o("common:copyFailed"))}}finally{w(!1)}},_=()=>{switch(l){case"terminal":default:return N();case"desktop":return k()}};return s.jsxs(pe,{title:o("resources:localCommandBuilder.title"),open:e,onCancel:t,width:800,footer:null,children:[s.jsx("div",{style:{marginBottom:16},children:s.jsx(As,{type:"secondary",children:o("resources:localCommandBuilder.description",{machine:r,repository:a})})}),s.jsx(Ce,{layout:"vertical",style:{marginBottom:16},children:s.jsx(Ce.Item,{label:o("resources:localCommandBuilder.operatingSystem"),children:s.jsxs(Se.Group,{value:u,onChange:e=>m(e.target.value),children:[s.jsxs(Se.Button,{value:"unix",children:[s.jsx(Pr,{})," ",o("resources:localCommandBuilder.unixLinuxMac")]}),s.jsxs(Se.Button,{value:"windows",children:[s.jsx(gs,{})," ",o("resources:localCommandBuilder.windows")]})]})})}),s.jsxs(he,{activeKey:l,onChange:d,children:[s.jsx(Ds,{tab:o("resources:localCommandBuilder.terminalTab"),icon:s.jsx(ee,{}),children:s.jsx(Ce,{layout:"vertical",children:s.jsx(Ce.Item,{label:o("resources:localCommandBuilder.command"),help:o("resources:localCommandBuilder.commandHelp"),children:s.jsx(Ne,{placeholder:"docker ps",value:v,onChange:e=>j(e.target.value),autoComplete:"off"})})})},"terminal"),s.jsx(Ds,{tab:o("resources:localCommandBuilder.desktopTab"),icon:s.jsx(M,{}),children:s.jsx(Ce,{layout:"vertical",children:s.jsx(Ce.Item,{help:o("resources:localCommandBuilder.desktopHelp"),children:s.jsx(As,{type:"secondary",children:o("resources:localCommandBuilder.desktopDescription")})})})},"desktop")]}),s.jsxs("div",{style:{marginTop:24},children:[s.jsx(Ce.Item,{children:s.jsxs(ve,{checked:p,onChange:e=>h(e.target.checked),children:[o("resources:localCommandBuilder.useDocker"),s.jsx(As,{type:"secondary",style:{marginLeft:8},children:o("resources:localCommandBuilder.useDockerHelp")})]})}),p&&s.jsx(Ce.Item,{children:s.jsxs(ve,{checked:y,onChange:e=>g(e.target.checked),children:["Use host networking (--network=host)",s.jsx(As,{type:"secondary",style:{marginLeft:8},children:"Required for localhost API access (e.g., http://localhost:7322)"})]})}),s.jsxs("div",{style:{padding:16,backgroundColor:c.colorFillAlter,borderRadius:8,marginBottom:16,border:`1px solid ${c.colorBorder}`},children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[s.jsxs(As,{strong:!0,children:[o("resources:localCommandBuilder.generatedCommand"),":"]}),b&&s.jsx(me,{size:"small"})]}),C?s.jsxs("div",{style:{padding:"12px 0"},children:[s.jsxs(As,{type:"danger",children:["Token generation failed: ",C]}),s.jsx("br",{}),s.jsx(As,{type:"secondary",style:{fontSize:12},children:"Copy will attempt without secure token. You may need to login manually."})]}):null,s.jsx(Fs,{code:!0,copyable:{text:_(),icon:s.jsx(A,{}),onCopy:I},style:{marginTop:8,marginBottom:8},children:_()}),s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsxs(As,{type:"secondary",style:{fontSize:12},children:[o("resources:localCommandBuilder.apiUrl"),": ",f]}),s.jsx(As,{type:"secondary",style:{fontSize:12},children:"Token: Secure token will be generated on copy"})]})]}),s.jsxs(ye,{style:{width:"100%",justifyContent:"flex-end"},children:[s.jsx(ge,{onClick:t,children:o("common:close")}),s.jsx(ge,{type:"primary",icon:s.jsx(A,{}),onClick:I,disabled:b,loading:b,children:o("resources:localCommandBuilder.copyCommand")})]})]})]})},Ls=({machine:e,repository:t,teamName:r="Default",disabled:n=!1,userEmail:o,pluginContainers:c=[],containerId:l,containerName:d,containerState:m,isContainerMenu:p=!1,isMachineOnlyMenu:h=!1})=>{const{t:y}=ae(),[g,f]=i.useState(!1),[x,v]=i.useState("not-installed"),[j,b]=i.useState(!1),[w,C]=i.useState(!1),S=u(),N=a(e=>e.auth.user?.email),k=i.useCallback(async(s,a)=>{const n={team:r,machine:e,repository:h?"":t||""};let o;try{if(p&&l){const e={containerId:l,containerName:d,action:a||"terminal"};switch(a){case"logs":o=await _s.generateContainerLogsUrl(n,e);break;case"stats":o=await _s.generateContainerStatsUrl(n,e);break;default:o=await _s.generateContainerTerminalUrl(n,e)}}else if(s)o="terminal"===s?await _s.generateTerminalUrl(n):"desktop"===s?await _s.generateDesktopUrl(n):await _s.generateUrl(n);else if(p&&l){const e={containerId:l,containerName:d,action:"terminal"};o=await _s.generateDesktopUrl(n,e)}else o=await _s.generateDesktopUrl(n)}catch(c){return void be.error("Failed to create secure connection for desktop app")}b(!0);const i=await _s.openUrl(o);if(b(!1),!i.success){try{const e=await _s.checkProtocolStatus();e.available?v("permission-denied"):e.errorReason?.includes("not registered")?v("protocol-not-registered"):v("not-installed")}catch(u){"timeout"===i.error?.type?v("not-installed"):i.error?.message.includes("permission")?v("permission-denied"):v("protocol-not-registered")}f(!0)}},[r,e,t,p,l,d,h]),I=p?(()=>{const e=[],t="running"===m;return t&&e.push({key:"container-terminal",icon:s.jsx(ee,{style:S.icon.small}),label:s.jsx("span",{style:S.body,children:y("resources:localActions.openContainerTerminal")}),onClick:()=>k(void 0,"terminal"),"data-testid":`local-actions-container-terminal-${l}`}),e.length>0&&e.push({type:"divider"}),e.push({key:"container-logs",icon:s.jsx(jr,{style:S.icon.small}),label:s.jsx("span",{style:S.body,children:y("resources:localActions.viewContainerLogs")}),onClick:()=>k(void 0,"logs"),"data-testid":`local-actions-container-logs-${l}`}),t&&e.push({key:"container-stats",icon:s.jsx(jr,{style:S.icon.small}),label:s.jsx("span",{style:S.body,children:y("resources:localActions.containerStats")}),onClick:()=>k(void 0,"stats"),"data-testid":`local-actions-container-stats-${l}`}),e})():[{key:"open",icon:s.jsx(M,{style:S.icon.small}),label:s.jsx("span",{style:S.body,children:y("resources:localActions.openInDesktop")}),onClick:()=>k(),"data-testid":`local-actions-open-${t}`},{key:"terminal",icon:s.jsx(ee,{style:S.icon.small}),label:s.jsx("span",{style:S.body,children:y("resources:localActions.openTerminal")}),onClick:()=>k("terminal"),"data-testid":`local-actions-terminal-${t}`},{type:"divider"},{key:"cli-commands",icon:s.jsx(jr,{style:S.icon.small}),label:s.jsx("span",{style:S.body,children:y("resources:localActions.showCLICommands")}),onClick:()=>C(!0),"data-testid":`local-actions-cli-commands-${t}`}];return s.jsxs(s.Fragment,{children:[s.jsx(ke,{menu:{items:I},trigger:["click"],disabled:n||j,"data-testid":`local-actions-dropdown-container-${t}`,children:s.jsx(oe,{title:y(p?"resources:localActions.containerLocal":"resources:localActions.local"),children:s.jsx(ge,{size:"small",icon:s.jsx(M,{style:S.icon.small}),loading:j,style:{...S.buttonSecondary,...S.touchTargetSmall,display:"flex",alignItems:"center",gap:"4px"},"data-testid":p?`local-actions-dropdown-${l}`:`local-actions-dropdown-${t}`,"aria-label":y(p?"resources:localActions.containerLocal":"resources:localActions.local")})})}),s.jsx(Ms,{visible:g,onClose:()=>f(!1),errorType:x}),!p&&s.jsx(Os,{visible:w,onClose:()=>C(!1),machine:e,repository:t,userEmail:o||N||"",pluginContainers:c})]})},{Text:$s}=xe,zs=({machine:e,onActionComplete:t,hideSystemInfo:r=!1,onCreateRepository:a,onRepositoryClick:n,highlightedRepository:o,onContainerClick:c,highlightedContainer:d,isLoading:m,onRefreshMachines:p,refreshKey:h,onQueueItemCreated:y})=>{const{t:g}=ae(["resources","common","machines","functions"]),f=v(e=>e.auth.user?.email||""),x=j(),_=u(),[T,P]=i.useState([]),[R]=i.useState([]),[L,J]=i.useState(null),[Z,ee]=i.useState(!1),[te,re]=i.useState(null),[se,ie]=i.useState(null),[ce,le]=i.useState(!1),[de,ue]=i.useState(null),[he,ve]=i.useState([]),[je,be]=i.useState({}),[we,Ce]=i.useState({}),[Se,_e]=i.useState(null),[Te,Pe]=i.useState(!1),[Re,Ee]=i.useState(!1),[Ge,Me]=i.useState(null),[Ae,Fe]=i.useState(null),De=Is(),{buildQueueVault:Oe}=U(),{data:Le}=q(),{data:$e=[],isLoading:ze,refetch:Ue}=V(e.teamName),{data:qe=[]}=B(e.teamName),{data:Ve=[]}=Q(e.teamName),Be=K(),Qe=H(),Ke=W(),He=X();i.useEffect(()=>{if(!ze&&e)if(e.vaultStatus)if(e.vaultStatus.trim().startsWith("jq:")||e.vaultStatus.trim().startsWith("error:")||!e.vaultStatus.trim().startsWith("{"))re("Invalid repository data"),ee(!1);else try{const t=JSON.parse(e.vaultStatus);if("completed"===t.status&&t.result){let e=t.result;if(e.match(/(\}[\s\n]*$)/)){const t=e.lastIndexOf("}");t<e.length-10&&(e=e.substring(0,t+1))}const r=e.indexOf("\njq:");r>0&&(e=e.substring(0,r)),e=e.trim();const s=JSON.parse(e);if(s){if(s.system&&J(s.system),s.repositories&&Array.isArray(s.repositories)){const e=s.repositories.map(e=>{if(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e.name)){const t=$e.find(t=>t.repositoryGuid===e.name);return t?{...e,name:t.repositoryName,isUnmapped:!1}:{...e,isUnmapped:!0,originalGuid:e.name}}return{...e,isUnmapped:!1}}),t=e.map(e=>{let t=0;return s.containers&&Array.isArray(s.containers)&&s.containers.forEach(r=>{(r.repository===e.name||r.labels?.["com.redisolar.repository-guid"]===e.name||r.labels?.["com.rediacc.repository-guid"]===e.name)&&r.name&&r.name.startsWith("plugin-")&&t++}),{...e,plugin_count:t}}).sort((e,t)=>{const r=$e.find(t=>t.repositoryName===e.name),s=$e.find(e=>e.repositoryName===t.name),a=r?.grandGuid&&$e.find(e=>e.repositoryGuid===r.grandGuid)?.repositoryName||e.name,n=s?.grandGuid&&$e.find(e=>e.repositoryGuid===s.grandGuid)?.repositoryName||t.name;if(a!==n)return a.localeCompare(n);const o=!r?.parentGuid;return o!==!s?.parentGuid?o?-1:1:e.name.localeCompare(t.name)});if(P(t),s.containers&&Array.isArray(s.containers)){const t={};e.forEach(e=>{t[e.name]={containers:[],error:null}}),s.containers.forEach(r=>{if(r.repository){const a=r.repository,n=e.find(e=>{const t=s.repositories.find(e=>e.name===a);return!!t&&(e.mount_path===t.mount_path||e.image_path===t.image_path)});n&&t[n.name].containers.push(r)}else{const a=r.labels?.["com.redisolar.repository-guid"]||r.labels?.["com.rediacc.repository-guid"];if(a){const n=e.find(e=>{const t=s.repositories.find(e=>e.name===a);return!!t&&(e.mount_path===t.mount_path||e.image_path===t.image_path)});n&&t[n.name].containers.push(r)}}}),Ce(t)}if(s.services&&Array.isArray(s.services)){const t={};e.forEach(e=>{t[e.name]={services:[],error:null}}),s.services.forEach(r=>{if(r.repository){const a=r.repository,n=e.find(e=>{const t=s.repositories.find(e=>e.name===a);return!!t&&(e.mount_path===t.mount_path||e.image_path===t.image_path)});n&&t[n.name].services.push(r)}else if(r.service_name||r.unit_file){const a=(r.service_name||r.unit_file||"").match(/rediacc_([0-9a-f-]{36})_/);if(a){const n=a[1],o=e.find(e=>{const t=s.repositories.find(e=>e.name===n);return!!t&&(e.mount_path===t.mount_path||e.image_path===t.image_path)});o&&t[o.name].services.push(r)}}}),be(t)}}else P([]);ee(!1)}}}catch(t){re("Failed to parse repository data"),ee(!1)}else P([]),ee(!1)},[e,ze,$e,h,P,be,Ce,ee,re]),i.useEffect(()=>()=>{Ge&&clearTimeout(Ge)},[Ge]);const We=()=>{t&&t()},Xe=(e,t)=>{ie(e),ue(t||null),le(!0)},Ye=async(t,r,s=4,a)=>{try{const n=Le?.find(t=>t.teamName===e.teamName),o=$e.find(e=>e.repositoryName===t.name);if(!o||!o.vaultContent)return void l("error",g("resources:repositories.noCredentialsFound",{name:t.name}));let i=o.vaultContent;if(o.grandGuid){const e=$e.find(e=>e.repositoryGuid===o.grandGuid);e&&e.vaultContent&&(i=e.vaultContent)}const c={repo:o.repositoryGuid,grand:o.grandGuid||""};a&&(c.option=a);const d=await Oe({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,functionName:r,params:c,priority:s,description:`${r} ${t.name}`,addedVia:"machine-repository-list-quick",teamVault:n?.vaultContent||"{}",machineVault:e.vaultContent||"{}",repositoryGuid:o.repositoryGuid,repositoryVault:i}),u=await De.mutateAsync({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,queueVault:d,priority:s});u?.taskId?(l("success",g("resources:repositories.queueItemCreated")),y&&y(u.taskId,e.machineName)):u?.isQueued&&l("info",g("resources:repositories.highestPriorityQueued"))}catch(n){l("error",g("resources:repositories.failedToCreateQueueItem"))}},Je=async(t,r,s)=>{try{const a=Le?.find(t=>t.teamName===e.teamName),n=$e.find(e=>e.repositoryName===t.name);if(!n||!n.vaultContent)return void l("error",g("resources:repositories.noCredentialsFound",{name:t.name}));let o=n.vaultContent;if(n.grandGuid){const e=$e.find(e=>e.repositoryGuid===n.grandGuid);e&&e.vaultContent&&(o=e.vaultContent)}const i={repo:n.repositoryGuid,container:r.id||r.name};"container_remove"===s&&(i.force="false");const c=await Oe({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,functionName:s,params:i,priority:4,description:`${s} ${r.name}`,addedVia:"machine-repository-list-container-action",teamVault:a?.vaultContent||"{}",machineVault:e.vaultContent||"{}",repositoryGuid:n.repositoryGuid,repositoryVault:o}),d=await De.mutateAsync({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,queueVault:c,priority:4});d?.taskId?(l("success",g("resources:repositories.queueItemCreated")),y&&y(d.taskId,e.machineName)):d?.isQueued&&l("info",g("resources:repositories.highestPriorityQueued"))}catch(a){l("error",g("resources:repositories.failedToCreateQueueItem"))}},Ze=[{title:g("resources:containers.status"),dataIndex:"state",key:"status",width:80,align:"center",render:(e,t)=>{let r,a,n;return"running"===t.state?(r=s.jsx(z,{}),a="#52c41a",n=g("resources:containers.containerStatusRunning")):"paused"===t.state?(r=s.jsx(er,{}),a="#faad14",n=g("resources:containers.containerStatusPaused")):"restarting"===t.state?(r=s.jsx(O,{}),a="#1890ff",n=g("resources:containers.containerStatusRestarting")):(r=s.jsx(E,{}),a="#d9d9d9",n=g("resources:containers.containerStatusStopped")),s.jsx(oe,{title:n,children:s.jsx("span",{style:{fontSize:18,color:a},children:r})})}},{title:g("resources:repositories.containerName"),dataIndex:"name",key:"name",ellipsis:!0,render:(e,t)=>{const r=e?.startsWith("plugin-");return s.jsxs(ye,{children:[r?s.jsx(b,{style:{color:"#1890ff"}}):s.jsx(w,{style:{color:"#52c41a"}}),s.jsx("strong",{children:e})]})}},{title:g("resources:repositories.containerPorts"),dataIndex:"port_mappings",key:"port_mappings",ellipsis:!0,render:(e,t)=>e&&Array.isArray(e)&&e.length>0?s.jsx(ye,{direction:"vertical",size:0,children:e.map((e,t)=>s.jsx($s,{style:{fontSize:12},children:e.host_port?s.jsxs("span",{children:[e.host,":",e.host_port," → ",e.container_port,"/",e.protocol]}):s.jsxs("span",{children:[e.container_port,"/",e.protocol]})},t))}):t.ports?s.jsx($s,{style:{fontSize:12},children:t.ports}):"-"}],et=[{title:g("resources:containers.status"),dataIndex:"state",key:"status",width:80,align:"center",render:(e,t)=>{let r,a,n;return"running"===t.state?(r=s.jsx(z,{}),a="#52c41a",n=g("resources:containers.containerStatusRunning")):"paused"===t.state?(r=s.jsx(er,{}),a="#faad14",n=g("resources:containers.containerStatusPaused")):"restarting"===t.state?(r=s.jsx(O,{}),a="#1890ff",n=g("resources:containers.containerStatusRestarting")):(r=s.jsx(E,{}),a="#d9d9d9",n=g("resources:containers.containerStatusStopped")),s.jsx(oe,{title:n,children:s.jsx("span",{style:{fontSize:18,color:a},children:r})})}},{title:g("resources:repositories.containerName"),dataIndex:"name",key:"name",ellipsis:!0,render:e=>s.jsxs(ye,{children:[s.jsx(D,{style:{color:"#722ed1"}}),s.jsx("strong",{children:e})]})},{title:g("resources:repositories.containerImage"),dataIndex:"image",key:"image",width:250,ellipsis:!0},{title:g("resources:repositories.containerStatus"),dataIndex:"state",key:"state",render:(e,t)=>s.jsxs(ye,{children:[s.jsx(ne,{color:"running"===e?"success":"default",children:e}),t.status&&s.jsx($s,{type:"secondary",style:{fontSize:12},children:t.status})]})},{title:g("resources:repositories.containerCPU"),dataIndex:"cpu_percent",key:"cpu_percent",render:e=>e||"-"},{title:g("resources:repositories.containerMemory"),dataIndex:"memory_usage",key:"memory_usage",render:e=>e||"-"},{title:g("resources:repositories.containerPorts"),dataIndex:"port_mappings",key:"port_mappings",ellipsis:!0,render:(e,t)=>e&&Array.isArray(e)&&e.length>0?s.jsx(ye,{direction:"vertical",size:0,children:e.map((e,t)=>s.jsx($s,{style:{fontSize:12},children:e.host_port?s.jsxs("span",{children:[e.host,":",e.host_port," → ",e.container_port,"/",e.protocol]}):s.jsxs("span",{children:[e.container_port,"/",e.protocol]})},t))}):t.ports?s.jsx($s,{style:{fontSize:12},children:t.ports}):"-"}],tt=[{title:g("resources:repositories.status"),dataIndex:"status",key:"status",width:80,align:"center",render:(e,t)=>{let r,a,n;return t.mounted&&t.docker_running?(r=s.jsx(k,{}),a="#52c41a",n=g("resources:repositories.statusMountedRunning")):t.mounted&&!t.docker_running?(r=s.jsx(I,{}),a="#faad14",n=g("resources:repositories.statusMountedNotRunning")):(r=s.jsx(Xr,{}),a="#d9d9d9",n=g("resources:repositories.statusUnmounted")),s.jsx(oe,{title:n,children:s.jsx("span",{style:{fontSize:18,color:a},children:r})})}},{title:g("resources:repositories.repositoryName"),dataIndex:"name",key:"name",ellipsis:!0,render:(e,t)=>{const r=he.includes(t.name),a=t.mounted&&(t.has_services||t.container_count>0||C.isEnabled("plugins")&&t.plugin_count>0),n=$e.find(e=>e.repositoryName===t.name),o=n&&n.grandGuid&&n.grandGuid!==n.repositoryGuid,i=n&&n.grandGuid&&n.grandGuid===n.repositoryGuid,c=o&&n.parentGuid?$e.find(e=>e.repositoryGuid===n.parentGuid):null,l=o&&c?`Clone of ${c.repositoryName}`:i?"Original repository":void 0;return s.jsx(oe,{title:l,children:s.jsxs(ye,{children:[s.jsx("span",{style:{display:"inline-block",width:12,transition:"transform 0.3s ease",transform:r?"rotate(90deg)":"rotate(0deg)",visibility:a?"visible":"hidden"},children:s.jsx($,{style:{fontSize:12,color:"#999"}})}),i?s.jsx(dr,{}):s.jsx(A,{}),s.jsx("strong",{children:e})]})})}},{title:g("common:table.actions"),key:"actions",width:160,fixed:"right",render:(r,n)=>{const o=$e.find(e=>e.repositoryName===n.name),i=[];i.push({key:"up",label:g("functions:functions.up.name"),icon:s.jsx(z,{style:_.icon.small}),onClick:()=>Ye(n,"up",4,"mount")}),n.mounted&&i.push({key:"down",label:g("functions:functions.down.name"),icon:s.jsx(er,{style:_.icon.small}),onClick:()=>Ye(n,"down",4,"unmount")}),i.push({key:"clone",label:g("functions:functions.clone.name"),icon:s.jsx(A,{style:_.icon.small}),onClick:()=>(async t=>{try{const a=Le?.find(t=>t.teamName===e.teamName),n=$e.find(e=>e.repositoryName===t.name);if(!n||!n.vaultContent)return void l("error",g("resources:repositories.noCredentialsFound",{name:t.name}));let o=n.vaultContent;if(n.grandGuid){const e=$e.find(e=>e.repositoryGuid===n.grandGuid);e&&e.vaultContent&&(o=e.vaultContent)}const i=(new Date).toISOString().slice(0,19).replace("T","-").replace(/:/g,"-"),c=t.mounted?"online":"offline",d=`${t.name}-clone-${i}`;try{await Be.mutateAsync({teamName:e.teamName,repositoryName:d,parentRepoName:t.name}),_e(d);const{data:r}=await Ue(),s=r?.find(e=>e.repositoryName===d);if(!s||!s.repositoryGuid)throw new Error("Could not find newly created repository");const i={repo:n.repositoryGuid,dest:s.repositoryGuid,destinationType:"machine",to:e.machineName,state:c,grand:n.grandGuid||n.repositoryGuid||""},u=await Oe({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,functionName:"push",params:i,priority:4,description:`Clone ${t.name} to ${d}`,addedVia:"machine-repository-list-clone",teamVault:a?.vaultContent||"{}",machineVault:e.vaultContent||"{}",repositoryGuid:n.repositoryGuid,repositoryVault:o,destinationMachineVault:e.vaultContent}),m=await De.mutateAsync({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,queueVault:u,priority:4});m?.taskId?(l("success",g("resources:repositories.cloneStarted",{dest:d})),y&&y(m.taskId,e.machineName)):m?.isQueued&&l("info",g("resources:repositories.highestPriorityQueued"))}catch(r){if(Se)try{await Qe.mutateAsync({teamName:e.teamName,repositoryName:Se})}catch(s){}return void l("error",g("resources:repositories.failedToCloneRepository"))}}catch(a){l("error",g("resources:repositories.failedToCloneRepository"))}})(n)}),i.push({key:"push",label:g("functions:functions.push.name"),icon:s.jsx($r,{style:_.icon.small}),onClick:()=>Xe(n,"push")});const c=[];return n.mounted?c.push({key:"unmount",label:g("resources:repositories.unmount"),icon:s.jsx(Xr,{style:_.icon.small}),onClick:()=>Ye(n,"unmount",4)}):c.push({key:"mount",label:g("resources:repositories.mount"),icon:s.jsx(F,{style:_.icon.small}),onClick:()=>Ye(n,"mount",4)}),n.mounted||c.push({key:"resize",label:g("functions:functions.resize.name"),icon:s.jsx(Mt,{style:_.icon.small}),onClick:()=>Xe(n,"resize")}),n.mounted&&c.push({key:"expand",label:g("functions:functions.expand.name"),icon:s.jsx(St,{style:_.icon.small}),onClick:()=>Xe(n,"expand")}),c.length>0&&c.push({type:"divider"}),c.push({key:"experimental",label:g("machines:experimental"),icon:s.jsx(os,{style:_.icon.small}),onClick:()=>Xe(n)}),c.length>0&&i.push({key:"advanced",label:g("resources:repositories.advanced"),icon:s.jsx(ks,{style:_.icon.small}),children:c}),o&&o.grandGuid&&o.grandGuid!==o.repositoryGuid&&(i.push({key:"promote-to-grand",label:g("resources:repositories.promoteToGrand"),icon:s.jsx(Vt,{style:_.icon.small}),onClick:()=>(async t=>{const r=$e.find(e=>e.repositoryName===t.name);if(!r)return void l("error",g("resources:repositories.repositoryNotFound"));if(!r.grandGuid||r.grandGuid===r.repositoryGuid)return void l("error",g("resources:repositories.alreadyOriginalRepository"));const a=$e.find(e=>e.repositoryGuid===r.grandGuid),n=a?.repositoryName||"original",o=$e.filter(e=>e.grandGuid===r.grandGuid&&e.repositoryGuid!==r.repositoryGuid&&e.grandGuid!==e.repositoryGuid);pe.confirm({title:g("resources:repositories.promoteToGrandTitle"),content:s.jsxs("div",{children:[s.jsx(xe.Paragraph,{children:g("resources:repositories.promoteToGrandMessage",{name:t.name,grand:n})}),o.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(xe.Paragraph,{children:g("resources:repositories.promoteWillUpdateSiblings",{count:o.length})}),s.jsx("ul",{children:o.map(e=>s.jsx("li",{children:e.repositoryName},e.repositoryGuid))})]}),s.jsx(fe,{message:g("resources:repositories.promoteWarning"),type:"warning",showIcon:!0,style:{marginTop:16}})]}),okText:g("resources:repositories.promoteButton"),okType:"primary",cancelText:g("common:cancel"),onOk:async()=>{try{await Ke.mutateAsync({teamName:e.teamName,repositoryName:t.name}),l("success",g("resources:repositories.promoteSuccess",{name:t.name}))}catch(r){const e=r?.response?.data?.message||g("resources:repositories.promoteFailed");l("error",e)}}})})(n)}),i.push({key:"delete-clone",label:g("resources:repositories.deleteClone"),icon:s.jsx(S,{style:_.icon.small}),onClick:()=>(async t=>{const r=$e.find(e=>e.repositoryName===t.name);r?r.grandGuid&&r.grandGuid!==r.repositoryGuid?pe.confirm({title:g("resources:repositories.deleteCloneConfirmTitle"),content:g("resources:repositories.deleteCloneConfirmMessage",{name:t.name}),okText:g("common:delete"),okType:"danger",cancelText:g("common:cancel"),onOk:async()=>{try{const a=Le?.find(t=>t.teamName===e.teamName);let n=r.vaultContent;if(r.grandGuid){const e=$e.find(e=>e.repositoryGuid===r.grandGuid);e&&e.vaultContent&&(n=e.vaultContent)}const o={repo:r.repositoryGuid,grand:r.grandGuid},i=await Oe({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,functionName:"rm",params:o,priority:4,description:`Delete clone ${t.name}`,addedVia:"machine-repository-list-delete-clone",teamVault:a?.vaultContent||"{}",machineVault:e.vaultContent||"{}",repositoryGuid:r.repositoryGuid,repositoryVault:n}),c=await De.mutateAsync({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,queueVault:i,priority:4});if(c?.taskId){l("success",g("resources:repositories.deleteCloneQueued",{name:t.name})),y&&y(c.taskId,e.machineName);try{await Qe.mutateAsync({teamName:e.teamName,repositoryName:t.name}),l("success",g("resources:repositories.deleteCloneSuccess"))}catch(s){l("warning",g("resources:repositories.deleteCloneCredentialFailed"))}}else c?.isQueued&&l("info",g("resources:repositories.highestPriorityQueued"))}catch(a){l("error",g("resources:repositories.deleteCloneFailed"))}}}):l("error",g("resources:repositories.cannotDeleteGrandRepository")):l("error",g("resources:repositories.repositoryNotFound"))})(n),danger:!0})),i.length>0&&i.push({type:"divider"}),i.push({key:"rename",label:g("resources:repositories.rename"),icon:s.jsx(G,{style:_.icon.small}),onClick:()=>(async r=>{let a=r.name;pe.confirm({title:g("resources:repositories.renameTitle"),content:s.jsxs("div",{children:[s.jsx(xe.Paragraph,{children:g("resources:repositories.renameMessage",{name:r.name})}),s.jsx(Ne,{defaultValue:r.name,placeholder:g("resources:repositories.newRepositoryName"),onChange:e=>{a=e.target.value},onPressEnter:e=>{e.preventDefault(),pe.confirm({visible:!1}).destroy()},autoFocus:!0})]}),okText:g("common:save"),cancelText:g("common:cancel"),onOk:async()=>{const s=a.trim();if(!s)return l("error",g("resources:repositories.emptyNameError")),Promise.reject();if(s===r.name)return l("info",g("resources:repositories.nameUnchanged")),Promise.reject();if($e.find(e=>e.repositoryName===s))return l("error",g("resources:repositories.nameAlreadyExists",{name:s})),Promise.reject();try{await He.mutateAsync({teamName:e.teamName,currentRepositoryName:r.name,newRepositoryName:s}),l("success",g("resources:repositories.renameSuccess",{oldName:r.name,newName:s})),t&&t()}catch(n){const e=n?.response?.data?.message||g("resources:repositories.renameFailed");return l("error",e),Promise.reject()}}})})(n)}),o&&o.grandGuid&&o.grandGuid===o.repositoryGuid&&i.push({key:"delete-grand",label:g("resources:repositories.deleteGrand"),icon:s.jsx(S,{style:_.icon.small}),onClick:()=>(async t=>{const r=$e.find(e=>e.repositoryName===t.name);if(!r)return void l("error",g("resources:repositories.repositoryNotFound"));if(r.grandGuid&&r.grandGuid!==r.repositoryGuid)return void l("error",g("resources:repositories.notAGrandRepository"));const a=$e.filter(e=>e.grandGuid===r.repositoryGuid&&e.repositoryGuid!==r.repositoryGuid);if(a.length>0)return void pe.error({title:g("resources:repositories.cannotDeleteHasClones"),content:s.jsxs("div",{children:[s.jsx(xe.Paragraph,{children:g("resources:repositories.hasActiveClonesMessage",{name:t.name,count:a.length})}),s.jsx(xe.Paragraph,{strong:!0,children:g("resources:repositories.clonesList")}),s.jsx("ul",{children:a.map(e=>s.jsx("li",{children:e.repositoryName},e.repositoryGuid))}),s.jsx(xe.Paragraph,{children:g("resources:repositories.deleteOptionsMessage")})]}),okText:g("common:close")});let n="";pe.confirm({title:g("resources:repositories.deleteGrandConfirmTitle"),content:s.jsxs("div",{children:[s.jsx(fe,{message:g("resources:repositories.deleteGrandWarning"),description:g("resources:repositories.deleteGrandWarningDesc",{name:t.name}),type:"warning",showIcon:!0,style:{marginBottom:16}}),s.jsx(xe.Text,{strong:!0,children:g("resources:repositories.deleteGrandConfirmPrompt",{name:t.name})}),s.jsx("input",{type:"text",placeholder:t.name,style:{width:"100%",marginTop:8,padding:"8px",border:"1px solid #d9d9d9",borderRadius:"4px"},onChange:e=>{n=e.target.value}})]}),okText:g("common:delete"),okType:"danger",cancelText:g("common:cancel"),onOk:async()=>{if(n!==t.name)return l("error",g("resources:repositories.deleteGrandConfirmationMismatch")),Promise.reject();try{const a=Le?.find(t=>t.teamName===e.teamName),n=r.vaultContent,o={repo:r.repositoryGuid,grand:r.repositoryGuid},i=await Oe({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,functionName:"rm",params:o,priority:4,description:`Delete repository ${t.name}`,addedVia:"machine-repository-list-delete-grand",teamVault:a?.vaultContent||"{}",machineVault:e.vaultContent||"{}",repositoryGuid:r.repositoryGuid,repositoryVault:n}),c=await De.mutateAsync({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,queueVault:i,priority:4});if(c?.taskId){l("success",g("resources:repositories.deleteGrandQueued",{name:t.name})),y&&y(c.taskId,e.machineName);try{await Qe.mutateAsync({teamName:e.teamName,repositoryName:t.name}),l("success",g("resources:repositories.deleteGrandSuccess"))}catch(s){l("warning",g("resources:repositories.deleteGrandCredentialFailed"))}}else c?.isQueued&&l("info",g("resources:repositories.highestPriorityQueued"))}catch(a){return l("error",g("resources:repositories.deleteGrandFailed")),Promise.reject()}}})})(n),danger:!0}),s.jsxs(ye,{size:"small",children:[s.jsx(ke,{menu:{items:i},trigger:["click"],children:s.jsx(oe,{title:g("machines:remote"),children:s.jsx(ge,{type:"primary",size:"small",icon:s.jsx(os,{}),loading:De.isPending,style:_.touchTarget,"data-testid":`machine-repo-list-repo-actions-${n.name}`,"aria-label":g("machines:remote")})})}),n.mounted&&s.jsx(Ls,{machine:e.machineName,repository:n.name,teamName:e.teamName,userEmail:f,pluginContainers:we[n.name]?.containers||[]}),n.isUnmapped&&a&&s.jsx(oe,{title:g("resources:repositories.addCredential"),children:s.jsx(ge,{type:"default",size:"small",icon:s.jsx(N,{}),onClick:()=>a(e,n.originalGuid||n.name),style:_.touchTarget,"data-testid":`machine-repo-list-add-credential-${n.name}`,"aria-label":g("resources:repositories.addCredential")})})]})}}];return Z?s.jsxs("div",{style:{padding:"20px",textAlign:"center"},"data-testid":"machine-repo-list-loading",children:[s.jsx(me,{}),s.jsx("div",{style:{marginTop:16,color:"var(--ant-color-text-secondary)"},children:g("resources:repositories.fetchingRepositories")})]}):te?s.jsx("div",{style:{padding:"20px"},"data-testid":"machine-repo-list-error",children:s.jsx(fe,{message:g("common:messages.error"),description:te,type:"error",showIcon:!0,action:s.jsx(oe,{title:g("common:actions.retry"),children:s.jsx(ge,{size:"small",onClick:We,"data-testid":"machine-repo-list-retry","aria-label":g("common:actions.retry")})})})}):s.jsxs("div",{style:{padding:"0 20px 20px 20px",overflowX:"auto",position:"relative"},"data-testid":"machine-repo-list",children:[m&&s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,borderRadius:"4px"},children:s.jsxs(ye,{direction:"vertical",align:"center",children:[s.jsx(me,{size:"large"}),s.jsx($s,{type:"secondary",children:g("common:general.refreshing")})]})}),r&&s.jsx("div",{style:{marginBottom:16,paddingTop:16,borderBottom:"1px solid #f0f0f0",paddingBottom:12},"data-testid":"machine-repo-list-machine-header",children:s.jsxs(ye,{direction:"vertical",size:4,children:[s.jsxs(ye,{children:[s.jsx(M,{style:{fontSize:20,color:"#556b2f"}}),s.jsx(xe.Title,{level:4,style:{margin:0,color:"#556b2f"},"data-testid":"machine-repo-list-machine-name",children:e.machineName})]}),s.jsxs(ye,{wrap:!0,size:8,children:[s.jsx(ne,{color:"#8FBC8F","data-testid":"machine-repo-list-team-tag",children:e.teamName}),s.jsx(ne,{color:"green","data-testid":"machine-repo-list-bridge-tag",children:e.bridgeName}),e.regionName&&s.jsx(ne,{color:"purple","data-testid":"machine-repo-list-region-tag",children:e.regionName}),s.jsxs(ne,{color:"blue","data-testid":"machine-repo-list-queue-tag",children:[e.queueCount," ",g("machines:queueItems")]})]})]})}),s.jsx(Ie,{columns:tt,dataSource:T,rowKey:"name",size:"small",pagination:!1,scroll:{x:"max-content"},style:x.tableContainer,"data-testid":"machine-repo-list-table",rowClassName:e=>{const t=$e.find(t=>t.repositoryName===e.name);return t&&t.grandGuid&&t.grandGuid!==t.repositoryGuid?"repository-clone-row":""},expandable:{expandedRowRender:t=>{const r=we[t.name],a=r?.containers?.filter(e=>e.name&&e.name.startsWith("plugin-"))||[],n=r?.containers?.filter(e=>!e.name||!e.name.startsWith("plugin-"))||[],o=[...Ze.slice(0,-1),{title:g("common:table.actions"),key:"actions",fixed:"right",render:(r,a)=>{const n=[];return"running"===a.state?(n.push({key:"stop",label:g("functions:functions.container_stop.name"),icon:s.jsx(E,{style:_.icon.small}),onClick:()=>Je(t,a,"container_stop")}),n.push({key:"restart",label:g("functions:functions.container_restart.name"),icon:s.jsx(O,{style:_.icon.small}),onClick:()=>Je(t,a,"container_restart")}),n.push({key:"pause",label:g("functions:functions.container_pause.name"),icon:s.jsx(er,{style:_.icon.small}),onClick:()=>Je(t,a,"container_pause")})):"paused"===a.state?n.push({key:"unpause",label:g("functions:functions.container_unpause.name"),icon:s.jsx(z,{style:_.icon.small}),onClick:()=>Je(t,a,"container_unpause")}):(n.push({key:"start",label:g("functions:functions.container_start.name"),icon:s.jsx(z,{style:_.icon.small}),onClick:()=>Je(t,a,"container_start")}),n.push({key:"remove",label:g("functions:functions.container_remove.name"),icon:s.jsx(S,{style:_.icon.small}),onClick:()=>Je(t,a,"container_remove")})),s.jsxs(ye,{size:"small",children:[s.jsx(ke,{menu:{items:n},trigger:["click"],children:s.jsx(oe,{title:g("machines:remote"),children:s.jsx(ge,{type:"primary",size:"small",icon:s.jsx(os,{}),loading:De.isPending,style:_.touchTarget,"data-testid":`machine-repo-list-container-actions-${a.id}`,"aria-label":g("machines:remote")})})}),s.jsx(Ls,{machine:e.machineName,repository:t.name,teamName:e.teamName,userEmail:f,containerId:a.id,containerName:a.name,containerState:a.state,isContainerMenu:!0})]})}}];return s.jsxs("div",{style:{padding:"16px",position:"relative"},children:[Re&&Ae===t.name&&s.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,borderRadius:"4px"},children:s.jsxs(ye,{direction:"vertical",align:"center",children:[s.jsx(me,{size:"large"}),s.jsx($s,{type:"secondary",children:g("common:general.refreshing")})]})}),s.jsx("div",{style:{marginBottom:16},"data-testid":"machine-repo-list-containers-section",children:r?.error?s.jsx(fe,{message:g("resources:repositories.errorLoadingContainers"),description:r.error,type:"error"}):n.length>0?s.jsx(Ie,{columns:o,dataSource:n,rowKey:"id",size:"small",pagination:!1,scroll:{x:"max-content"},style:x.tableContainer,"data-testid":"machine-repo-list-containers-table",onRow:e=>({onClick:t=>{const r=t.target;r.closest("button")||r.closest(".ant-dropdown-trigger")||c?.(e)},style:{cursor:c?"pointer":"default",backgroundColor:d?.id===e.id?"rgba(24, 144, 255, 0.05)":void 0,transition:"background-color 0.3s ease"},onMouseEnter:t=>{c&&(t.currentTarget.style.backgroundColor=d?.id===e.id?"rgba(24, 144, 255, 0.05)":"rgba(0, 0, 0, 0.02)")},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=d?.id===e.id?"rgba(24, 144, 255, 0.05)":""}})}):null}),C.isEnabled("plugins")&&a.length>0&&s.jsx("div",{style:{marginTop:16},"data-testid":"machine-repo-list-plugins-section",children:s.jsx(Ie,{columns:o,dataSource:a,rowKey:"id",size:"small",pagination:!1,scroll:{x:"max-content"},style:x.tableContainer,"data-testid":"machine-repo-list-plugins-table",onRow:e=>({onClick:t=>{const r=t.target;r.closest("button")||r.closest(".ant-dropdown-trigger")||c?.(e)},style:{cursor:c?"pointer":"default",backgroundColor:d?.id===e.id?"rgba(24, 144, 255, 0.05)":void 0,transition:"background-color 0.3s ease"},onMouseEnter:t=>{c&&(t.currentTarget.style.backgroundColor=d?.id===e.id?"rgba(24, 144, 255, 0.05)":"rgba(0, 0, 0, 0.02)")},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=d?.id===e.id?"rgba(24, 144, 255, 0.05)":""}})})})]})},expandedRowKeys:he,onExpandedRowsChange:e=>ve(e),rowExpandable:e=>e.mounted&&(e.has_services||e.container_count>0||C.isEnabled("plugins")&&e.plugin_count>0),expandIcon:()=>null,expandRowByClick:!1},locale:{emptyText:g("resources:repositories.noRepositories")},onRow:e=>{const t=e.mounted&&(e.has_services||e.container_count>0||C.isEnabled("plugins")&&e.plugin_count>0);return{onClick:r=>{const s=r.target;if(!s.closest("button")&&!s.closest(".ant-dropdown-trigger")){if(t){if(he.includes(e.name))ve(he.filter(t=>t!==e.name));else if(ve([...he,e.name]),p){Fe(e.name),Pe(!0);const t=setTimeout(()=>{Ee(!0)},1e3);Me(t),p().finally(()=>{Ge&&clearTimeout(Ge),Pe(!1),Ee(!1),Fe(null),Me(null)})}}n?.(e)}},style:{cursor:t||n?"pointer":"default",backgroundColor:o?.name===e.name?"rgba(24, 144, 255, 0.05)":void 0,transition:"background-color 0.3s ease"},onMouseEnter:r=>{(t||n)&&(r.currentTarget.style.backgroundColor=o?.name===e.name?"rgba(24, 144, 255, 0.08)":"rgba(0, 0, 0, 0.02)")},onMouseLeave:t=>{t.currentTarget.style.backgroundColor=o?.name===e.name?"rgba(24, 144, 255, 0.05)":""}}}}),R.length>0&&!r&&s.jsxs("div",{"data-testid":"machine-repo-list-system-containers",children:[s.jsx(xe.Title,{level:5,style:{marginBottom:16,marginTop:32},"data-testid":"machine-repo-list-system-containers-title",children:g("resources:repositories.systemContainers")}),s.jsx("div",{style:{marginBottom:32},children:s.jsx(Ie,{columns:et,dataSource:R,rowKey:"id",size:"small",pagination:!1,scroll:{x:"max-content"},style:x.tableContainer,"data-testid":"machine-repo-list-system-containers-table"})})]}),s.jsx(Y,{open:ce,onCancel:()=>{le(!1),ie(null),ue(null)},onSubmit:async t=>{if(se)try{const a=Le?.find(t=>t.teamName===e.teamName),n=$e.find(e=>e.repositoryName===se.name);if(!n||!n.vaultContent)return l("error",g("resources:repositories.noCredentialsFound",{name:se.name})),le(!1),void ie(null);let o=n.vaultContent;if(n.grandGuid){const e=$e.find(e=>e.repositoryGuid===n.grandGuid);e&&e.vaultContent&&(o=e.vaultContent)}const i={...t.params},c=n.repositoryGuid,d=o;let u,m,p,h;if("pull"===t.function.name&&"machine"===t.params.sourceType&&t.params.from){const e=qe?.find(e=>e.machineName===t.params.from);e&&e.vaultContent&&(p=e.vaultContent)}if("pull"===t.function.name&&"storage"===t.params.sourceType&&t.params.from){const e=Ve?.find(e=>e.storageName===t.params.from);e&&e.vaultContent&&(h=e.vaultContent)}if("push"===t.function.name&&"machine"===t.params.destinationType&&t.params.to){const e=qe?.find(e=>e.machineName===t.params.to);e&&e.vaultContent&&(u=e.vaultContent)}if("push"===t.function.name&&"storage"===t.params.destinationType&&t.params.to){const e=Ve?.find(e=>e.storageName===t.params.to);e&&e.vaultContent&&(m=e.vaultContent)}if("push"===t.function.name&&t.params.dest&&"machine"===t.params.destinationType)try{await Be.mutateAsync({teamName:e.teamName,repositoryName:t.params.dest,parentRepoName:se.name}),_e(t.params.dest);const{data:r}=await Ue(),s=r?.find(e=>e.repositoryName===t.params.dest);if(!s||!s.repositoryGuid)throw new Error("Could not find newly created repository");i.dest=s.repositoryGuid,i.repo=n.repositoryGuid,i.grand=n.grandGuid||n.repositoryGuid||""}catch(r){if(Se)try{await Qe.mutateAsync({teamName:e.teamName,repositoryName:Se})}catch(s){}return l("error",g("resources:repositories.failedToCreateRepository")),le(!1),void ie(null)}else("push"===t.function.name&&"storage"===t.params.destinationType||"pull"===t.function.name)&&(i.repo=n.repositoryGuid,i.grand=n.grandGuid||n.repositoryGuid||"");const f=await Oe({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,functionName:t.function.name,params:i,priority:t.priority,description:t.description,addedVia:"machine-repository-list",teamVault:a?.vaultContent||"{}",machineVault:e.vaultContent||"{}",repositoryGuid:c,repositoryVault:d,destinationMachineVault:u,destinationStorageVault:m,sourceMachineVault:p,sourceStorageVault:h}),x=await De.mutateAsync({teamName:e.teamName,machineName:e.machineName,bridgeName:e.bridgeName,queueVault:f,priority:t.priority});le(!1),ie(null),x?.taskId?(l("success",g("resources:repositories.queueItemCreated")),y&&y(x.taskId,e.machineName)):x?.isQueued&&l("info",g("resources:repositories.highestPriorityQueued"))}catch(a){const e=a instanceof Error?a.message:g("resources:repositories.failedToCreateQueueItem");l("error",e)}},title:g("machines:runFunction"),"data-testid":"machine-repo-list-function-modal",subtitle:se&&s.jsxs(ye,{direction:"vertical",size:"small",style:{width:"100%"},children:[s.jsxs(ye,{children:[s.jsxs($s,{children:[g("resources:repositories.repository"),":"]}),s.jsx(ne,{color:"#8FBC8F",children:se.name}),s.jsx($s,{children:"•"}),s.jsxs($s,{children:[g("machines:machine"),":"]}),s.jsx(ne,{color:"#556b2f",children:e.machineName})]}),"push"===de&&(()=>{const e=$e.find(e=>e.repositoryName===se.name);if(e?.parentGuid){const t=$e.find(t=>t.repositoryGuid===e.parentGuid);if(t)return s.jsxs(ye,{children:[s.jsx($s,{type:"secondary",children:"Parent Repository:"}),s.jsx(ne,{color:"blue",children:t.repositoryName}),s.jsx($s,{type:"secondary",children:"→"}),s.jsx($s,{type:"secondary",children:"Current:"}),s.jsx(ne,{color:"#8FBC8F",children:se.name})]})}return null})()]}),allowedCategories:["repository","backup","network"],loading:De.isPending,showMachineSelection:!1,teamName:e.teamName,hiddenParams:["repo","grand"],defaultParams:{repo:(()=>{const e=$e.find(e=>e.repositoryName===se?.name);return e?.repositoryGuid||""})(),grand:$e.find(e=>e.repositoryName===se?.name)?.grandGuid||""},initialParams:"push"===de&&se?(()=>{const e=$e.find(e=>e.repositoryName===se.name);let t=se.name;if(e?.grandGuid){const r=$e.find(t=>t.repositoryGuid===e.grandGuid);r&&(t=r.repositoryName)}return{dest:`${t}-${se.mounted?"online":"offline"}-${(new Date).toISOString().slice(0,19).replace("T","-").replace(/:/g,"-")}`,state:se.mounted?"online":"offline"}})():{},preselectedFunction:de||void 0,currentMachineName:e.machineName,additionalContext:"push"===de&&se?{sourceRepository:se.name,parentRepository:(()=>{const e=$e.find(e=>e.repositoryName===se.name);if(e?.parentGuid){const t=$e.find(t=>t.repositoryGuid===e.parentGuid);return t?.repositoryName||null}return null})()}:void 0})]})},{Text:Us}=xe,qs=({open:e,machine:a,machines:n,onCancel:o,onSuccess:m})=>{const{t:p}=ae(["machines","distributedStorage","common"]),h=u(),y=!!n&&n.length>0,v=y&&n?n:a?[a]:[],[j,b]=i.useState(a?.distributedStorageClusterName||null),w=y&&n?Array.from(new Set(n.map(e=>e.teamName))):a?[a.teamName]:[],{data:C=[],isLoading:S}=ze(w,e&&w.length>0),N=(()=>{const e=t(),{t:s}=ae("distributedStorage");return r({mutationFn:async e=>{const t=await d.post("/UpdateMachineDistributedStorage",e);if(0!==t.failure)throw new Error(t.errors?.join(", ")||"Failed to update machine cluster assignment");return t},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:De(r.clusterName||"")}),l("success",s("machines.updateSuccess"))},onError:e=>{l("error",e.message)}})})(),k=dt();c.useEffect(()=>{e&&a&&!y?b(a.distributedStorageClusterName||null):e&&y&&b(null)},[e,a,y]);return s.jsx(pe,{title:s.jsxs(ye,{children:[s.jsx(D,{}),p(y?"machines:bulkActions.assignToCluster":a?.distributedStorageClusterName?"machines:changeClusterAssignment":"machines:assignToCluster")]}),open:e,onCancel:o,onOk:async()=>{if(j&&0!==v.length)try{if(y){const e=await Promise.allSettled(v.map(e=>k.mutateAsync({teamName:e.teamName,machineName:e.machineName,clusterName:j}))),t=e.filter(e=>"fulfilled"===e.status).length;0===e.filter(e=>"rejected"===e.status).length?l("success",p("machines:bulkOperations.assignmentSuccess",{count:t})):l("warning",p("machines:bulkOperations.assignmentPartial",{success:t,total:v.length}))}else await N.mutateAsync({teamName:a.teamName,machineName:a.machineName,clusterName:j}),l("success",j?p("machines:clusterAssignedSuccess",{cluster:j}):p("machines:clusterUnassignedSuccess"));m?.(),o()}catch(e){}},confirmLoading:N.isPending||k.isPending,okText:p("common:actions.save"),cancelText:p("common:actions.cancel"),style:g(y?f.DIMENSIONS.MODAL_WIDTH_LG:f.DIMENSIONS.MODAL_WIDTH),okButtonProps:{disabled:!j,"data-testid":"ds-assign-cluster-ok-button",style:h.buttonPrimary},cancelButtonProps:{"data-testid":"ds-assign-cluster-cancel-button",style:h.buttonSecondary},"data-testid":"ds-assign-cluster-modal",children:s.jsxs(ye,{direction:"vertical",size:"large",style:{width:"100%"},children:[y?s.jsxs(s.Fragment,{children:[s.jsx(fe,{message:p("machines:bulkOperations.selectedCount",{count:v.length}),description:p("machines:bulkAssignDescription"),type:"info",showIcon:!0}),(()=>{const e=[{title:p("machines:machineName"),dataIndex:"machineName",key:"machineName",render:e=>s.jsxs(ye,{children:[s.jsx(D,{}),s.jsx(Us,{children:e})]})},{title:p("machines:team"),dataIndex:"teamName",key:"teamName",render:e=>s.jsx(ne,{color:"#8FBC8F",children:e})},{title:p("machines:assignmentStatus.title"),key:"currentCluster",render:(e,t)=>t.distributedStorageClusterName?s.jsx(ne,{color:"blue",children:t.distributedStorageClusterName}):s.jsx(ne,{color:"green",children:p("machines:assignmentStatus.available")})}];return s.jsx(Ie,{columns:e,dataSource:v,rowKey:"machineName",size:"small",pagination:!1,scroll:{y:200},"data-testid":"ds-assign-cluster-bulk-table"})})()]}):a&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsxs(Us,{strong:!0,children:[p("machines:machine"),": "]}),s.jsx(Us,{children:a.machineName})]}),s.jsxs("div",{children:[s.jsxs(Us,{strong:!0,children:[p("machines:team"),": "]}),s.jsx(Us,{children:a.teamName})]}),a.distributedStorageClusterName&&s.jsx(fe,{message:p("machines:currentClusterAssignment",{cluster:a.distributedStorageClusterName}),type:"info",showIcon:!0,style:{marginBottom:x("MD")}})]}),s.jsxs("div",{children:[s.jsxs(Us,{strong:!0,style:{display:"block",marginBottom:x("XS")},children:[p("distributedStorage:clusters.cluster"),":"]}),S?s.jsx(me,{}):s.jsxs(s.Fragment,{children:[s.jsx(_e,{style:{width:"100%"},placeholder:p("machines:selectCluster"),value:j,onChange:b,showSearch:!0,optionFilterProp:"children","data-testid":"ds-assign-cluster-select",children:C.map(e=>s.jsx(_e.Option,{value:e.clusterName,"data-testid":`cluster-option-${e.clusterName}`,children:e.clusterName},e.clusterName))}),!y&&s.jsx(Us,{type:"secondary",style:{display:"block",marginTop:x("XS")},children:p("machines:clusterAssignmentHelp")})]})]})]})})},{Text:Vs}=xe,Bs=({open:e,machines:t,selectedMachines:r,allMachines:a,onCancel:n,onSuccess:o})=>{const{t:c}=ae(["machines","distributedStorage","common"]),d=u(),[m,p]=i.useState(!1),h=dt(),y=t||(r&&a?a.filter(e=>r.includes(e.machineName)):[]),v=y&&Array.isArray(y)?y.filter(e=>e.distributedStorageClusterName):[],j=[{title:c("machines:machineName"),dataIndex:"machineName",key:"machineName",render:e=>s.jsxs(ye,{children:[s.jsx(D,{}),s.jsx(Vs,{strong:!0,children:e})]})},{title:c("distributedStorage:clusters.cluster"),dataIndex:"distributedStorageClusterName",key:"cluster",render:e=>e?s.jsx(ne,{color:"blue",children:e}):s.jsx(Vs,{type:"secondary",children:c("common:none")})}];return s.jsx(pe,{title:s.jsxs(ye,{children:[s.jsx(_,{style:{color:"#ff4d4f"}}),c("machines:bulkActions.removeFromCluster")]}),open:e,onOk:async()=>{if(0!==v.length){p(!0);try{const e=await Promise.allSettled(v.map(e=>h.mutateAsync({teamName:e.teamName,machineName:e.machineName,clusterName:""}))),t=e.filter(e=>"fulfilled"===e.status).length;0===e.filter(e=>"rejected"===e.status).length?l("success",c("machines:bulkOperations.removalSuccess",{count:t})):l("warning",c("machines:bulkOperations.assignmentPartial",{success:t,total:v.length})),o&&o(),n()}catch(e){l("error",c("distributedStorage:machines.unassignError"))}finally{p(!1)}}},onCancel:n,okText:c("common:actions.remove"),cancelText:c("common:actions.cancel"),confirmLoading:m,okButtonProps:{danger:!0,disabled:0===v.length,"data-testid":"ds-remove-cluster-ok-button",style:d.buttonPrimary},cancelButtonProps:{"data-testid":"ds-remove-cluster-cancel-button",style:d.buttonSecondary},style:g(f.DIMENSIONS.MODAL_WIDTH_LG),"data-testid":"ds-remove-cluster-modal",children:0===v.length?s.jsx(fe,{message:c("machines:noMachinesWithClusters"),type:"info",showIcon:!0}):s.jsxs(s.Fragment,{children:[s.jsx(fe,{message:c("machines:removeFromClusterWarning",{count:v.length}),description:c("machines:removeFromClusterDescription"),type:"warning",showIcon:!0,style:{marginBottom:x("MD")}}),s.jsx(Ie,{columns:j,dataSource:v,rowKey:"machineName",size:"small",pagination:!1,scroll:{y:300},"data-testid":"ds-remove-cluster-table"})]})})},{Text:Qs}=xe,Ks=({open:e,machines:t,selectedMachines:r,allMachines:a,onCancel:n})=>{const{t:o}=ae(["machines","distributedStorage","common"]),i=j(),c=t||(r&&a?a.filter(e=>r.includes(e.machineName)):[]),l=[{title:o("machines:machineName"),dataIndex:"machineName",key:"machineName",width:200,render:e=>s.jsxs(ye,{children:[s.jsx(D,{}),s.jsx(Qs,{strong:!0,children:e})]})},{title:o("machines:team"),dataIndex:"teamName",key:"teamName",width:150,render:e=>s.jsx(ne,{color:"#8FBC8F",children:e})},{title:o("machines:assignmentStatus.title"),key:"assignmentStatus",width:200,render:(e,t)=>s.jsx(ht,{machine:t})},{title:o("distributedStorage:clusters.cluster"),dataIndex:"distributedStorageClusterName",key:"cluster",render:e=>e?s.jsx(ne,{color:"blue",children:e}):s.jsx(Qs,{type:"secondary",children:o("common:none")})}],d=c&&Array.isArray(c)?c.reduce((e,t)=>(t.distributedStorageClusterName?e.cluster++:e.available++,e),{available:0,cluster:0,image:0,clone:0}):{available:0,cluster:0};return s.jsxs(pe,{title:s.jsxs(ye,{children:[s.jsx(P,{}),o("machines:bulkActions.viewAssignmentStatus")]}),open:e,onCancel:n,footer:null,className:T.Large,"data-testid":"ds-view-assignment-status-modal",children:[s.jsx("div",{style:{marginBottom:16},children:s.jsxs(ye,{size:"large",children:[s.jsxs("div",{children:[s.jsxs(Qs,{type:"secondary",children:[o("common:total"),": "]}),s.jsx(Qs,{strong:!0,children:c&&Array.isArray(c)?c.length:0})]}),s.jsxs("div",{children:[s.jsx(pt,{assignmentType:"AVAILABLE",size:"small"}),s.jsx(Qs,{strong:!0,style:{marginLeft:8},children:d.available})]}),s.jsxs("div",{children:[s.jsx(pt,{assignmentType:"CLUSTER",size:"small"}),s.jsx(Qs,{strong:!0,style:{marginLeft:8},children:d.cluster})]})]})}),s.jsx(Ie,{columns:l,dataSource:c&&Array.isArray(c)?c:[],rowKey:"machineName",size:"small",pagination:{pageSize:10,showSizeChanger:!1},scroll:{y:400},style:i.tableContainer,"data-testid":"ds-view-assignment-status-table"})]})},Hs=({teams:e,selectedTeams:t,onChange:r,loading:a=!1,placeholder:n="Select teams...",style:o})=>{const[c,l]=i.useState(""),d=i.useMemo(()=>e.filter(e=>e.teamName.toLowerCase().includes(c.toLowerCase())).map(e=>({label:s.jsxs(ye,{children:[s.jsx(Pe,{style:{color:"#556b2f"}}),s.jsx("span",{children:e.teamName})]}),value:e.teamName,"data-testid":`team-selector-option-${e.teamName}`})),[e,c]);return s.jsx(_e,{mode:"multiple",style:{width:"100%",...o},placeholder:n,value:t,onChange:r,loading:a,options:d,filterOption:!1,showSearch:!0,searchValue:c,onSearch:l,"data-testid":"team-selector",tagRender:e=>{const{value:t,closable:r,onClose:a}=e;return s.jsx(ne,{color:"var(--color-primary)",closable:r,onClose:a,style:{marginRight:x("XS"),borderRadius:R("SM"),display:"inline-flex",alignItems:"center"},"data-testid":`team-selector-tag-${t}`,children:t})},popupRender:e=>s.jsxs(s.Fragment,{children:[s.jsx("div",{style:{padding:x("SM")},children:s.jsx(Ne,{placeholder:"Search teams by name...",prefix:s.jsx(Re,{style:{fontSize:f.FONT_SIZE.BASE}}),value:c,onChange:e=>l(e.target.value),onPressEnter:e=>e.stopPropagation(),autoComplete:"off",style:{},"data-testid":"team-selector-search"})}),s.jsx("div",{style:{borderTop:"1px solid var(--color-border-secondary)"},children:e})]}),maxTagCount:"responsive",maxTagPlaceholder:e=>s.jsxs(ne,{color:"var(--color-primary)",style:{borderRadius:R("SM"),display:"inline-flex",alignItems:"center"},"data-testid":"team-selector-more-tag",children:["+",e.length," more"]})})};export{qs as A,qe as B,Ve as C,He as D,St as E,os as F,Ls as L,pt as M,er as P,Bs as R,Hs as T,Ks as V,ct as a,ht as b,zs as c,nt as d,lt as e,dt as f,ut as g,Je as h,mt as i,ot as j,it as k,rt as l,at as m,st as n,Ke as o,Ze as p,tt as q,et as r,We as s,Ye as t,Is as u,Xe as v,ze as w,Be as x,Ue as y,Qe as z};
