---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/Hero';
import Problem from '../../components/Problem';
import Solutions from '../../components/Solutions';
import Testimonials from '../../components/Testimonials';
import { createTranslator } from '../../i18n/utils';
import { getLanguagePaths } from '../../i18n/language-utils';
import type { Language } from '../../i18n/types';

export const getStaticPaths = getLanguagePaths;

const { lang } = Astro.params as { lang: Language };
const { t } = createTranslator(lang);
---

<BaseLayout
  lang={lang}
  title={t('pages.home.meta.title')}
  description={t('pages.home.meta.description')}
  keywords={t('pages.home.meta.keywords')}
  ogType="website"
  structuredDataType="organization"
>
  <Hero client:idle lang={lang} origin={Astro.url.origin} />
  <Problem client:visible lang={lang} />

  <!-- Bridge: narrative transition from pain to solution -->
  <div class="section-bridge" aria-hidden="true">
    <p class="bridge-text">{t('bridge.text')}</p>
    <svg class="bridge-chevron" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </div>

  <Solutions client:visible lang={lang} />
  <Testimonials client:visible lang={lang} />

  <!-- Success/Error Messages -->
  <div class="message-overlay" id="message-overlay" role="dialog" aria-hidden="true">
    <div class="message-content">
      <div class="message-icon" id="message-icon"></div>
      <p class="message-title" id="message-title" aria-label={t('common.aria.statusMessage')}><strong></strong></p>
      <p class="message-text" id="message-text"></p>
      <button class="btn btn-secondary" id="message-close">{t('common.buttons.close')}</button>
    </div>
  </div>

  <!-- Image Modal -->
  <div class="image-modal" id="image-modal" role="dialog" aria-hidden="true" aria-modal="true" aria-label={t('common.aria.imageViewer')}>
    <div class="image-modal-content" id="image-modal-content">
      <button class="image-modal-close" id="image-modal-close-btn" aria-label={t('common.aria.closeImageModal')}>&times;</button>
      <button class="nav-btn nav-prev" id="image-modal-prev-btn" aria-label={t('common.aria.previousImage')}>‹</button>
      <button class="nav-btn nav-next" id="image-modal-next-btn" aria-label={t('common.aria.nextImage')}>›</button>
      <div class="zoom-controls">
        <button class="zoom-btn zoom-in" id="image-modal-zoom-in-btn" aria-label={t('common.aria.zoomIn')}>+</button>
        <button class="zoom-btn zoom-out" id="image-modal-zoom-out-btn" aria-label={t('common.aria.zoomOut')}>−</button>
        <button class="zoom-btn zoom-reset" id="image-modal-zoom-reset-btn" aria-label={t('common.aria.resetZoom')}>⌂</button>
      </div>
      <div class="image-container">
        <img id="modal-image" src="" alt="" class="modal-image" loading="lazy" decoding="async">
      </div>
      <div class="image-indicator">
        <span class="indicator-text" id="image-indicator">1 / 2</span>
      </div>
    </div>
  </div>
</BaseLayout>
