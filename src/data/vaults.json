{
  "entities": {
    "MACHINE": {
      "descriptionKey": "vaultEditor.fields.MACHINE.description",
      "required": ["ip", "user", "datastore"],
      "optional": ["ssh_password", "port", "host_entry"],
      "fields": {
        "ip": {
          "type": "string",
          "format": "ipv4",
          "example": "192.168.1.100"
        },
        "user": {
          "type": "string",
          "example": "ubuntu"
        },
        "datastore": {
          "type": "string",
          "example": "/mnt/datastore"
        },
        "port": {
          "type": "number",
          "default": 22,
          "example": 22
        },
        "host_entry": {
          "type": "string",
          "example": "192.168.1.100 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC..."
        },
        "ssh_password": {
          "type": "string",
          "sensitive": true,
          "example": "SecurePassword123!"
        }
      }
    },
    "REPOSITORY": {
      "descriptionKey": "vaultEditor.fields.REPOSITORY.description",
      "required": ["name", "size", "encryption", "credential"],
      "optional": ["retention", "schedule"],
      "fields": {
        "name": {
          "type": "string",
          "pattern": "^[a-zA-Z0-9-_]+$",
          "example": "prod-db-backup"
        },
        "size": {
          "type": "string",
          "pattern": "^[0-9]+[KMGT]$",
          "example": "128M"
        },
        "credential": {
          "type": "string",
          "pattern": "^[A-Za-z0-9!@#$%^&*()_+{}|:<>,.?/]{32}$",
          "minLength": 32,
          "maxLength": 32,
          "example": "Kj8#mP2$vL9@nQ4&xR7!wE3*tY6^aS1+"
        },
        "encryption": {
          "type": "boolean",
          "default": true
        },
        "retention": {
          "type": "object",
          "properties": {
            "daily": {
              "type": "number",
              "example": 7
            },
            "weekly": {
              "type": "number",
              "example": 4
            },
            "monthly": {
              "type": "number",
              "example": 12
            }
          }
        },
        "schedule": {
          "type": "string",
          "example": "0 2 * * *"
        }
      }
    },
    "BRIDGE": {
      "descriptionKey": "vaultEditor.fields.BRIDGE.description",
      "required": ["name", "type", "endpoints"],
      "optional": ["security", "loadBalancing", "ip", "user", "datastore", "port", "host_entry", "ssh_password"],
      "fields": {
        "name": {
          "type": "string",
          "example": "region1-bridge"
        },
        "type": {
          "type": "string",
          "enum": ["standard", "high-availability", "geo-distributed"],
          "default": "standard"
        },
        "endpoints": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "host": {
                "type": "string"
              },
              "port": {
                "type": "number"
              },
              "protocol": {
                "type": "string",
                "enum": ["tcp", "udp", "http", "https"],
                "default": "tcp"
              }
            }
          }
        },
        "security": {
          "type": "object",
          "properties": {
            "tls": {
              "type": "boolean",
              "default": true
            },
            "authentication": {
              "type": "string",
              "enum": ["none", "token", "certificate"],
              "default": "token"
            }
          }
        },
        "loadBalancing": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            },
            "algorithm": {
              "type": "string",
              "enum": ["round-robin", "least-connections", "ip-hash"],
              "default": "round-robin"
            }
          }
        },
        "ip": {
          "type": "string",
          "format": "ipv4",
          "example": "192.168.1.50"
        },
        "user": {
          "type": "string",
          "example": "bridge-user"
        },
        "datastore": {
          "type": "string",
          "example": "/mnt/bridge-datastore"
        },
        "port": {
          "type": "number",
          "default": 22,
          "example": 22
        },
        "host_entry": {
          "type": "string",
          "example": "192.168.1.50 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC..."
        },
        "ssh_password": {
          "type": "string",
          "sensitive": true,
          "example": "BridgeSecurePass123!"
        }
      }
    },
    "STORAGE": {
      "descriptionKey": "vaultEditor.fields.STORAGE.description",
      "required": ["type", "path", "capacity"],
      "optional": ["redundancy", "performance"],
      "fields": {
        "type": {
          "type": "string",
          "enum": ["local", "network", "cloud"],
          "example": "local"
        },
        "path": {
          "type": "string",
          "example": "/mnt/storage/backup"
        },
        "capacity": {
          "type": "string",
          "pattern": "^[0-9]+[KMGT]$",
          "example": "1T"
        },
        "redundancy": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": false
            },
            "level": {
              "type": "string",
              "enum": ["mirror", "raid5", "raid6"],
              "default": "mirror"
            }
          }
        },
        "performance": {
          "type": "object",
          "properties": {
            "tier": {
              "type": "string",
              "enum": ["standard", "performance", "archive"],
              "default": "standard"
            },
            "cache": {
              "type": "boolean",
              "default": false
            }
          }
        }
      }
    },
    "SCHEDULE": {
      "descriptionKey": "vaultEditor.fields.SCHEDULE.description",
      "required": ["name", "cron", "task"],
      "optional": ["timezone", "notifications", "retry"],
      "fields": {
        "name": {
          "type": "string",
          "example": "daily-backup"
        },
        "cron": {
          "type": "string",
          "example": "0 2 * * *"
        },
        "task": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["backup", "restore", "sync", "cleanup"]
            },
            "target": {
              "type": "string"
            },
            "options": {
              "type": "object"
            }
          }
        },
        "timezone": {
          "type": "string",
          "default": "UTC",
          "example": "America/New_York"
        },
        "notifications": {
          "type": "object",
          "properties": {
            "onSuccess": {
              "type": "boolean",
              "default": false
            },
            "onFailure": {
              "type": "boolean",
              "default": true
            },
            "channels": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["email", "webhook", "slack"]
              }
            }
          }
        },
        "retry": {
          "type": "object",
          "properties": {
            "attempts": {
              "type": "number",
              "default": 3
            },
            "interval": {
              "type": "number",
              "default": 5
            }
          }
        }
      }
    },
    "REGION": {
      "descriptionKey": "vaultEditor.fields.REGION.description",
      "required": ["name", "code", "location"],
      "optional": [],
      "fields": {
        "name": {
          "type": "string",
          "example": "US East"
        },
        "code": {
          "type": "string",
          "pattern": "^[a-z]{2}-[a-z]+-[0-9]$",
          "example": "us-east-1"
        },
        "location": {
          "type": "object",
          "properties": {
            "country": {
              "type": "string",
              "example": "US"
            },
            "city": {
              "type": "string",
              "example": "Virginia"
            },
            "latitude": {
              "type": "number"
            },
            "longitude": {
              "type": "number"
            }
          }
        }
      }
    },
    "TEAM": {
      "descriptionKey": "vaultEditor.fields.TEAM.description",
      "required": ["name", "permissions"],
      "optional": ["quota", "policies", "SSH_PRIVATE_KEY", "SSH_PUBLIC_KEY"],
      "fields": {
        "name": {
          "type": "string",
          "example": "DevOps"
        },
        "permissions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "example": ["backup_admin", "restore_user"]
        },
        "quota": {
          "type": "object",
          "properties": {
            "machines": {
              "type": "number"
            },
            "storage": {
              "type": "string",
              "example": "10T"
            },
            "repositories": {
              "type": "number"
            }
          }
        },
        "policies": {
          "type": "object",
          "properties": {
            "backupRetention": {
              "type": "number",
              "default": 30
            },
            "encryptionRequired": {
              "type": "boolean",
              "default": true
            },
            "approvalRequired": {
              "type": "boolean",
              "default": false
            }
          }
        },
        "SSH_PRIVATE_KEY": {
          "type": "string",
          "sensitive": true,
          "format": "base64",
          "example": "LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K..."
        },
        "SSH_PUBLIC_KEY": {
          "type": "string",
          "pattern": "^(ssh-rsa|ssh-ed25519|ecdsa-sha2-nistp256|ecdsa-sha2-nistp384|ecdsa-sha2-nistp521) [A-Za-z0-9+/=]+ .+$",
          "example": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC... team-devops"
        }
      }
    },
    "USER": {
      "descriptionKey": "vaultEditor.fields.USER.description",
      "required": [],
      "optional": ["SSH_PRIVATE_KEY", "SSH_PUBLIC_KEY"],
      "fields": {
        "SSH_PRIVATE_KEY": {
          "type": "string",
          "sensitive": true,
          "format": "base64",
          "example": "LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K..."
        },
        "SSH_PUBLIC_KEY": {
          "type": "string",
          "pattern": "^(ssh-rsa|ssh-ed25519|ecdsa-sha2-nistp256|ecdsa-sha2-nistp384|ecdsa-sha2-nistp521) [A-Za-z0-9+/=]+ .+$",
          "example": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC... user@example.com"
        }
      }
    },
    "COMPANY": {
      "descriptionKey": "vaultEditor.fields.COMPANY.description",
      "required": ["UNIVERSAL_USER_ID", "UNIVERSAL_USER_NAME"],
      "optional": ["DOCKER_JSON_CONF", "SSH_PRIVATE_KEY", "SSH_PUBLIC_KEY", "LOG_FILE"],
      "fields": {
        "UNIVERSAL_USER_ID": {
          "type": "string",
          "pattern": "^[0-9]+$",
          "default": "777",
          "example": "777"
        },
        "UNIVERSAL_USER_NAME": {
          "type": "string",
          "pattern": "^[a-z_][a-z0-9_-]*$",
          "default": "rediacc",
          "example": "rediacc"
        },
        "DOCKER_JSON_CONF": {
          "type": "object",
          "properties": {
            "insecure-registries": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "example": ["http://192.168.111.1:5000"]
            },
            "registry-mirrors": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "example": ["http://192.168.111.1:5000"]
            },
            "runtimes": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "properties": {
                  "path": {
                    "type": "string"
                  },
                  "args": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "SSH_PRIVATE_KEY": {
          "type": "string",
          "sensitive": true,
          "format": "base64",
          "example": "LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0K..."
        },
        "SSH_PUBLIC_KEY": {
          "type": "string",
          "pattern": "^(ssh-rsa|ssh-ed25519|ecdsa-sha2-nistp256|ecdsa-sha2-nistp384|ecdsa-sha2-nistp521) [A-Za-z0-9+/=]+ .+$",
          "example": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC... rediacc1"
        },
        "LOG_FILE": {
          "type": "string",
          "default": "/tmp/rediacc.log",
          "example": "/tmp/rediacc.log"
        }
      }
    }
  },
  "commonTypes": {
    "ipAddress": {
      "type": "string",
      "pattern": "^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"
    },
    "port": {
      "type": "number",
      "minimum": 1,
      "maximum": 65535
    },
    "size": {
      "type": "string",
      "pattern": "^[0-9]+[KMGT]$"
    },
    "cronExpression": {
      "type": "string"
    }
  }
}