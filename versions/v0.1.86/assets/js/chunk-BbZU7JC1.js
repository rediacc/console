import{f as e,g as t,r as a}from"./chunk-DZuWtVpy.js";import{r,a as s,b as n,c as u,e as o,k as i,i as l}from"../index-4JeGDNMa.js";import{j as c,f as d,g as f,h as p}from"./chunk-DXw4Pgvm.js";var m,y,v,g={exports:{}},h={},b={};function q(){if(m)return b;m=1,Object.defineProperty(b,"__esModule",{value:!0});return b.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},b}function x(){if(y)return h;y=1;var t=r().default,a=s().default;Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var o=a(n()),i=t(e()),l=a(q()),c=a(u()),d=function(e,t){return i.createElement(c.default,(0,o.default)({},e,{ref:t,icon:l.default}))},f=i.forwardRef(d);return h.default=f,h}function S(){return v||(v=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a;const r=(a=x())&&a.__esModule?a:{default:a};t.default=r,e.exports=r}(g,g.exports)),g.exports}const k=t(S());var C,w,I,M={exports:{}},_={},E={};function O(){if(C)return E;C=1,Object.defineProperty(E,"__esModule",{value:!0});return E.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},E}function z(){if(w)return _;w=1;var t=r().default,a=s().default;Object.defineProperty(_,"__esModule",{value:!0}),_.default=void 0;var o=a(n()),i=t(e()),l=a(O()),c=a(u()),d=function(e,t){return i.createElement(c.default,(0,o.default)({},e,{ref:t,icon:l.default}))},f=i.forwardRef(d);return _.default=f,_}function F(){return I||(I=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a;const r=(a=z())&&a.__esModule?a:{default:a};t.default=r,e.exports=r}(M,M.exports)),M.exports}const N=t(F());var D,V,j,R={exports:{}},P={},Q={};function L(){if(D)return Q;D=1,Object.defineProperty(Q,"__esModule",{value:!0});return Q.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M516 673c0 4.4 3.4 8 7.5 8h185c4.1 0 7.5-3.6 7.5-8v-48c0-4.4-3.4-8-7.5-8h-185c-4.1 0-7.5 3.6-7.5 8v48zm-194.9 6.1l192-161c3.8-3.2 3.8-9.1 0-12.3l-192-160.9A7.95 7.95 0 00308 351v62.7c0 2.4 1 4.6 2.9 6.1L420.7 512l-109.8 92.2a8.1 8.1 0 00-2.9 6.1V673c0 6.8 7.9 10.5 13.1 6.1zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"code",theme:"outlined"},Q}function T(){if(V)return P;V=1;var t=r().default,a=s().default;Object.defineProperty(P,"__esModule",{value:!0}),P.default=void 0;var o=a(n()),i=t(e()),l=a(L()),c=a(u()),d=function(e,t){return i.createElement(c.default,(0,o.default)({},e,{ref:t,icon:l.default}))},f=i.forwardRef(d);return P.default=f,P}function B(){return j||(j=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a;const r=(a=T())&&a.__esModule?a:{default:a};t.default=r,e.exports=r}(R,R.exports)),R.exports}const K=t(B()),J=({value:e,onChange:t,readOnly:r=!1,height:s="400px",className:n="","data-testid":u,onFormatReady:i})=>{const{theme:l}=o(),[d,f]=a.useState(e),[p,m]=a.useState(null),y=a.useRef(null),[v,g]=a.useState(e);if(e!==v)if(g(e),f(e),e.trim())try{JSON.parse(e),m(null)}catch(x){m(x.message)}else m(null);const h=()=>{if(d.trim())try{const e=JSON.parse(d),a=JSON.stringify(e,null,2);f(a),t?.(a),m(null)}catch(x){m(x.message)}};a.useEffect(()=>{i&&i(h)},[i]);const b={height:"number"==typeof s?`${s}px`:s,position:"relative",border:"1px solid var(--color-border-primary)",borderRadius:"8px",overflow:"hidden",backgroundColor:"var(--color-bg-primary)",fontFamily:'Consolas, Monaco, "Courier New", monospace',fontSize:"14px",lineHeight:"1.5",boxShadow:"var(--shadow-sm)"},q={position:"absolute",bottom:0,left:0,right:0,padding:"var(--space-xs) var(--space-sm)",backgroundColor:"dark"===l?"var(--color-bg-error)":"#fee2e2",color:"var(--color-error)",fontSize:"12px",fontWeight:"500",borderTop:"1px solid var(--color-error)",borderRadius:"0 0 8px 8px"};return c.jsxs("div",{className:n,style:b,children:[c.jsx("textarea",{ref:y,value:d,onChange:e=>{const a=e.target.value;f(a),(t=>{if(t.trim())try{JSON.parse(t),m(null)}catch(e){m(e.message)}else m(null)})(a),t?.(a)},onKeyDown:e=>{if("Tab"===e.key){e.preventDefault();const a=e.currentTarget,r=a.selectionStart,s=a.selectionEnd,n=d.substring(0,r)+"  "+d.substring(s);f(n),t?.(n),a.selectionStart=a.selectionEnd=r+2}},readOnly:r,spellCheck:!1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",style:{width:"100%",height:"100%",padding:"var(--space-md)",border:"none",outline:"none",resize:"none",backgroundColor:"transparent",color:"var(--color-text-primary)",fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",tabSize:2},"data-testid":u}),p&&c.jsxs("div",{style:q,children:["JSON Error: ",p]})]})};function A(e){try{return JSON.stringify(JSON.parse(e))}catch(t){return e}}const G=(e={})=>d({queryKey:["queue-items",e],queryFn:async()=>{const t=await l.get("/GetTeamQueueItems",e);let a=[],r=null;return t.resultSets?.forEach(e=>{if(e.data&&e.data.length>0){const t=e.data[0];"totalCount"in t||"pendingCount"in t?r=t:("taskId"in t||"TaskId"in t)&&(a=e.data)}}),{items:a,statistics:r}}}),H=()=>{const e=f();return p({mutationFn:async e=>{const t=e.priority&&e.priority>=1&&e.priority<=5?e.priority:3,a={...e,queueVault:A(e.queueVault),priority:t},r=await l.post("/CreateQueueItem",a),s=r.resultSets[1]?.data[0]?.taskId||r.resultSets[1]?.data[0]?.TaskId;return{...r,taskId:s}},onSuccess:(t,a)=>{e.invalidateQueries({queryKey:["queue-items"]}),e.invalidateQueries({queryKey:["queue-items-bridge",a.bridgeName]}),i("success","Queue item created"+(t.taskId?` with ID: ${t.taskId}`:""))},onError:e=>{i("error",e.message||"Failed to create queue item")}})},$=()=>{const e=f();return p({mutationFn:async e=>await l.post("/CancelQueueItem",{taskId:e}),onSuccess:(t,a)=>{e.invalidateQueries({queryKey:["queue-items"]}),e.invalidateQueries({queryKey:["queue-items-bridge"]}),i("success",`Queue item ${a} cancellation initiated`)},onError:e=>{i("error",e.message||"Failed to cancel queue item")}})},W=()=>{const e=f();return p({mutationFn:async e=>await l.post("/RetryFailedQueueItem",{taskId:e}),onSuccess:(t,a)=>{e.invalidateQueries({queryKey:["queue-items"]}),e.invalidateQueries({queryKey:["queue-item-trace",a]}),i("success",`Queue item ${a} queued for retry`)},onError:e=>{i("error",e.message||"Failed to retry queue item")}})},U=(e,t=!0)=>d({queryKey:["queue-item-trace",e],queryFn:async()=>{if(!e)return null;const t=await l.get("/GetQueueItemTrace",{taskId:e});let a=null,r=[],s=null,n=null,u=[],o=null,i=null;return t.resultSets?.forEach(e=>{if(e.data&&e.data.length>0){switch(e.resultSetIndex){case 1:a=e.data[0];break;case 2:s=e.data[0];break;case 3:n=e.data[0];break;case 4:r=e.data;break;case 5:u=e.data;break;case 6:o=e.data[0];break;case 7:i=e.data[0]}}}),{queueDetails:a,traceLogs:r,vaultContent:s,responseVaultContent:n,queuePosition:u,machineStats:o,planInfo:i}},enabled:t&&!!e,refetchInterval:a=>{const r=a.state.data,s=r?.queueDetails?.status||r?.queueDetails?.Status,n=r?.queueDetails?.retryCount||r?.queueDetails?.RetryCount||0,u=r?.queueDetails?.permanentlyFailed||r?.queueDetails?.PermanentlyFailed,o=r?.queueDetails?.lastFailureReason||r?.queueDetails?.LastFailureReason;if("COMPLETED"===s||"CANCELLED"===s)return!1;if("CANCELLING"===s)return!(!t||!e)&&1e3;if("FAILED"===s&&(u||n>=3))return!1;if(("FAILED"===s||"PENDING"===s)&&o){if(["Bridge reported failure","Task permanently failed","Fatal error"].some(e=>o.includes(e)))return!1}return!("PENDING"===s&&n>=3&&o)&&(!(!t||!e)&&1e3)},refetchIntervalInBackground:!1,networkMode:"online"}),X=["teams","allTeams","regions","bridgesByRegion","machinesByTeam","users","permissionGroups","permissions","subscriptionPlans"],Y=X.reduce((e,t)=>({...e,[t]:[]}),{}),Z=(e,t)=>{if(!e[t]||"string"!=typeof e[t])return e[t];try{return JSON.parse(e[t])}catch(a){return e[t]}},ee=e=>d({queryKey:["dropdown-data",e],queryFn:async()=>{const e=await l.get("/GetLookupData",{}),t=e.resultSets[1]?.data[0]??e.resultSets[0]?.data[0];if(t?.dropdownValues)try{return(e=>{const t="string"==typeof e.dropdownValues?JSON.parse(e.dropdownValues):e.dropdownValues;return X.forEach(e=>{t[e]=Z(t,e)}),Array.isArray(t.bridgesByRegion)&&(t.bridgesByRegion=t.bridgesByRegion.map(e=>({...e,bridges:Z(e,"bridges")}))),t})(t)}catch(a){return Y}return{...Y,...t}},staleTime:18e5,gcTime:36e5});export{K as C,k as Q,N as R,J as S,ee as a,G as b,$ as c,U as d,W as e,A as m,H as u};
