import{j as e}from"./chunk-DXw4Pgvm.js";import{f as t,g as s,r as i,L as a}from"./chunk-DZuWtVpy.js";import{r,a as n,b as l,c as o,u as d,H as c,d as u,e as h,C as x,E as g,f as y,S as p,W as m,g as j,h as b,T as v,U as f,I as S}from"../index-CPnZeLBe.js";import{E as w}from"./chunk-BM8fZE5c.js";import{T as C,A as I}from"./chunk-huyDvUHn.js";import{u as P,E as k}from"./chunk-2gdvOj65.js";import{S as T,D as z}from"./chunk-Z0TSE2Iv.js";import{C as M}from"./chunk-DATOoulk.js";import{C as A}from"./chunk-BaK2xAEp.js";import{C as L}from"./chunk-B6DwdnHp.js";import{L as R,S as _}from"./chunk-CB38Htbo.js";import{I as E}from"./chunk-ChDz7P67.js";import{F as $}from"./chunk-B6zExl6w.js";import{D as B,C as q}from"./chunk-B3eshzUJ.js";import{C as N}from"./chunk-vWlxqR9N.js";import{u as D}from"./chunk-CM3g5OHp.js";import{t as H,o as O,a as U,q as F,s as W,u as V,T as G,P as Q,f as Y,k as J,g as K,p as X,i as Z,E as ee,v as te,w as se,h as ie}from"./chunk-CSjZqX98.js";import"./chunk-BNqsZZGB.js";import"./chunk-C0XEpv6B.js";var ae,re,ne,le={exports:{}},oe={},de={};function ce(){if(ae)return de;ae=1,Object.defineProperty(de,"__esModule",{value:!0});return de.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"},de}function ue(){if(re)return oe;re=1;var e=r().default,s=n().default;Object.defineProperty(oe,"__esModule",{value:!0}),oe.default=void 0;var i=s(l()),a=e(t()),d=s(ce()),c=s(o()),u=function(e,t){return a.createElement(c.default,(0,i.default)({},e,{ref:t,icon:d.default}))},h=a.forwardRef(u);return oe.default=h,oe}function he(){return ne||(ne=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s;const i=(s=ue())&&s.__esModule?s:{default:s};t.default=i,e.exports=i}(le,le.exports)),le.exports}const xe=s(he());var ge,ye,pe,me={exports:{}},je={},be={};function ve(){if(ge)return be;ge=1,Object.defineProperty(be,"__esModule",{value:!0});return be.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"},be}function fe(){if(ye)return je;ye=1;var e=r().default,s=n().default;Object.defineProperty(je,"__esModule",{value:!0}),je.default=void 0;var i=s(l()),a=e(t()),d=s(ve()),c=s(o()),u=function(e,t){return a.createElement(c.default,(0,i.default)({},e,{ref:t,icon:d.default}))},h=a.forwardRef(u);return je.default=h,je}function Se(){return pe||(pe=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s;const i=(s=fe())&&s.__esModule?s:{default:s};t.default=i,e.exports=i}(me,me.exports)),me.exports}const we=s(Se()),Ce=new Map,Ie=new Map,Pe=(e,t)=>{const s={COMMUNITY:"community",ADVANCED:"advanced",PREMIUM:"premium",ELITE:"elite"}[t]||t.toLowerCase(),i=e.baseMonthlyPrices[s];if(!i)return null;if("string"==typeof i.price&&("free"===i.price.toLowerCase()||"gratis"===i.price.toLowerCase()||"0"===i.price))return 0;const a="string"==typeof i.price?parseFloat(i.price):i.price;return isNaN(a)?null:a},{Text:ke}=G,Te=({stats:t})=>{const{t:s}=D(["common","distributedStorage"]),{token:i}=H.useToken(),a=d();if(!t)return null;const r=e=>{switch(e){case"available":return i.colorSuccess;case"cluster":return i.colorInfo;case"image":return i.colorWarning;case"clone":return"#fa8c16";default:return i.colorTextSecondary}},n=[{type:"available",label:s("distributedStorage:assignmentStatus.available"),count:t.truly_available_machines,percentage:Math.round(t.truly_available_machines/t.total_machines*100),icon:e.jsx(N,{})},{type:"cluster",label:s("distributedStorage:assignmentStatus.cluster"),count:t.cluster_assigned_machines,percentage:t.cluster_percentage,icon:e.jsx(B,{})},{type:"image",label:s("distributedStorage:assignmentStatus.image"),count:t.image_assigned_machines,percentage:t.image_percentage,icon:e.jsx(c,{})},{type:"clone",label:s("distributedStorage:assignmentStatus.clone"),count:t.clone_assigned_machines,percentage:t.clone_percentage,icon:e.jsx(q,{})}];return e.jsx(O,{"data-testid":"ds-widget-card",title:e.jsxs(U,{style:a.flexStart,children:[e.jsx(N,{style:a.icon.medium}),e.jsx("span",{style:a.heading4,children:s("distributedStorage:dashboard.title")})]}),extra:e.jsx(ke,{type:"secondary",style:a.caption,children:s("distributedStorage:dashboard.subtitle",{total:t.total_machines})}),style:{...a.card,border:"1px solid var(--color-border-secondary)"},children:e.jsxs(U,{direction:"vertical",size:"large",style:{width:"100%",...a.padding.md},children:[e.jsx(F,{gutter:[16,16],children:n.map(t=>e.jsx(W,{xs:12,sm:12,md:6,children:e.jsx(O,{"data-testid":`ds-widget-stat-${t.type}`,size:"small",style:{textAlign:"center",borderColor:r(t.type),borderRadius:"var(--border-radius-lg)",backgroundColor:"var(--color-bg-container)",boxShadow:"var(--shadow-sm)",...a.hoverEffect},children:e.jsxs(U,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx("div",{style:{fontSize:a.icon.xlarge.fontSize,color:r(t.type)},children:t.icon}),e.jsx(V,{"data-testid":`ds-widget-stat-value-${t.type}`,title:e.jsx("span",{style:a.label,children:t.label}),value:t.count,suffix:e.jsxs(ke,{type:"secondary",style:a.caption,children:["(",t.percentage,"%)"]}),valueStyle:{...a.heading3,color:r(t.type)}})]})})},t.type))}),e.jsxs(F,{gutter:[16,16],children:[e.jsx(W,{xs:24,md:12,children:e.jsx("div",{"data-testid":"ds-widget-cluster-summary",style:{...a.padding.md,backgroundColor:"var(--color-bg-container)",borderRadius:"var(--border-radius-lg)",border:"1px solid var(--color-border-secondary)",boxShadow:"var(--shadow-sm)"},children:e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(ke,{strong:!0,style:a.heading5,children:s("distributedStorage:dashboard.clusterSummary")}),e.jsxs(F,{gutter:16,children:[e.jsx(W,{span:12,children:e.jsx(V,{"data-testid":"ds-widget-stat-total-clusters",title:e.jsx("span",{style:a.label,children:s("distributedStorage:dashboard.totalClusters")}),value:t.total_clusters,valueStyle:a.heading4})}),e.jsx(W,{span:12,children:e.jsx(V,{"data-testid":"ds-widget-stat-avg-machines",title:e.jsx("span",{style:a.label,children:s("distributedStorage:dashboard.avgMachinesPerCluster")}),value:t.avg_machines_per_cluster,precision:1,valueStyle:a.heading4})})]})]})})}),e.jsx(W,{xs:24,md:12,children:e.jsx("div",{"data-testid":"ds-widget-machine-utilization",style:{...a.padding.md,backgroundColor:"var(--color-bg-container)",borderRadius:"var(--border-radius-lg)",border:"1px solid var(--color-border-secondary)",boxShadow:"var(--shadow-sm)"},children:e.jsxs(U,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(ke,{strong:!0,style:a.heading5,children:s("distributedStorage:dashboard.machineUtilization")}),e.jsx(Q,{"data-testid":"ds-widget-progress-utilization",percent:Math.round((t.total_machines-t.truly_available_machines)/t.total_machines*100),strokeColor:{"0%":i.colorPrimary,"100%":i.colorSuccess},format:e=>`${e}% ${s("common:utilized")}`}),e.jsx(ke,{type:"secondary",style:a.caption,children:s("distributedStorage:dashboard.utilizationDetails",{used:t.total_machines-t.truly_available_machines,total:t.total_machines})})]})})})]}),t.team_breakdown&&t.team_breakdown.length>0&&e.jsxs("div",{"data-testid":"ds-widget-team-breakdown",children:[e.jsxs(U,{style:a.marginBottom.sm,children:[e.jsx(C,{style:a.icon.medium}),e.jsx(ke,{strong:!0,style:a.heading5,children:s("distributedStorage:dashboard.teamBreakdown")})]}),e.jsx(Y,{"data-testid":"ds-widget-team-list",size:"small",dataSource:t.team_breakdown,renderItem:t=>e.jsx(Y.Item,{"data-testid":`ds-widget-team-item-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,style:{...a.padding.sm,backgroundColor:"var(--color-bg-container)",marginBottom:"8px",borderRadius:"var(--border-radius-md)",border:"1px solid var(--color-border-secondary)",boxShadow:"var(--shadow-sm)"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{...a.flexBetween,...a.marginBottom.xs},children:[e.jsx(ke,{strong:!0,style:a.label,children:t.TeamName}),e.jsxs(ke,{type:"secondary",style:a.caption,children:[t.TotalMachines," machines"]})]}),e.jsxs(U,{wrap:!0,children:[e.jsx(J,{title:s("distributedStorage:assignmentStatus.available"),children:e.jsxs(K,{"data-testid":`ds-widget-team-tag-available-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"success",children:[t.AvailableMachines," available"]})}),t.ClusterMachines>0&&e.jsx(J,{title:s("distributedStorage:assignmentStatus.cluster"),children:e.jsxs(K,{"data-testid":`ds-widget-team-tag-cluster-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"blue",children:[t.ClusterMachines," cluster"]})}),t.ImageMachines>0&&e.jsx(J,{title:s("distributedStorage:assignmentStatus.image"),children:e.jsxs(K,{"data-testid":`ds-widget-team-tag-image-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"purple",children:[t.ImageMachines," image"]})}),t.CloneMachines>0&&e.jsx(J,{title:s("distributedStorage:assignmentStatus.clone"),children:e.jsxs(K,{"data-testid":`ds-widget-team-tag-clone-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"orange",children:[t.CloneMachines," clone"]})})]})]})})})]})]})})},{Title:ze,Text:Me,Paragraph:Ae}=G,Le={User:e.jsx(f,{}),Team:e.jsx(C,{}),Region:e.jsx(w,{}),Bridge:e.jsx(I,{}),Machine:e.jsx(z,{}),Repo:e.jsx(E,{}),Storage:e.jsx(M,{})},Re=()=>{const{data:t,isLoading:s,error:r}=u(),{data:n,isLoading:l}=P(6),[o,d]=i.useState(null),[c,f]=i.useState(!0),[w,I]=i.useState(!1),{theme:M}=h(),{token:E}=H.useToken();if(i.useEffect(()=>{const e=()=>{const e=window.innerWidth<768;I(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),i.useEffect(()=>{(async()=>{f(!0);try{const e=await(async()=>{const e="pricing",t=Ce.get(e),s=Ie.get(e);if(t&&s&&Date.now()-s<36e5)return t;try{const t=await fetch("/configs/pricing.json");if(!t.ok)throw new Error(`Failed to fetch pricing: ${t.status}`);const s=await t.json();return Ce.set(e,s),Ie.set(e,Date.now()),s}catch(r){return t||null}})();d(e)}catch(e){d(null)}finally{f(!1)}})()},[]),s)return e.jsx("div",{style:{padding:24,textAlign:"center"},children:e.jsx(X,{size:"large"})});if(r)return e.jsx("div",{style:{padding:24},children:e.jsx(Z,{message:"Error",description:"Failed to load dashboard data. Please try again later.",type:"error",showIcon:!0,icon:e.jsx(xe,{}),"data-testid":"dashboard-error-alert"})});if(!t)return e.jsx("div",{style:{padding:24},children:e.jsx(ee,{description:"No dashboard data available"})});const B={Critical:"error",Warning:"warning",Good:"success"},q=90,N=75,D=t=>{const s=t.toLowerCase();return s.includes("create")?e.jsx(y,{style:{color:E.colorSuccess}}):s.includes("delete")?e.jsx(L,{style:{color:E.colorError}}):s.includes("update")||s.includes("modify")?e.jsx(k,{style:{color:E.colorWarning}}):s.includes("login")||s.includes("auth")?e.jsx(R,{style:{color:E.colorInfo}}):s.includes("export")||s.includes("import")?e.jsx(_,{style:{color:E.colorPrimary}}):e.jsx(S,{style:{color:E.colorTextSecondary}})},G=6e4,ae=60,re=24,ne=7,le=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),i=Math.floor(s/G);if(i<1)return"just now";if(i<ae)return`${i} minute${i>1?"s":""} ago`;const a=Math.floor(i/ae);if(a<re)return`${a} hour${a>1?"s":""} ago`;const r=Math.floor(a/re);return r<ne?`${r} day${r>1?"s":""} ago`:t.toLocaleDateString()};return e.jsxs("div",{style:{padding:w?16:24},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx(ze,{level:2,children:"Dashboard"}),e.jsxs(Me,{type:"secondary",children:["Welcome to ",t.companyInfo.CompanyName]}),w&&e.jsx("div",{style:{marginTop:8},children:e.jsx(Me,{type:"secondary",style:{fontSize:12},children:"Tap sections below to expand/collapse content"})})]}),e.jsxs(U,{direction:"vertical",size:"large",style:{width:"100%"},children:[1===t.activeSubscription?.IsExpiringSoon&&e.jsx(Z,{message:"Subscription Expiring Soon",description:`Your ${t.activeSubscription.PlanName} subscription expires in ${t.activeSubscription.DaysRemaining} days.${t.activeSubscription.AutoRenew?"":" Enable auto-renewal to avoid service interruption."}`,type:"warning",showIcon:!0,icon:e.jsx(x,{}),"data-testid":"dashboard-alert-subscription-expiring"}),t.accountHealth.ResourcesAtLimit>0&&e.jsx(Z,{message:"Resource Limits Reached",description:`${t.accountHealth.ResourcesAtLimit} resource type(s) have reached their limits. Consider upgrading your plan to continue scaling.`,type:"error",showIcon:!0,icon:e.jsx(g,{}),"data-testid":"dashboard-alert-resource-limits"}),e.jsxs(F,{gutter:[16,16],children:[e.jsx(W,{xs:24,lg:12,children:e.jsx(O,{"data-testid":"dashboard-account-health-card",title:e.jsxs(U,{children:[e.jsx(p,{}),e.jsx("span",{children:"Account Health"})]}),style:{height:"100%"},children:e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Overall Status"}),e.jsx(K,{color:(oe=t.accountHealth.SubscriptionStatus,B[oe]||"success"),children:t.accountHealth.SubscriptionStatus})]}),e.jsxs(U,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs(U,{children:[t.accountHealth.ResourcesAtLimit>0?e.jsx(g,{style:{color:E.colorWarning}}):e.jsx(y,{style:{color:E.colorSuccess}}),e.jsxs(Me,{children:[t.accountHealth.ResourcesAtLimit," resources at limit"]})]}),e.jsxs(U,{children:[e.jsx(x,{style:{color:E.colorTextSecondary}}),e.jsxs(Me,{children:[t.accountHealth.ResourcesNearLimit," resources near limit"]})]})]}),e.jsx("div",{style:{paddingTop:12,borderTop:`1px solid ${E.colorBorder}`},children:e.jsx(Me,{strong:!0,children:t.accountHealth.UpgradeRecommendation})})]})})}),e.jsx(W,{xs:24,lg:12,children:t.queueStats?e.jsx(O,{title:e.jsxs(U,{children:[e.jsx(we,{}),e.jsx("span",{children:"Queue Overview"})]}),extra:e.jsx(a,{to:"/queue",style:{color:E.colorPrimary},"data-testid":"dashboard-queue-manage-link",children:"Manage"}),style:{height:"100%"},"data-testid":"dashboard-card-queue-overview",children:e.jsxs(U,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(F,{gutter:[16,16],children:[e.jsx(W,{span:6,children:e.jsx(V,{title:"Pending",value:t.queueStats.PendingCount||0,valueStyle:{color:E.colorWarning},prefix:e.jsx(x,{}),"data-testid":"dashboard-stat-pending"})}),e.jsx(W,{span:6,children:e.jsx(V,{title:"Processing",value:t.queueStats.ActiveCount||0,valueStyle:{color:E.colorInfo},prefix:e.jsx(T,{spin:!0}),"data-testid":"dashboard-stat-processing"})}),e.jsx(W,{span:6,children:e.jsx(V,{title:"Completed",value:t.queueStats.CompletedCount||0,valueStyle:{color:E.colorSuccess},prefix:e.jsx(y,{}),"data-testid":"dashboard-stat-completed"})}),e.jsx(W,{span:6,children:e.jsx(V,{title:"Failed",value:t.queueStats.FailedCount||0,valueStyle:{color:E.colorError},prefix:e.jsx(g,{}),"data-testid":"dashboard-stat-failed"})})]}),(1===t.queueStats.HasStaleItems||1===t.queueStats.HasOldPendingItems)&&e.jsxs(U,{direction:"vertical",size:"small",style:{width:"100%"},children:[1===t.queueStats.HasStaleItems&&e.jsx(Z,{message:`${t.queueStats.StaleCount||0} stale items`,type:"warning",showIcon:!0,icon:e.jsx(m,{}),"data-testid":"dashboard-alert-stale-items"}),1===t.queueStats.HasOldPendingItems&&e.jsx(Z,{message:`Oldest: ${Math.floor((t.queueStats.OldestPendingAgeMinutes||0)/60)}h`,type:"info",showIcon:!0,icon:e.jsx($,{}),"data-testid":"dashboard-alert-old-pending"})]})]})}):e.jsx(O,{title:e.jsxs(U,{children:[e.jsx(we,{}),e.jsx("span",{children:"Queue Overview"})]}),style:{height:"100%"},"data-testid":"dashboard-card-queue-overview-empty",children:e.jsx(ee,{description:"No queue data available"})})})]}),e.jsx(O,{title:"Resource Usage",extra:e.jsx(Me,{type:"secondary",children:"Monitor your resource consumption against plan limits"}),"data-testid":"dashboard-card-resource-usage",children:e.jsx(F,{gutter:[16,24],children:t.resources.map(t=>{return e.jsx(W,{xs:24,sm:12,md:8,children:e.jsx("div",{style:{padding:"16px",borderRadius:j("LG"),border:`1px solid ${E.colorBorderSecondary}`,backgroundColor:"dark"===M?E.colorBgContainer:E.colorBgLayout,height:"100%",transition:"all 0.2s ease"},children:e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(U,{size:"small",children:[Le[t.ResourceType],e.jsxs(Me,{strong:!0,children:[t.ResourceType,"s"]})]}),e.jsxs(Me,{type:"secondary",style:{fontWeight:500},children:[t.CurrentUsage," / ",0===t.ResourceLimit?"∞":t.ResourceLimit]})]}),e.jsx(Q,{percent:0===t.ResourceLimit?0:t.UsagePercentage,status:(s=t.UsagePercentage,s>=q?"exception":s>=N?"normal":"success"),strokeColor:1===t.IsLimitReached?"dark"===M?"#ff6b6b":E.colorError:"dark"===M?"#7d9b49":E.colorPrimary,"data-testid":`dashboard-progress-${t.ResourceType.toLowerCase()}`,style:{margin:"8px 0"}}),1===t.IsLimitReached&&e.jsx(Me,{type:"danger",style:{fontSize:12,fontWeight:500},children:"Limit reached"})]})})},t.ResourceType);var s})})}),e.jsx(O,{title:e.jsxs(U,{children:[e.jsx(b,{}),e.jsx("span",{children:"Recent Activity"})]}),extra:e.jsx(a,{to:"/audit",style:{color:E.colorPrimary},"data-testid":"dashboard-activity-viewall-link",children:"View All"}),"data-testid":"dashboard-card-recent-activity",children:l?e.jsx("div",{style:{textAlign:"center",padding:"20px"},children:e.jsx(X,{})}):n&&n.length>0?e.jsx(te,{items:n.filter(e=>{const t=e.action.toLowerCase(),s=t.includes("token")&&t.includes("validat"),i=t.includes("login")&&t.includes("success");return!s&&!i}).slice(0,5).map((t,s)=>({key:s,dot:D(t.action),children:e.jsxs(U,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(U,{size:8,children:[e.jsx(Me,{strong:!0,style:{fontSize:14},children:t.action.replace(/_/g," ")}),e.jsx(K,{children:t.entity})]}),e.jsx(Me,{type:"secondary",style:{fontSize:11,flexShrink:0,marginLeft:8},children:le(t.timestamp)})]}),e.jsxs(Me,{type:"secondary",style:{fontSize:12,lineHeight:1.4},children:[t.entityName," ",t.actionByUser&&`• ${t.actionByUser}`]}),t.details&&t.details.trim()&&e.jsx(Me,{type:"secondary",style:{fontSize:11,opacity:.8},children:t.details.length>80?`${t.details.substring(0,80)}...`:t.details})]})}))}):e.jsx(ee,{description:"No recent activity",image:ee.PRESENTED_IMAGE_SIMPLE,style:{padding:"20px 0"}})}),t.queueStats&&(Array.isArray(t.queueStats.TeamIssues)&&t.queueStats.TeamIssues.length>0||Array.isArray(t.queueStats.MachineIssues)&&t.queueStats.MachineIssues.length>0)&&e.jsx(O,{title:e.jsxs(U,{children:[e.jsx(we,{}),e.jsx("span",{children:"Queue Details"})]}),"data-testid":"dashboard-card-queue-details",children:e.jsxs(F,{gutter:[16,16],children:[e.jsx(W,{xs:24,lg:8,children:e.jsxs("div",{style:{padding:"16px",backgroundColor:"dark"===M?E.colorBgContainer:E.colorBgLayout,borderRadius:j("LG"),border:`1px solid ${E.colorBorder}`,height:"100%"},children:[e.jsx(Me,{strong:!0,style:{display:"block",marginBottom:12},children:"Today's Activity"}),e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{type:"secondary",children:"Created"}),e.jsx(Me,{strong:!0,style:{fontSize:18},"data-testid":"dashboard-stat-created-today",children:t.queueStats.CreatedToday||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{type:"secondary",children:"Completed"}),e.jsx(Me,{strong:!0,style:{fontSize:18,color:E.colorSuccess},"data-testid":"dashboard-stat-completed-today",children:t.queueStats.CompletedToday||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{type:"secondary",children:"Cancelled"}),e.jsx(Me,{strong:!0,style:{fontSize:18,color:E.colorError},"data-testid":"dashboard-stat-cancelled-today",children:t.queueStats.CancelledToday||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{type:"secondary",children:"Failed"}),e.jsx(Me,{strong:!0,style:{fontSize:18,color:E.colorError},"data-testid":"dashboard-stat-failed-today",children:t.queueStats.FailedToday||0})]})]})]})}),e.jsx(W,{xs:24,lg:16,children:e.jsxs(U,{direction:"vertical",size:"large",style:{width:"100%"},children:[Array.isArray(t.queueStats.TeamIssues)&&t.queueStats.TeamIssues.length>0&&e.jsxs("div",{children:[e.jsxs(Me,{strong:!0,style:{display:"block",marginBottom:12},children:[e.jsx(C,{})," Team Queue Status"]}),e.jsx(Y,{size:"small",dataSource:t.queueStats.TeamIssues,"data-testid":"dashboard-list-team-issues",renderItem:t=>e.jsx(Y.Item,{style:{paddingLeft:0,paddingRight:0},children:e.jsx("div",{style:{width:"100%"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx(Me,{strong:!0,children:t.TeamName}),e.jsxs(U,{size:"small",children:[(t.StaleItems||0)>0&&e.jsxs(K,{color:"warning",children:[e.jsx(m,{})," ",t.StaleItems," stale"]}),e.jsxs(K,{color:"blue",children:[t.PendingItems||0," pending"]}),e.jsxs(K,{color:"processing",children:[t.ActiveItems||0," active"]})]})]})})})})]}),Array.isArray(t.queueStats.MachineIssues)&&t.queueStats.MachineIssues.length>0&&e.jsxs("div",{children:[e.jsxs(Me,{strong:!0,style:{display:"block",marginBottom:12},children:[e.jsx(z,{})," Machine Queue Status"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsx(se,{size:"small",dataSource:t.queueStats.MachineIssues,pagination:!1,"data-testid":"dashboard-table-machine-issues",columns:[{title:"Machine",dataIndex:"MachineName",key:"MachineName",ellipsis:!0},{title:"Team",dataIndex:"TeamName",key:"TeamName",ellipsis:!0},{title:"Status",key:"status",width:200,render:(t,s)=>e.jsxs(U,{size:"small",children:[(s.StaleItems||0)>0&&e.jsxs(K,{color:"warning",children:[s.StaleItems," stale"]}),e.jsxs(K,{color:"blue",children:[s.PendingItems||0," pending"]}),e.jsxs(K,{color:"processing",children:[s.ActiveItems||0," active"]})]})}]})})]}),1===t.featureAccess.HasAdvancedAnalytics&&null!==t.queueStats.HighestPriorityPending&&e.jsxs("div",{style:{padding:"16px",backgroundColor:"dark"===M?E.colorBgContainer:E.colorBgLayout,borderRadius:j("LG"),border:`1px solid ${E.colorBorder}`},children:[e.jsxs(Me,{strong:!0,style:{display:"block",marginBottom:12},children:[e.jsx(v,{})," Priority Breakdown"]}),e.jsxs(U,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Highest Priority"}),e.jsx(ie,{count:t.queueStats.HighestPriorityPending??0,style:{backgroundColor:E.colorError},"data-testid":"dashboard-badge-highest-priority"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"High Priority"}),e.jsx(ie,{count:t.queueStats.HighPriorityPending??0,style:{backgroundColor:E.colorWarning},"data-testid":"dashboard-badge-high-priority"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Normal Priority"}),e.jsx(ie,{count:t.queueStats.NormalPriorityPending??0,style:{backgroundColor:E.colorInfo},"data-testid":"dashboard-badge-normal-priority"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(Me,{children:"Low Priority"}),e.jsx(ie,{count:t.queueStats.LowPriorityPending??0,style:{backgroundColor:E.colorTextSecondary},"data-testid":"dashboard-badge-low-priority"})]})]})]})]})})]})}),1===t.featureAccess?.HasAdvancedAnalytics&&t.distributedStorageStats&&e.jsx(Te,{stats:t.distributedStorageStats}),e.jsx(O,{title:e.jsxs(U,{children:[e.jsx(A,{}),e.jsx("span",{children:"Subscription & Plans"}),t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0&&e.jsx(ie,{count:t.allActiveSubscriptions.length,style:{backgroundColor:"#333333"}})]}),"data-testid":"dashboard-card-subscription-plans",children:e.jsxs(F,{gutter:[24,24],children:[e.jsx(W,{xs:24,md:8,children:t.activeSubscription?e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(Me,{type:"secondary",style:{fontSize:12},children:"CURRENT SUBSCRIPTION"}),e.jsx(ze,{level:4,style:{margin:"8px 0"},children:t.activeSubscription.PlanName}),e.jsx(Ae,{type:"secondary",style:{marginBottom:16},children:t.activeSubscription.PlanDescription}),e.jsxs(F,{gutter:[16,16],children:[e.jsx(W,{span:12,children:e.jsx(V,{title:"Active Licenses",value:t.activeSubscription.TotalActivePurchases,valueStyle:{color:E.colorText},"data-testid":"dashboard-stat-active-licenses"})}),e.jsx(W,{span:12,children:e.jsx(V,{title:"Days Remaining",value:t.activeSubscription.DaysRemaining,valueStyle:{color:t.activeSubscription.DaysRemaining<=30?E.colorError:E.colorText},"data-testid":"dashboard-stat-days-remaining"})})]})]}),!c&&o&&e.jsx("div",{style:{padding:"16px",backgroundColor:"dark"===M?E.colorBgContainer:E.colorBgLayout,borderRadius:j("LG"),border:`1px solid ${E.colorBorder}`},children:e.jsxs(U,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Me,{strong:!0,children:"Monthly Cost"}),e.jsxs(ze,{level:3,style:{margin:0},"data-testid":"dashboard-stat-monthly-cost",children:["$",(()=>{let e=0;return t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0?t.allActiveSubscriptions.forEach(t=>{const s=Pe(o,t.planCode);null!==s&&1!==t.isTrial&&(e+=s*t.quantity)}):t.billingInfo&&t.activeSubscription&&(e=t.billingInfo.Price*(t.activeSubscription.Quantity||1)),e.toFixed(2)})()]})]}),e.jsx(Me,{type:"secondary",children:t.allActiveSubscriptions&&t.allActiveSubscriptions.length>1?`Total from ${t.allActiveSubscriptions.length} active subscriptions`:t.billingInfo?`Billed ${t.billingInfo.BillingInterval}ly • ${t.billingInfo.Currency.toUpperCase()}`:"Monthly subscription cost"}),1===t.activeSubscription?.IsTrial&&e.jsx(K,{color:"blue",children:"Trial Period"})]})})]}):e.jsx(ee,{description:"No active subscription"})}),t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0&&e.jsx(W,{xs:24,md:8,children:e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(Me,{type:"secondary",style:{fontSize:12},children:"ALL ACTIVE LICENSES"}),e.jsxs(ze,{level:4,style:{margin:"8px 0"},children:[t.allActiveSubscriptions.length," Total"]})]}),e.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:e.jsx(U,{direction:"vertical",size:"small",style:{width:"100%"},children:t.allActiveSubscriptions.map((t,s)=>e.jsxs("div",{style:{padding:"12px",backgroundColor:"dark"===M?E.colorBgContainer:E.colorBgLayout,borderRadius:6,border:`1px solid ${E.colorBorder}`},"data-testid":`dashboard-license-item-${s}`,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs(U,{children:[e.jsx(Me,{strong:!0,children:t.planName}),e.jsx(ie,{count:`×${t.quantity}`,style:{backgroundColor:"#52c41a"}}),1===t.isTrial&&e.jsx(K,{color:"blue",children:"Trial"})]}),e.jsxs(Me,{type:t.daysRemaining<=30?"danger":"secondary",style:{fontSize:12},children:[t.daysRemaining," ",1===t.daysRemaining?"day":"days"," remaining"]})]}),e.jsx(J,{title:`From ${new Date(t.startDate).toLocaleDateString()} to ${new Date(t.endDate).toLocaleDateString()}`,children:e.jsx(Q,{"data-testid":`dashboard-progress-subscription-${t.planCode}`,percent:(()=>{const e=new Date(t.startDate),s=new Date(t.endDate),i=new Date;if(i<e)return 0;if(i>s)return 100;const a=s.getTime()-e.getTime(),r=i.getTime()-e.getTime(),n=Math.max(0,Math.min(100,r/a*100));return Math.round(n)})(),showInfo:!1,size:"small",strokeColor:t.daysRemaining<=30?"dark"===M?"#ff6b6b":E.colorError:"dark"===M?"#7d9b49":E.colorPrimary})})]},s))})})]})}),t.availablePlans.length>0&&e.jsx(W,{xs:24,md:t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0?8:16,children:e.jsxs(U,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(Me,{type:"secondary",style:{fontSize:12},children:(()=>{const e=t.availablePlans.find(e=>1===e.IsCurrentPlan);return e&&"ELITE"!==e.PlanCode?"UPGRADE OPTIONS":"AVAILABLE PLANS"})()}),e.jsx(ze,{level:4,style:{margin:"8px 0"},children:"Choose Your Plan"})]}),e.jsx(U,{direction:"vertical",size:"small",style:{width:"100%"},children:(()=>{const s=["COMMUNITY","ADVANCED","PREMIUM","ELITE"],i=t.availablePlans.find(e=>1===e.IsCurrentPlan),a=i?s.indexOf(i.PlanCode):-1;return t.availablePlans.filter(e=>s.indexOf(e.PlanCode)>=a).map(t=>e.jsx("div",{style:{padding:"12px 16px",backgroundColor:1===t.IsCurrentPlan?"dark"===M?E.colorBgElevated:E.colorBgContainer:"dark"===M?E.colorBgContainer:E.colorBgLayout,borderRadius:6,border:1===t.IsCurrentPlan?`2px solid ${E.colorPrimary}`:`1px solid ${E.colorBorder}`},"data-testid":`dashboard-plan-item-${t.PlanCode.toLowerCase()}`,children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs(U,{children:[e.jsx(Me,{strong:!0,children:t.PlanName}),1===t.IsCurrentPlan&&e.jsx(K,{color:"success",children:"Current"})]}),e.jsxs(Me,{type:"secondary",style:{fontSize:12,display:"block",marginTop:4},children:["Up to ",t.MaxUsers," users • ",t.Description]})]}),!c&&o&&(()=>{const s=Pe(o,t.PlanCode);return null!==s&&e.jsx(Me,{strong:!0,style:{fontSize:16,minWidth:80,textAlign:"right"},children:0===s?"Free":`$${s}/mo`})})()]})},t.PlanCode))})()})]})})]})})]})]});var oe};export{Re as default};
