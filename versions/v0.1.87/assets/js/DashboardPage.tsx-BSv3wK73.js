import{j as e}from"./chunk-C4F6eAY2.js";import{f as t,g as s,r as a,L as i}from"./chunk-DZuWtVpy.js";import{r,a as l,b as o,c as d,u as n,H as c,d as u,e as h,C as x,E as m,f as g,g as y,W as j,T as p,S as v,h as b,I as f}from"../index-CfsZZh96.js";import{u as S,E as w}from"./chunk-Ch0v19eE.js";import{S as C,D as z}from"./chunk-5M3axm5N.js";import{T as k}from"./chunk-BUdBWF1b.js";import{C as M}from"./chunk-CCODhVgY.js";import{L as T,S as I}from"./chunk-DwF30kAK.js";import{I as L}from"./chunk-DkKJkm2J.js";import{F as P}from"./chunk-RwzM4RZb.js";import{D as _,C as R}from"./chunk-BcJSIpOJ.js";import{C as A}from"./chunk-CPN3uOn4.js";import{u as q}from"./chunk-C_1cO1th.js";import{t as B,p as $,a as H,s as E,u as N,v as D,T as O,P as U,g as W,l as F,h as V,q as G,j as J,E as Q,i as Y,w as K,x as X}from"./chunk-DcXv3kLI.js";import"./chunk-oDcFv_qo.js";import"./chunk-lGptOMHx.js";var Z,ee,te,se={exports:{}},ae={},ie={};function re(){if(Z)return ie;Z=1,Object.defineProperty(ie,"__esModule",{value:!0});return ie.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"},ie}function le(){if(ee)return ae;ee=1;var e=r().default,s=l().default;Object.defineProperty(ae,"__esModule",{value:!0}),ae.default=void 0;var a=s(o()),i=e(t()),n=s(re()),c=s(d()),u=function(e,t){return i.createElement(c.default,(0,a.default)({},e,{ref:t,icon:n.default}))},h=i.forwardRef(u);return ae.default=h,ae}function oe(){return te||(te=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s;const a=(s=le())&&s.__esModule?s:{default:s};t.default=a,e.exports=a}(se,se.exports)),se.exports}const de=s(oe());var ne,ce,ue,he={exports:{}},xe={},me={};function ge(){if(ne)return me;ne=1,Object.defineProperty(me,"__esModule",{value:!0});return me.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M899.6 276.5L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.7-3.5-13.1 1.2-12.2 7.9L188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.8-6.7-6.5-11.4-12.3-7.9zm-126 534.1H250.3l-53.8-409.4 139.8 86.1L512 252.9l175.7 234.4 139.8-86.1-53.9 409.4zM512 509c-62.1 0-112.6 50.5-112.6 112.6S449.9 734.2 512 734.2s112.6-50.5 112.6-112.6S574.1 509 512 509zm0 160.9c-26.6 0-48.2-21.6-48.2-48.3 0-26.6 21.6-48.3 48.2-48.3s48.2 21.6 48.2 48.3c0 26.6-21.6 48.3-48.2 48.3z"}}]},name:"crown",theme:"outlined"},me}function ye(){if(ce)return xe;ce=1;var e=r().default,s=l().default;Object.defineProperty(xe,"__esModule",{value:!0}),xe.default=void 0;var a=s(o()),i=e(t()),n=s(ge()),c=s(d()),u=function(e,t){return i.createElement(c.default,(0,a.default)({},e,{ref:t,icon:n.default}))},h=i.forwardRef(u);return xe.default=h,xe}function je(){return ue||(ue=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s;const a=(s=ye())&&s.__esModule?s:{default:s};t.default=a,e.exports=a}(he,he.exports)),he.exports}const pe=s(je());var ve,be,fe,Se={exports:{}},we={},Ce={};function ze(){if(ve)return Ce;ve=1,Object.defineProperty(Ce,"__esModule",{value:!0});return Ce.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"},Ce}function ke(){if(be)return we;be=1;var e=r().default,s=l().default;Object.defineProperty(we,"__esModule",{value:!0}),we.default=void 0;var a=s(o()),i=e(t()),n=s(ze()),c=s(d()),u=function(e,t){return i.createElement(c.default,(0,a.default)({},e,{ref:t,icon:n.default}))},h=i.forwardRef(u);return we.default=h,we}function Me(){return fe||(fe=1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s;const a=(s=ke())&&s.__esModule?s:{default:s};t.default=a,e.exports=a}(Se,Se.exports)),Se.exports}const Te=s(Me()),{Text:Ie}=O,Le=({stats:t})=>{const{t:s}=q(["common","distributedStorage"]),{token:a}=B.useToken(),i=n();if(!t)return null;const r=e=>{switch(e){case"available":return a.colorSuccess;case"cluster":return a.colorInfo;case"image":return a.colorWarning;case"clone":return"#fa8c16";default:return a.colorTextSecondary}},l=[{type:"available",label:s("distributedStorage:assignmentStatus.available"),count:t.truly_available_machines,percentage:Math.round(t.truly_available_machines/t.total_machines*100),icon:e.jsx(A,{})},{type:"cluster",label:s("distributedStorage:assignmentStatus.cluster"),count:t.cluster_assigned_machines,percentage:t.cluster_percentage,icon:e.jsx(_,{})},{type:"image",label:s("distributedStorage:assignmentStatus.image"),count:t.image_assigned_machines,percentage:t.image_percentage,icon:e.jsx(c,{})},{type:"clone",label:s("distributedStorage:assignmentStatus.clone"),count:t.clone_assigned_machines,percentage:t.clone_percentage,icon:e.jsx(R,{})}];return e.jsx($,{"data-testid":"ds-widget-card",title:e.jsxs(H,{style:i.flexStart,children:[e.jsx(A,{style:i.icon.medium}),e.jsx("span",{style:i.heading4,children:s("distributedStorage:dashboard.title")})]}),extra:e.jsx(Ie,{type:"secondary",style:i.caption,children:s("distributedStorage:dashboard.subtitle",{total:t.total_machines})}),style:{...i.card,border:"1px solid var(--color-border-secondary)"},children:e.jsxs(H,{direction:"vertical",size:"large",style:{width:"100%",...i.padding.md},children:[e.jsx(E,{gutter:[16,16],children:l.map(t=>e.jsx(N,{xs:12,sm:12,md:6,children:e.jsx($,{"data-testid":`ds-widget-stat-${t.type}`,size:"small",style:{textAlign:"center",borderColor:r(t.type),borderRadius:"var(--border-radius-lg)",backgroundColor:"var(--color-bg-container)",boxShadow:"var(--shadow-sm)",...i.hoverEffect},children:e.jsxs(H,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx("div",{style:{fontSize:i.icon.xlarge.fontSize,color:r(t.type)},children:t.icon}),e.jsx(D,{"data-testid":`ds-widget-stat-value-${t.type}`,title:e.jsx("span",{style:i.label,children:t.label}),value:t.count,suffix:e.jsxs(Ie,{type:"secondary",style:i.caption,children:["(",t.percentage,"%)"]}),valueStyle:{...i.heading3,color:r(t.type)}})]})})},t.type))}),e.jsxs(E,{gutter:[16,16],children:[e.jsx(N,{xs:24,md:12,children:e.jsx("div",{"data-testid":"ds-widget-cluster-summary",style:{...i.padding.md,backgroundColor:"var(--color-bg-container)",borderRadius:"var(--border-radius-lg)",border:"1px solid var(--color-border-secondary)",boxShadow:"var(--shadow-sm)"},children:e.jsxs(H,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx(Ie,{strong:!0,style:i.heading5,children:s("distributedStorage:dashboard.clusterSummary")}),e.jsxs(E,{gutter:16,children:[e.jsx(N,{span:12,children:e.jsx(D,{"data-testid":"ds-widget-stat-total-clusters",title:e.jsx("span",{style:i.label,children:s("distributedStorage:dashboard.totalClusters")}),value:t.total_clusters,valueStyle:i.heading4})}),e.jsx(N,{span:12,children:e.jsx(D,{"data-testid":"ds-widget-stat-avg-machines",title:e.jsx("span",{style:i.label,children:s("distributedStorage:dashboard.avgMachinesPerCluster")}),value:t.avg_machines_per_cluster,precision:1,valueStyle:i.heading4})})]})]})})}),e.jsx(N,{xs:24,md:12,children:e.jsx("div",{"data-testid":"ds-widget-machine-utilization",style:{...i.padding.md,backgroundColor:"var(--color-bg-container)",borderRadius:"var(--border-radius-lg)",border:"1px solid var(--color-border-secondary)",boxShadow:"var(--shadow-sm)"},children:e.jsxs(H,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsx(Ie,{strong:!0,style:i.heading5,children:s("distributedStorage:dashboard.machineUtilization")}),e.jsx(U,{"data-testid":"ds-widget-progress-utilization",percent:Math.round((t.total_machines-t.truly_available_machines)/t.total_machines*100),strokeColor:{"0%":a.colorPrimary,"100%":a.colorSuccess},format:e=>`${e}% ${s("common:utilized")}`}),e.jsx(Ie,{type:"secondary",style:i.caption,children:s("distributedStorage:dashboard.utilizationDetails",{used:t.total_machines-t.truly_available_machines,total:t.total_machines})})]})})})]}),t.team_breakdown&&t.team_breakdown.length>0&&e.jsxs("div",{"data-testid":"ds-widget-team-breakdown",children:[e.jsxs(H,{style:i.marginBottom.sm,children:[e.jsx(k,{style:i.icon.medium}),e.jsx(Ie,{strong:!0,style:i.heading5,children:s("distributedStorage:dashboard.teamBreakdown")})]}),e.jsx(W,{"data-testid":"ds-widget-team-list",size:"small",dataSource:t.team_breakdown,renderItem:t=>e.jsx(W.Item,{"data-testid":`ds-widget-team-item-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,style:{...i.padding.sm,backgroundColor:"var(--color-bg-container)",marginBottom:"8px",borderRadius:"var(--border-radius-md)",border:"1px solid var(--color-border-secondary)",boxShadow:"var(--shadow-sm)"},children:e.jsxs("div",{style:{width:"100%"},children:[e.jsxs("div",{style:{...i.flexBetween,...i.marginBottom.xs},children:[e.jsx(Ie,{strong:!0,style:i.label,children:t.TeamName}),e.jsxs(Ie,{type:"secondary",style:i.caption,children:[t.TotalMachines," machines"]})]}),e.jsxs(H,{wrap:!0,children:[e.jsx(F,{title:s("distributedStorage:assignmentStatus.available"),children:e.jsxs(V,{"data-testid":`ds-widget-team-tag-available-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"success",children:[t.AvailableMachines," available"]})}),t.ClusterMachines>0&&e.jsx(F,{title:s("distributedStorage:assignmentStatus.cluster"),children:e.jsxs(V,{"data-testid":`ds-widget-team-tag-cluster-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"blue",children:[t.ClusterMachines," cluster"]})}),t.ImageMachines>0&&e.jsx(F,{title:s("distributedStorage:assignmentStatus.image"),children:e.jsxs(V,{"data-testid":`ds-widget-team-tag-image-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"purple",children:[t.ImageMachines," image"]})}),t.CloneMachines>0&&e.jsx(F,{title:s("distributedStorage:assignmentStatus.clone"),children:e.jsxs(V,{"data-testid":`ds-widget-team-tag-clone-${t.TeamName.toLowerCase().replace(/\s+/g,"-")}`,color:"orange",children:[t.CloneMachines," clone"]})})]})]})})})]})]})})},{Title:Pe,Text:_e}=O,Re={Machine:e.jsx(z,{}),Repo:e.jsx(L,{})},Ae=()=>{const{data:t,isLoading:s,error:r}=u(),{data:l,isLoading:o}=S(6),[d,n]=a.useState(!1),{theme:c}=h(),{token:L}=B.useToken();if(a.useEffect(()=>{const e=()=>{const e=window.innerWidth<768;n(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),s)return e.jsx("div",{style:{padding:24,textAlign:"center"},children:e.jsx(G,{size:"large"})});if(r)return e.jsx("div",{style:{padding:24},children:e.jsx(J,{message:"Error",description:"Failed to load dashboard data. Please try again later.",type:"error",showIcon:!0,icon:e.jsx(de,{}),"data-testid":"dashboard-error-alert"})});if(!t)return e.jsx("div",{style:{padding:24},children:e.jsx(Q,{description:"No dashboard data available"})});const _={Critical:"error",Warning:"warning",Good:"success"},R=90,A=75,q=t=>{const s=t.toLowerCase();return s.includes("create")?e.jsx(y,{style:{color:L.colorSuccess}}):s.includes("delete")?e.jsx(M,{style:{color:L.colorError}}):s.includes("update")||s.includes("modify")?e.jsx(w,{style:{color:L.colorWarning}}):s.includes("login")||s.includes("auth")?e.jsx(T,{style:{color:L.colorInfo}}):s.includes("export")||s.includes("import")?e.jsx(I,{style:{color:L.colorPrimary}}):e.jsx(f,{style:{color:L.colorTextSecondary}})},O=6e4,Z=60,ee=24,te=7,se=e=>{const t=new Date(e),s=(new Date).getTime()-t.getTime(),a=Math.floor(s/O);if(a<1)return"just now";if(a<Z)return`${a} minute${a>1?"s":""} ago`;const i=Math.floor(a/Z);if(i<ee)return`${i} hour${i>1?"s":""} ago`;const r=Math.floor(i/ee);return r<te?`${r} day${r>1?"s":""} ago`:t.toLocaleDateString()};return e.jsx("div",{style:{padding:d?16:24},children:e.jsxs(H,{direction:"vertical",size:"large",style:{width:"100%"},children:[1===t.activeSubscription?.IsExpiringSoon&&e.jsx(J,{message:"Subscription Expiring Soon",description:`Your ${t.activeSubscription.PlanCode} subscription expires in ${t.activeSubscription.DaysRemaining} days.`,type:"warning",showIcon:!0,icon:e.jsx(x,{}),"data-testid":"dashboard-alert-subscription-expiring"}),t.accountHealth.ResourcesAtLimit>0&&e.jsx(J,{message:"Resource Limits Reached",description:`${t.accountHealth.ResourcesAtLimit} resource type(s) have reached their limits. Consider upgrading your plan to continue scaling.`,type:"error",showIcon:!0,icon:e.jsx(m,{}),"data-testid":"dashboard-alert-resource-limits"}),e.jsx($,{title:"Resource Usage",extra:e.jsx(_e,{type:"secondary",children:"Monitor your resource consumption against plan limits"}),"data-testid":"dashboard-card-resource-usage",children:e.jsx(E,{gutter:[16,24],children:t.resources.filter(e=>"Machine"===e.ResourceType||"Repo"===e.ResourceType).map(t=>{return e.jsx(N,{xs:24,sm:12,md:8,children:e.jsx("div",{style:{padding:"16px",borderRadius:g("LG"),border:`1px solid ${L.colorBorderSecondary}`,backgroundColor:"dark"===c?L.colorBgContainer:L.colorBgLayout,height:"100%",transition:"all 0.2s ease"},children:e.jsxs(H,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(H,{size:"small",children:[Re[t.ResourceType],e.jsxs(_e,{strong:!0,children:[t.ResourceType,"s"]})]}),e.jsxs(_e,{type:"secondary",style:{fontWeight:500},children:[t.CurrentUsage," / ",0===t.ResourceLimit?"∞":t.ResourceLimit]})]}),e.jsx(U,{percent:0===t.ResourceLimit?0:t.UsagePercentage,status:(s=t.UsagePercentage,s>=R?"exception":s>=A?"normal":"success"),strokeColor:1===t.IsLimitReached?"dark"===c?"#ff6b6b":L.colorError:"dark"===c?"#7d9b49":L.colorPrimary,"data-testid":`dashboard-progress-${t.ResourceType.toLowerCase()}`,style:{margin:"8px 0"}}),1===t.IsLimitReached&&e.jsx(_e,{type:"danger",style:{fontSize:12,fontWeight:500},children:"Limit reached"})]})})},t.ResourceType);var s})})}),e.jsxs($,{title:e.jsxs(H,{children:[e.jsx(pe,{}),e.jsxs("span",{children:["Subscription & Plan Details - ",t.planLimits.PlanCode]}),t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0&&e.jsx(Y,{count:t.allActiveSubscriptions.length,style:{backgroundColor:"#333333"}})]}),"data-testid":"dashboard-card-subscription-plans",children:[e.jsxs(E,{gutter:[24,24],children:[e.jsx(N,{xs:24,md:t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0?12:24,children:t.activeSubscription?e.jsx(H,{direction:"vertical",size:"middle",style:{width:"100%"},children:e.jsxs("div",{children:[e.jsx(_e,{type:"secondary",style:{fontSize:12},children:"CURRENT SUBSCRIPTION"}),e.jsx(Pe,{level:4,style:{margin:"8px 0 16px 0"},children:t.activeSubscription.PlanCode}),e.jsxs(E,{gutter:[16,16],children:[e.jsx(N,{span:12,children:e.jsx(D,{title:"Active Licenses",value:t.activeSubscription.TotalActivePurchases,valueStyle:{color:L.colorText},"data-testid":"dashboard-stat-active-licenses"})}),e.jsx(N,{span:12,children:e.jsx(D,{title:"Days Remaining",value:t.activeSubscription.DaysRemaining,valueStyle:{color:t.activeSubscription.DaysRemaining<=30?L.colorError:L.colorText},"data-testid":"dashboard-stat-days-remaining"})})]})]})}):e.jsx(Q,{description:"No active subscription"})}),t.allActiveSubscriptions&&t.allActiveSubscriptions.length>0&&e.jsx(N,{xs:24,md:12,children:e.jsxs(H,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{children:[e.jsx(_e,{type:"secondary",style:{fontSize:12},children:"ALL ACTIVE LICENSES"}),e.jsxs(Pe,{level:4,style:{margin:"8px 0"},children:[t.allActiveSubscriptions.length," Total"]})]}),e.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:e.jsx(H,{direction:"vertical",size:"small",style:{width:"100%"},children:t.allActiveSubscriptions.map((t,s)=>e.jsxs("div",{style:{padding:"12px",backgroundColor:"dark"===c?L.colorBgContainer:L.colorBgLayout,borderRadius:6,border:`1px solid ${L.colorBorder}`},"data-testid":`dashboard-license-item-${s}`,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs(H,{children:[e.jsx(_e,{strong:!0,children:t.planCode}),e.jsx(Y,{count:`×${t.quantity}`,style:{backgroundColor:"#52c41a"}}),1===t.isTrial&&e.jsx(V,{color:"blue",children:"Trial"})]}),e.jsxs(_e,{type:t.daysRemaining<=30?"danger":"secondary",style:{fontSize:12},children:[t.daysRemaining," ",1===t.daysRemaining?"day":"days"," remaining"]})]}),e.jsx(F,{title:`From ${new Date(t.startDate).toLocaleDateString()} to ${new Date(t.endDate).toLocaleDateString()}`,children:e.jsx(U,{"data-testid":`dashboard-progress-subscription-${t.planCode}`,percent:(()=>{const e=new Date(t.startDate),s=new Date(t.endDate),a=new Date;if(a<e)return 0;if(a>s)return 100;const i=s.getTime()-e.getTime(),r=a.getTime()-e.getTime(),l=Math.max(0,Math.min(100,r/i*100));return Math.round(l)})(),showInfo:!1,size:"small",strokeColor:t.daysRemaining<=30?"dark"===c?"#ff6b6b":L.colorError:"dark"===c?"#7d9b49":L.colorPrimary})})]},s))})})]})})]}),e.jsx(E,{gutter:[16,16],style:{marginTop:24},children:e.jsx(N,{xs:24,children:e.jsxs("div",{children:[e.jsx(_e,{type:"secondary",style:{fontSize:12,marginBottom:16,display:"block"},children:"PLAN CAPABILITIES"}),e.jsxs(E,{gutter:[16,16],children:[e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(D,{title:"Max Active Jobs",value:t.planLimits.MaxActiveJobs,valueStyle:{color:L.colorPrimary}})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(D,{title:"Max Reserved Jobs",value:t.planLimits.MaxReservedJobs,valueStyle:{color:L.colorPrimary}})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(D,{title:"Job Timeout",value:t.planLimits.JobTimeoutHours,suffix:"hours",valueStyle:{color:L.colorPrimary}})}),e.jsx(N,{xs:24,sm:12,md:6,children:e.jsx(D,{title:"Max Repo Size",value:t.planLimits.MaxRepoSize,suffix:"GB",valueStyle:{color:L.colorPrimary}})})]})]})})})]}),t.queueStats?e.jsx($,{title:e.jsxs(H,{children:[e.jsx(Te,{}),e.jsx("span",{children:"Queue Overview"})]}),extra:e.jsx(i,{to:"/queue",style:{color:L.colorPrimary},"data-testid":"dashboard-queue-manage-link",children:"Manage"}),"data-testid":"dashboard-card-queue-overview",children:e.jsxs(H,{direction:"vertical",size:"large",style:{width:"100%"},children:[e.jsxs(E,{gutter:[16,16],children:[e.jsx(N,{span:6,children:e.jsx(D,{title:"Pending",value:t.queueStats.PendingCount||0,valueStyle:{color:L.colorWarning},prefix:e.jsx(x,{}),"data-testid":"dashboard-stat-pending"})}),e.jsx(N,{span:6,children:e.jsx(D,{title:"Processing",value:t.queueStats.ActiveCount||0,valueStyle:{color:L.colorInfo},prefix:e.jsx(C,{spin:!0}),"data-testid":"dashboard-stat-processing"})}),e.jsx(N,{span:6,children:e.jsx(D,{title:"Completed",value:t.queueStats.CompletedCount||0,valueStyle:{color:L.colorSuccess},prefix:e.jsx(y,{}),"data-testid":"dashboard-stat-completed"})}),e.jsx(N,{span:6,children:e.jsx(D,{title:"Failed",value:t.queueStats.FailedCount||0,valueStyle:{color:L.colorError},prefix:e.jsx(m,{}),"data-testid":"dashboard-stat-failed"})})]}),(1===t.queueStats.HasStaleItems||1===t.queueStats.HasOldPendingItems)&&e.jsxs(H,{direction:"vertical",size:"small",style:{width:"100%"},children:[1===t.queueStats.HasStaleItems&&e.jsx(J,{message:`${t.queueStats.StaleCount||0} stale items`,type:"warning",showIcon:!0,icon:e.jsx(j,{}),"data-testid":"dashboard-alert-stale-items"}),1===t.queueStats.HasOldPendingItems&&e.jsx(J,{message:`Oldest: ${Math.floor((t.queueStats.OldestPendingAgeMinutes||0)/60)}h`,type:"info",showIcon:!0,icon:e.jsx(P,{}),"data-testid":"dashboard-alert-old-pending"})]})]})}):e.jsx($,{title:e.jsxs(H,{children:[e.jsx(Te,{}),e.jsx("span",{children:"Queue Overview"})]}),"data-testid":"dashboard-card-queue-overview-empty",children:e.jsx(Q,{description:"No queue data available"})}),t.queueStats&&(Array.isArray(t.queueStats.TeamIssues)&&t.queueStats.TeamIssues.length>0||Array.isArray(t.queueStats.MachineIssues)&&t.queueStats.MachineIssues.length>0)&&e.jsx($,{title:e.jsxs(H,{children:[e.jsx(Te,{}),e.jsx("span",{children:"Queue Details"})]}),"data-testid":"dashboard-card-queue-details",children:e.jsxs(E,{gutter:[16,16],children:[e.jsx(N,{xs:24,lg:8,children:e.jsxs("div",{style:{padding:"16px",backgroundColor:"dark"===c?L.colorBgContainer:L.colorBgLayout,borderRadius:g("LG"),border:`1px solid ${L.colorBorder}`,height:"100%"},children:[e.jsx(_e,{strong:!0,style:{display:"block",marginBottom:12},children:"Today's Activity"}),e.jsxs(H,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{type:"secondary",children:"Created"}),e.jsx(_e,{strong:!0,style:{fontSize:18},"data-testid":"dashboard-stat-created-today",children:t.queueStats.CreatedToday||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{type:"secondary",children:"Completed"}),e.jsx(_e,{strong:!0,style:{fontSize:18,color:L.colorSuccess},"data-testid":"dashboard-stat-completed-today",children:t.queueStats.CompletedToday||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{type:"secondary",children:"Cancelled"}),e.jsx(_e,{strong:!0,style:{fontSize:18,color:L.colorError},"data-testid":"dashboard-stat-cancelled-today",children:t.queueStats.CancelledToday||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{type:"secondary",children:"Failed"}),e.jsx(_e,{strong:!0,style:{fontSize:18,color:L.colorError},"data-testid":"dashboard-stat-failed-today",children:t.queueStats.FailedToday||0})]})]})]})}),e.jsx(N,{xs:24,lg:16,children:e.jsxs(H,{direction:"vertical",size:"large",style:{width:"100%"},children:[Array.isArray(t.queueStats.TeamIssues)&&t.queueStats.TeamIssues.length>0&&e.jsxs("div",{children:[e.jsxs(_e,{strong:!0,style:{display:"block",marginBottom:12},children:[e.jsx(k,{})," Team Queue Status"]}),e.jsx(W,{size:"small",dataSource:t.queueStats.TeamIssues,"data-testid":"dashboard-list-team-issues",renderItem:t=>e.jsx(W.Item,{style:{paddingLeft:0,paddingRight:0},children:e.jsx("div",{style:{width:"100%"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx(_e,{strong:!0,children:t.TeamName}),e.jsxs(H,{size:"small",children:[(t.StaleItems||0)>0&&e.jsxs(V,{color:"warning",children:[e.jsx(j,{})," ",t.StaleItems," stale"]}),e.jsxs(V,{color:"blue",children:[t.PendingItems||0," pending"]}),e.jsxs(V,{color:"processing",children:[t.ActiveItems||0," active"]})]})]})})})})]}),Array.isArray(t.queueStats.MachineIssues)&&t.queueStats.MachineIssues.length>0&&e.jsxs("div",{children:[e.jsxs(_e,{strong:!0,style:{display:"block",marginBottom:12},children:[e.jsx(z,{})," Machine Queue Status"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsx(K,{size:"small",dataSource:t.queueStats.MachineIssues,pagination:!1,"data-testid":"dashboard-table-machine-issues",columns:[{title:"Machine",dataIndex:"MachineName",key:"MachineName",ellipsis:!0},{title:"Team",dataIndex:"TeamName",key:"TeamName",ellipsis:!0},{title:"Status",key:"status",width:200,render:(t,s)=>e.jsxs(H,{size:"small",children:[(s.StaleItems||0)>0&&e.jsxs(V,{color:"warning",children:[s.StaleItems," stale"]}),e.jsxs(V,{color:"blue",children:[s.PendingItems||0," pending"]}),e.jsxs(V,{color:"processing",children:[s.ActiveItems||0," active"]})]})}]})})]}),1===t.featureAccess.HasAdvancedAnalytics&&null!==t.queueStats.HighestPriorityPending&&e.jsxs("div",{style:{padding:"16px",backgroundColor:"dark"===c?L.colorBgContainer:L.colorBgLayout,borderRadius:g("LG"),border:`1px solid ${L.colorBorder}`},children:[e.jsxs(_e,{strong:!0,style:{display:"block",marginBottom:12},children:[e.jsx(p,{})," Priority Breakdown"]}),e.jsxs(H,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{children:"Highest Priority"}),e.jsx(Y,{count:t.queueStats.HighestPriorityPending??0,style:{backgroundColor:L.colorError},"data-testid":"dashboard-badge-highest-priority"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{children:"High Priority"}),e.jsx(Y,{count:t.queueStats.HighPriorityPending??0,style:{backgroundColor:L.colorWarning},"data-testid":"dashboard-badge-high-priority"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{children:"Normal Priority"}),e.jsx(Y,{count:t.queueStats.NormalPriorityPending??0,style:{backgroundColor:L.colorInfo},"data-testid":"dashboard-badge-normal-priority"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{children:"Low Priority"}),e.jsx(Y,{count:t.queueStats.LowPriorityPending??0,style:{backgroundColor:L.colorTextSecondary},"data-testid":"dashboard-badge-low-priority"})]})]})]})]})})]})}),1===t.featureAccess?.HasAdvancedAnalytics&&t.distributedStorageStats&&e.jsx(Le,{stats:t.distributedStorageStats}),e.jsx($,{"data-testid":"dashboard-account-health-card",title:e.jsxs(H,{children:[e.jsx(v,{}),e.jsx("span",{children:"Account Health"})]}),children:e.jsxs(H,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(_e,{children:"Overall Status"}),e.jsx(V,{color:(ae=t.accountHealth.SubscriptionStatus,_[ae]||"success"),children:t.accountHealth.SubscriptionStatus})]}),e.jsxs(H,{direction:"vertical",size:"small",style:{width:"100%"},children:[e.jsxs(H,{children:[t.accountHealth.ResourcesAtLimit>0?e.jsx(m,{style:{color:L.colorWarning}}):e.jsx(y,{style:{color:L.colorSuccess}}),e.jsxs(_e,{children:[t.accountHealth.ResourcesAtLimit," resources at limit"]})]}),e.jsxs(H,{children:[e.jsx(x,{style:{color:L.colorTextSecondary}}),e.jsxs(_e,{children:[t.accountHealth.ResourcesNearLimit," resources near limit"]})]})]}),e.jsx("div",{style:{paddingTop:12,borderTop:`1px solid ${L.colorBorder}`},children:e.jsx(_e,{strong:!0,children:t.accountHealth.UpgradeRecommendation})})]})}),e.jsx($,{title:e.jsxs(H,{children:[e.jsx(b,{}),e.jsx("span",{children:"Recent Activity"})]}),extra:e.jsx(i,{to:"/audit",style:{color:L.colorPrimary},"data-testid":"dashboard-activity-viewall-link",children:"View All"}),"data-testid":"dashboard-card-recent-activity",children:o?e.jsx("div",{style:{textAlign:"center",padding:"20px"},children:e.jsx(G,{})}):l&&l.length>0?e.jsx(X,{items:l.filter(e=>{const t=e.action.toLowerCase(),s=t.includes("token")&&t.includes("validat"),a=t.includes("login")&&t.includes("success");return!s&&!a}).slice(0,5).map((t,s)=>({key:s,dot:q(t.action),children:e.jsxs(H,{direction:"vertical",size:4,style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(H,{size:8,children:[e.jsx(_e,{strong:!0,style:{fontSize:14},children:t.action.replace(/_/g," ")}),e.jsx(V,{children:t.entity})]}),e.jsx(_e,{type:"secondary",style:{fontSize:11,flexShrink:0,marginLeft:8},children:se(t.timestamp)})]}),e.jsxs(_e,{type:"secondary",style:{fontSize:12,lineHeight:1.4},children:[t.entityName," ",t.actionByUser&&`• ${t.actionByUser}`]}),t.details&&t.details.trim()&&e.jsx(_e,{type:"secondary",style:{fontSize:11,opacity:.8},children:t.details.length>80?`${t.details.substring(0,80)}...`:t.details})]})}))}):e.jsx(Q,{description:"No recent activity",image:Q.PRESENTED_IMAGE_SIMPLE,style:{padding:"20px 0"}})})]})});var ae};export{Ae as default};
